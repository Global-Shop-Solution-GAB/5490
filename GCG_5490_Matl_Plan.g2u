Program.Sub.ScreenSU.Start
Gui.frmPO..Create
Gui.frmPO..Caption("Purchasing Dashboard")
Gui.frmPO..Size(16350,12825)
Gui.frmPO..MinX(16350)
Gui.frmPO..MinY(12825)
Gui.frmPO..Position(0,0)
Gui.frmPO..BackColor(-2147483633)
Gui.frmPO..MousePointer(0)
Gui.frmPO..Event(UnLoad,frmPO_UnLoad)
Gui.frmPO..Event(Resize,frmPO_Resize)
Gui.frmPO.picGSSLogo.Create(PictureBox)
Gui.frmPO.picGSSLogo.Size(4125,960)
Gui.frmPO.picGSSLogo.Position(6090,45)
Gui.frmPO.picGSSLogo.Anchor(1)
Gui.frmPO.lblStatus.Create(Label,"Loading PO Data....",False,2895,255,0,75,135,True,0,"Arial",8,-2147483633,0)
Gui.frmPO.progBarStatus.Create(ProgressBar)
Gui.frmPO.progBarStatus.Visible(False)
Gui.frmPO.progBarStatus.Size(2895,255)
Gui.frmPO.progBarStatus.Position(75,345)
Gui.frmPO.GsGCDemand.Create(GsGridControl)
Gui.frmPO.GsGCDemand.Size(5310,3765)
Gui.frmPO.GsGCDemand.Position(30,8715)
Gui.frmPO.GsGCDemand.Event(RowCellClick,Hyperlinks)
Gui.frmPO.lblSupply.Create(Label,"Supply",True,1935,255,0,10860,8475,True,0,"Arial",8,-2147483633,0)
Gui.frmPO.lblSupply.FontStyle(True,False,False,False,False)
Gui.frmPO.GsGCSupply.Create(GsGridControl)
Gui.frmPO.GsGCSupply.Size(5310,3765)
Gui.frmPO.GsGCSupply.Position(10860,8715)
Gui.frmPO.GsGCSupply.Event(RowCellClick,Hyperlinks)
Gui.frmPO.lblDemand.Create(Label,"Demand",True,1935,255,0,30,8475,True,0,"Arial",8,-2147483633,0)
Gui.frmPO.lblDemand.FontStyle(True,False,False,False,False)
Gui.frmPO.GsGCVendQte.Create(GsGridControl)
Gui.frmPO.GsGCVendQte.Size(5310,3765)
Gui.frmPO.GsGCVendQte.Position(5445,8715)
Gui.frmPO.GsGCVendQte.Event(RowCellClick,GsGCVendQte_RowCellClick)
Gui.frmPO.lblVendQte.Create(Label,"Vendor Quote",True,1290,255,0,5445,8475,True,0,"Arial",8,-2147483633,0)
Gui.frmPO.lblVendQte.FontStyle(True,False,False,False,False)
Gui.frmPO.cmdNewVendQte.Create(Button)
Gui.frmPO.cmdNewVendQte.Size(600,300)
Gui.frmPO.cmdNewVendQte.Position(7395,8385)
Gui.frmPO.cmdNewVendQte.Caption("New")
Gui.frmPO.cmdNewVendQte.Event(Click,cmdNewVendQte_Click)
Gui.frmPO.cmdViewVendQte.Create(Button)
Gui.frmPO.cmdViewVendQte.Size(615,300)
Gui.frmPO.cmdViewVendQte.Position(6750,8385)
Gui.frmPO.cmdViewVendQte.Caption("View")
Gui.frmPO.cmdViewVendQte.Event(Click,cmdViewVendQte_Click)
Gui.frmPO.dtpCutoff.Create(DatePicker)
Gui.frmPO.dtpCutoff.Size(1425,285)
Gui.frmPO.dtpCutoff.Position(1305,720)
Gui.frmPO.dtpCutoff.Enabled(False)
Gui.frmPO.cmdRefresh.Create(Button)
Gui.frmPO.cmdRefresh.Size(390,330)
Gui.frmPO.cmdRefresh.Position(2760,705)
Gui.frmPO.cmdRefresh.Caption("REFRESH")
Gui.frmPO.cmdRefresh.Event(Click,cmdRefresh_Click)
Gui.frmPO.chkCutoff.Create(CheckBox)
Gui.frmPO.chkCutoff.Size(1260,255)
Gui.frmPO.chkCutoff.Position(30,780)
Gui.frmPO.chkCutoff.Caption("Cutoff Date:")
Gui.frmPO.chkCutoff.Event(Click,chkCutoff_Click)
Gui.frmPO.tabPO.Create(Tab)
Gui.frmPO.tabPO.Size(16140,7320)
Gui.frmPO.tabPO.Position(30,1050)
Gui.frmPO.tabPO.Anchor(15)
Gui.frmPO.tabPO.Event(Click,tabPO_Click)
Gui.frmPO.tabPO.Tabs(4)
Gui.frmPO.tabPO.SetTab(0)
Gui.frmPO.tabPO.Caption("Purchase Orders")
Gui.frmPO.tabPO.SetTab(1)
Gui.frmPO.tabPO.Caption("By Sales Order")
Gui.frmPO.tabPO.SetTab(2)
Gui.frmPO.tabPO.Caption("Drop Ship POs")
Gui.frmPO.tabPO.SetTab(3)
Gui.frmPO.tabPO.Caption("Requisitions")
Gui.frmPO.GsGCPO.Create(GsGridControl)
Gui.frmPO.GsGCPO.Size(16005,6915)
Gui.frmPO.GsGCPO.Position(0,0)
Gui.frmPO.GsGCPO.Event(RowCellClick,GsGCPO_RowCellClick)
Gui.frmPO.GsGCPO.Parent("tabPO",0)
Gui.frmPO.GsGCPOSO.Create(GsGridControl)
Gui.frmPO.GsGCPOSO.Size(16005,6915)
Gui.frmPO.GsGCPOSO.Position(0,0)
Gui.frmPO.GsGCPOSO.Parent("tabPO",1)
Gui.frmPO.GsGCPOSO.Event(RowCellClick,GsGCPO_RowCellClick)
Gui.frmPO.GsGCPODrop.Create(GsGridControl)
Gui.frmPO.GsGCPODrop.Size(16005,6915)
Gui.frmPO.GsGCPODrop.Position(0,0)
Gui.frmPO.GsGCPODrop.Parent("tabPO",2)
Gui.frmPO.GsGCPODrop.Event(RowCellClick,GsGCPO_RowCellClick)
Gui.frmPO.GsGCReqs.Create(GsGridControl)
Gui.frmPO.GsGCReqs.Size(16005,6915)
Gui.frmPO.GsGCReqs.Position(0,0)
Gui.frmPO.GsGCReqs.Parent("tabPO",3)
Gui.frmPO.GsGCReqs.Event(RowCellClick,GsGCPO_RowCellClick)
Gui.frmPO.frameOptions.Create(Frame)
Gui.frmPO.frameOptions.Size(2025,1305)
Gui.frmPO.frameOptions.Position(14085,30)
Gui.frmPO.frameOptions.Caption("Options")
Gui.frmPO.frameOptions.Anchor(9)
Gui.frmPO.ddlEmail.Create(DropDownList)
Gui.frmPO.ddlEmail.Size(1935,330)
Gui.frmPO.ddlEmail.Position(45,930)
Gui.frmPO.ddlEmail.Parent("frameOptions")
Gui.frmPO.ddlEmail.Event(Click,SaveEmailOpt)
Gui.frmPO.ddlPOs.Create(DropDownList)
Gui.frmPO.ddlPOs.Size(1935,330)
Gui.frmPO.ddlPOs.Position(45,570)
Gui.frmPO.ddlPOs.Parent("frameOptions")
Gui.frmPO.ddlPOs.Event(Click,SavePOOpt)
Gui.frmPO.ddlCost.Create(DropDownList)
Gui.frmPO.ddlCost.Size(1935,330)
Gui.frmPO.ddlCost.Position(45,210)
Gui.frmPO.ddlCost.Parent("frameOptions")
Gui.frmPO.ddlCost.Event(Click,SaveCostOpt)
Gui.frmPO.chkBrwVends.Create(CheckBox)
Gui.frmPO.chkBrwVends.Size(1650,270)
Gui.frmPO.chkBrwVends.Position(9105,8430)
Gui.frmPO.chkBrwVends.Caption("Browse Vendors")
Gui.frmPO.chkBrwVends.Event(Click,chkBrwVends_Click)
Gui.frmMRP..Create
Gui.frmMRP..Caption("MRP")
Gui.frmMRP..Size(11715,8760)
Gui.frmMRP..MinX(0)
Gui.frmMRP..MinY(0)
Gui.frmMRP..Position(0,0)
Gui.frmMRP..BackColor(-2147483633)
Gui.frmMRP..MousePointer(0)
Gui.frmMRP..Event(UnLoad,frmMRP_UnLoad)
Gui.frmMRP.GsGCMRP.Create(GsGridControl)
Gui.frmMRP.GsGCMRP.Size(11460,6960)
Gui.frmMRP.GsGCMRP.Position(60,1455)
Gui.frmMRP.GsGCMRP.Anchor(15)
Gui.frmMRP.lblPart.Create(Label,"Part: ",True,2760,255,0,150,135,True,0,"Arial",8,-2147483633,0)
Gui.frmMRP.lblLoc.Create(Label,"Loc:",True,2760,255,0,150,405,True,0,"Arial",8,-2147483633,0)
Gui.frmMRP.lblCurOnHand.Create(Label,"Initial On Hand Qty:",True,2760,255,0,150,1215,True,0,"Arial",8,-2147483633,0)
Gui.frmMRP.lblOrderQty.Create(Label,"Order Qty:",True,2760,255,0,150,675,True,0,"Arial",8,-2147483633,0)
Gui.frmMRP.lblROP.Create(Label,"Reorder Point :",True,2760,255,0,150,945,True,0,"Arial",8,-2147483633,0)
Gui.frmHistory..Create
Gui.frmHistory..Caption("PO History")
Gui.frmHistory..Size(15405,7395)
Gui.frmHistory..MinX(0)
Gui.frmHistory..MinY(0)
Gui.frmHistory..Position(0,0)
Gui.frmHistory..BackColor(-2147483633)
Gui.frmHistory..MousePointer(0)
Gui.frmHistory..Event(UnLoad,frmHistory_UnLoad)
Gui.frmHistory.GsGCHistory.Create(GsGridControl)
Gui.frmHistory.GsGCHistory.Size(15270,7080)
Gui.frmHistory.GsGCHistory.Position(15,15)
Gui.frmHistory.GsGCHistory.Event(RowCellClick,GsGCHistory_RowCellClick)
Gui.frmHistory.GsGCHistory.Anchor(15)
Gui.frmPrevEmail..Create
Gui.frmPrevEmail..Caption("PO - Preview Emails")
Gui.frmPrevEmail..Size(14820,5625)
Gui.frmPrevEmail..MinX(14820)
Gui.frmPrevEmail..MinY(5625)
Gui.frmPrevEmail..Position(0,0)
Gui.frmPrevEmail..BackColor(-2147483633)
Gui.frmPrevEmail..MousePointer(0)
Gui.frmPrevEmail..Event(UnLoad,frmPrevEmail_UnLoad)
Gui.frmPrevEmail..MaxButton(False)
Gui.frmPrevEmail..MinButton(False)
Gui.frmPrevEmail.GsGCPrevEml.Create(GsGridControl)
Gui.frmPrevEmail.GsGCPrevEml.Size(14655,4905)
Gui.frmPrevEmail.GsGCPrevEml.Position(15,15)
Gui.frmPrevEmail.GsGCPrevEml.Event(RowCellClick,GsGCPrevEml_RowCellClick)
Gui.frmPrevEmail.cmdSend.Create(Button)
Gui.frmPrevEmail.cmdSend.Size(1125,375)
Gui.frmPrevEmail.cmdSend.Position(13545,4935)
Gui.frmPrevEmail.cmdSend.Caption("Send Emails")
Gui.frmPrevEmail.cmdSend.Event(Click,cmdSend_Click)
Gui.frmPrevEmail.lblStatus.Create(Label,"Sending Emails....",False,1635,255,0,15,5010,True,0,"Arial",8,-2147483633,0)
Gui.frmPrevEmail.pbStatus.Create(ProgressBar)
Gui.frmPrevEmail.pbStatus.Size(2475,255)
Gui.frmPrevEmail.pbStatus.Position(1665,4950)
Gui.frmPrevEmail.pbStatus.Visible(False)
Gui.frmEmail..Create
Gui.frmEmail..Size(7140,8475)
Gui.frmEmail..MinX(7260)
Gui.frmEmail..MinY(7005)
Gui.frmEmail..Position(0,0)
Gui.frmEmail..BackColor(-2147483633)
Gui.frmEmail..MousePointer(0)
Gui.frmEmail..Event(UnLoad,frmEmail_UnLoad)
Gui.frmEmail..Caption("Edit Email")
Gui.frmEmail..MaxButton(False)
Gui.frmEmail..Sizeable(False)
Gui.frmEmail.txtBody.Create(TextboxM)
Gui.frmEmail.txtBody.Size(6915,3810)
Gui.frmEmail.txtBody.Position(75,2310)
Gui.frmEmail.txtSubject.Create(TextboxM)
Gui.frmEmail.txtSubject.Size(6915,300)
Gui.frmEmail.txtSubject.Position(75,1665)
Gui.frmEmail.lblBody.Create(Label,"Body:",True,660,255,0,75,2085,True,0,"Arial",8,-2147483633,0)
Gui.frmEmail.lblSubject.Create(Label,"Subject:",True,765,255,0,75,1440,True,0,"Arial",8,-2147483633,0)
Gui.frmEmail.txtSName.Create(TextBox,"",True,3375,300,0,75,360,True,0,"Arial",8,-2147483643,1)
Gui.frmEmail.txtSName.MaxLength(30)
Gui.frmEmail.txtRName.Create(TextBox,"",True,3375,300,0,75,975,True,0,"Arial",8,-2147483643,1)
Gui.frmEmail.txtRName.MaxLength(30)
Gui.frmEmail.txtSEmail.Create(TextBox,"",True,3375,300,0,3570,360,True,0,"Arial",8,-2147483643,1)
Gui.frmEmail.txtSEmail.MaxLength(100)
Gui.frmEmail.txtREmail.Create(TextBox,"",True,3375,300,0,3570,975,True,0,"Arial",8,-2147483643,1)
Gui.frmEmail.txtREmail.MaxLength(100)
Gui.frmEmail.lblSName.Create(Label,"Sender Name:",True,1200,210,0,45,135,True,0,"Arial",8,-2147483633,0)
Gui.frmEmail.lblSEmail.Create(Label,"Sender Email:",True,1200,210,0,3540,135,True,0,"Arial",8,-2147483633,0)
Gui.frmEmail.lblREmail.Create(Label,"Recipient Email:",True,1305,210,0,3540,750,True,0,"Arial",8,-2147483633,0)
Gui.frmEmail.lblRName.Create(Label,"Recipient Name:",True,1350,210,0,45,750,True,0,"Arial",8,-2147483633,0)
Gui.frmEmail.cmdSave.Create(Button)
Gui.frmEmail.cmdSave.Size(855,330)
Gui.frmEmail.cmdSave.Position(75,7800)
Gui.frmEmail.cmdSave.Caption("Save")
Gui.frmEmail.cmdSave.Event(Click,cmdSavePreview_Click)
Gui.frmEmail.txtRow.Create(TextBox,"",False,330,300,0,6660,7815,True,0,"Arial",8,-2147483643,1)
Gui.frmEmail.txtAttach.Create(TextboxM)
Gui.frmEmail.txtAttach.Size(6915,1290)
Gui.frmEmail.txtAttach.Position(75,6465)
Gui.frmEmail.lblActtach.Create(Label,"Attachment(s):",True,1185,255,0,75,6240,True,0,"Arial",8,-2147483633,0)
Gui.frmEmail.txtDropFiles.Create(TextBox,"Drop Files Here",True,1425,300,0,1275,6150,True,2,"Arial",8,11119017,1)
Gui.frmEmail.txtDropFiles.FontStyle(True,False,False,False,False)
Gui.frmEmail.txtDropFiles.Locked(True)
Gui.frmNotes..Create
Gui.frmNotes..Caption("Notes: Part: Loc: ")
Gui.frmNotes..Size(14460,7425)
Gui.frmNotes..MinX(0)
Gui.frmNotes..MinY(0)
Gui.frmNotes..Position(0,0)
Gui.frmNotes..BackColor(-2147483633)
Gui.frmNotes..MousePointer(0)
Gui.frmNotes..Event(UnLoad,frmNotes_UnLoad)
Gui.frmNotes.GsGCNotes.Create(GsGridControl)
Gui.frmNotes.GsGCNotes.Size(14310,7125)
Gui.frmNotes.GsGCNotes.Position(0,0)
Gui.frmNotes.GsGCNotes.Event(CellValueChanged,GsGCNotes_CellValueChanged)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
	V.Global.sPart.Declare
	V.Global.sLoc.Declare
	V.Global.fQty.Declare
	V.Global.sDt.Declare
	V.Global.iRowIndex.Declare
	V.Global.bVendQte.Declare
	V.Global.bVendQte.Set(True)
	V.Global.sGsGCIcon.Declare
	V.Global.sPart2.Declare
	V.Global.sLoc2.Declare
'	Program.External.Include.Library("175100.lib")
Program.Sub.Preflight.End

Program.Sub.Main.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sIcon.Declare
	V.Local.sGssLogo.Declare
	
	'Set Logo in GsGridControl Group Header
	F.Intrinsic.String.Build("{0}\GAB_GSS_Logo_Green_Dash.png",V.Caller.ArtDir,V.Global.sGsGCIcon)
	
	Gui.frmPO.cmdViewVendQte.Visible(False)
	Gui.frmPO.cmdNewVendQte.Visible(False)
	
	F.Intrinsic.Control.SelectCase(V.Caller.Hook)
		F.Intrinsic.Control.Case(12990)
			V.Passed.000203.Set("Pref Vendor")
			
		F.Intrinsic.Control.Case(13040)
			F.ODBC.Connection!con.OpenCompanyConnection(500)
			F.Intrinsic.Control.CallSub(SetPrefVendor)
			F.ODBC.Connection!con.Close

		F.Intrinsic.Control.CaseElse
			F.Intrinsic.String.Build("{0}\GAB\GAS\gss2.ico",V.Caller.PluginsDir,v.Local.sIcon)
			F.Intrinsic.String.Build("{0}\GAB\GAS\GAB_GSS_Logo_Green_Dash.png",V.Caller.PluginsDir,V.Local.sGssLogo)
			Gui.frmMRP..Icon(V.Local.sIcon)
			Gui.frmPO..Icon(V.Local.sIcon)
			Gui.frmHistory..Icon(V.Local.sIcon)
			Gui.frmPrevEmail..Icon(V.Local.sIcon)
			Gui.frmEmail..Icon(V.Local.sIcon)
			Gui.frmNotes..Icon(V.Local.sIcon)
			Gui.frmPO.picGSSLogo.Picture(V.Local.sGssLogo)
			Gui.frmEmail.txtDropFiles.Event("DRAGDROPFILE",Dragdrop)
			
			F.ODBC.Connection!con.OpenCompanyConnection(500)
			
			F.Intrinsic.Control.CallSub(LoadDropDowns)
			F.Intrinsic.Control.CallSub(SetContextMenus)
			F.Intrinsic.Control.CallSub(CheckCostOpt)
			F.Intrinsic.Control.CallSub(CheckPOOpt)
			F.Intrinsic.Control.CallSub(GetCompanyShipTo)
			F.Intrinsic.Control.CallSub(RemoveExpiredNotes)
			
			Gui.frmPO.tabPO.TabVisible(1,False)
			Gui.frmPO.tabPO.SetTab(0)
			Gui.frmPO..Show
			F.Intrinsic.Control.CallSub(SetTabAnchors)
	F.Intrinsic.Control.EndSelect
	
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.Main.End

Program.Sub.frmPO_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	F.ODBC.Connection!con.Close
	F.Intrinsic.Control.End
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.frmPO_UnLoad.End

Program.Sub.SetTabAnchors.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	Gui.frmPO.GsGCPO.Position(0,0)
	Gui.frmPO.GsGCPO.Anchor(15)
	Gui.frmPO.GsGCPOSO.Anchor(15)
	Gui.frmPO.GsGCPODrop.Anchor(15)
	Gui.frmPO.GsGCReqs.Anchor(15)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.SetTabAnchors.End

Program.Sub.frmPO_Resize.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.iGsGCHt.Declare
	V.Local.iGsGCWt.Declare
	V.Local.iWidth.Declare
	V.Local.iX1.Declare
	V.Local.iX2.Declare
	V.Local.iY1.Declare
	V.Local.iY2.Declare
	
	F.Intrinsic.Math.Div(V.Screen.frmPO!tabPO.Width,3,V.Local.iWidth)
	F.Intrinsic.Math.Sub(V.Local.iWidth,15,V.Local.iWidth)
	Gui.frmPO.GsGCDemand.Size(V.Local.iWidth,3875)
	Gui.frmPO.GsGCVendQte.Size(V.Local.iWidth,3875)
	Gui.frmPO.GsGCSupply.Size(V.Local.iWidth,3875)
	'Demand
	F.Intrinsic.Math.Add(V.Screen.frmPO!tabPO.Top,V.Screen.frmPO!tabPO.Height,80,V.Local.iY1)
	Gui.frmPO.lblDemand.Position(V.Screen.frmPO!tabPO.Left,V.Local.iY1)
	F.Intrinsic.Math.Add(V.Screen.frmPO!lblDemand.Top,V.Screen.frmPO!lblDemand.Height,V.Local.iY2)
	Gui.frmPO.GsGCDemand.Position(V.Screen.frmPO!tabPO.Left,V.Local.iY2)
	'Vendor Quote
	F.Intrinsic.Math.Add(V.Screen.frmPO!GsGCDemand.Left,V.Screen.frmPO!GsGCDemand.Width,15,V.Local.iX1)
	Gui.frmPO.lblVendQte.Position(V.Local.iX1,V.Local.iY1)
	Gui.frmPO.GsGCVendQte.Position(V.Local.iX1,V.Local.iY2)
	'Supply
	F.Intrinsic.Math.Add(V.Screen.frmPO!GsGCVendQte.Left,V.Screen.frmPO!GsGCVendQte.Width,15,V.Local.iX2)
	Gui.frmPO.lblSupply.Position(V.Local.iX2,V.Local.iY1)
	Gui.frmPO.GsGCSupply.Position(V.Local.iX2,V.Local.iY2)
	'New Button
	F.Intrinsic.Math.Add(V.Screen.frmPO!lblVendQte.Left,V.Screen.frmPO!lblVendQte.Width,700,V.Local.iX1)
	F.Intrinsic.Math.Add(V.Screen.frmPO!tabPO.Top,V.Screen.frmPO!tabPO.Height,-25,V.Local.iY1)
	Gui.frmPO.cmdNewVendQte.Position(V.Local.iX1,V.Local.iY1)
	'View Button
	F.Intrinsic.Math.Add(V.Local.iX1,-650,V.Local.iX2)
	Gui.frmPO.cmdViewVendQte.Position(V.Local.iX2,V.Local.iY1)
	'Check Browse Vendors
	F.Intrinsic.Math.Add(V.Screen.frmPO!GsGCVendQte.Left,V.Screen.frmPO!GsGCVendQte.Width,-1650,V.Local.iX1)
	F.Intrinsic.Math.Add(V.Screen.frmPO!tabPO.Top,V.Screen.frmPO!tabPO.Height,-5,V.Local.iY1)
	
	Gui.frmPO.chkBrwVends.Position(V.Local.iX1,V.Local.iY1)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.frmPO_Resize.End

Program.Sub.LoadDropDowns.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.BlockEvents

	'Cost
	Gui.frmPO.ddlCost.AddItem("PO History Cost",0)
	Gui.frmPO.ddlCost.AddItem("Vendor Quote Cost",1)
	Gui.frmPO.ddlCost.Text("PO History Cost")
	'POs
	Gui.frmPO.ddlPOs.AddItem("Individual POs",0)
	Gui.frmPO.ddlPOs.AddItem("Group POs by Vendor",1)
	Gui.frmPO.ddlPOs.Text("Individual POs")
	'Email
	Gui.frmPO.ddlEmail.AddItem("Do Not Email",0)
	Gui.frmPO.ddlEmail.AddItem("Auto Email",1)
	Gui.frmPO.ddlEmail.AddItem("Preview Email",2)
	Gui.frmPO.ddlEmail.Text("Do Not Email")
	
	F.Intrinsic.Control.UnBlockEvents

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDropDowns.End

Program.Sub.SetContextMenus.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmPO..ContextMenuCreate("ctxPO")
	Gui.frmPO.GsGCPO.ContextMenuAttach("ctxPO")
	Gui.frmPO..ContextMenuAddItem("ctxPO","Refresh",0,"Refresh")
	Gui.frmPO..ContextMenuAddItem("ctxPO","Export",0,"Export")
	Gui.frmPO..ContextMenuAddItem("ctxPO","Exp",3)
	Gui.frmPO..ContextMenuAddItem("ctxPO","Notes",0,"Notes")
	Gui.frmPO..ContextMenuAddItem("ctxPO","History",0,"History")
	Gui.frmPO..ContextMenuAddItem("ctxPO","Exp",3)
	Gui.frmPO..ContextMenuAddItem("ctxPO","New",0,"Create PO (Manual)")
	Gui.frmPO..ContextMenuAddItem("ctxPO","NewAuto",0,"Create PO (Auto)")
	Gui.frmPO..ContextMenuSetItemEventHandler("ctxPO","Refresh","cmdRefresh_Click")
	Gui.frmPO..ContextMenuSetItemEventHandler("ctxPO","Export","MenuClickExport")
	Gui.frmPO..ContextMenuSetItemEventHandler("ctxPO","Notes","MenuClick")
	Gui.frmPO..ContextMenuSetItemEventHandler("ctxPO","History","MenuClick")
	Gui.frmPO..ContextMenuSetItemEventHandler("ctxPO","New","MenuClickNew")
	Gui.frmPO..ContextMenuSetItemEventHandler("ctxPO","NewAuto","MenuClickNewAuto")
	
	Gui.frmPO..ContextMenuCreate("ctxPODrop")
	Gui.frmPO.GsGCPODrop.ContextMenuAttach("ctxPODrop")
	Gui.frmPO..ContextMenuAddItem("ctxPODrop","Refresh",0,"Refresh")
	Gui.frmPO..ContextMenuAddItem("ctxPODrop","Export",0,"Export")
	Gui.frmPO..ContextMenuAddItem("ctxPODrop","New",0,"Create PO (Manual)")
'	Gui.frmPO..ContextMenuAddItem("ctxPODrop","NewAuto",0,"Create PO (Auto)")
	Gui.frmPO..ContextMenuSetItemEventHandler("ctxPODrop","Refresh","cmdRefresh_Click")
	Gui.frmPO..ContextMenuSetItemEventHandler("ctxPODrop","Export","MenuClickExport")
	Gui.frmPO..ContextMenuSetItemEventHandler("ctxPODrop","New","MenuClickNew")
'	Gui.frmPO..ContextMenuSetItemEventHandler("ctxPODrop","NewAuto","MenuClickNewAuto")

	Gui.frmPO..ContextMenuCreate("ctxPOReqs")
	Gui.frmPO.GsGCReqs.ContextMenuAttach("ctxPOReqs")
	Gui.frmPO..ContextMenuAddItem("ctxPOReqs","Refresh",0,"Refresh")
	Gui.frmPO..ContextMenuAddItem("ctxPOReqs","Export",0,"Export")
	Gui.frmPO..ContextMenuAddItem("ctxPOReqs","Exp",3)
	Gui.frmPO..ContextMenuAddItem("ctxPOReqs","CreateReqPOs",0,"Create Req POs (Auto)")
	Gui.frmPO..ContextMenuSetItemEventHandler("ctxPOReqs","Refresh","cmdRefresh_Click")
	Gui.frmPO..ContextMenuSetItemEventHandler("ctxPOReqs","Export","MenuClickExport")
	Gui.frmPO..ContextMenuSetItemEventHandler("ctxPOReqs","CreateReqPOs","MenuClickCreateAutoPOs")
	
	Gui.frmPO..ContextMenuCreate("ctxDemand")
	Gui.frmPO.GsGCDemand.ContextMenuAttach("ctxDemand")
	Gui.frmPO..ContextMenuAddItem("ctxDemand","Export",0,"Export")
	Gui.frmPO..ContextMenuSetItemEventHandler("ctxDemand","Export","MenuClickExport")
	
	Gui.frmPO..ContextMenuCreate("ctxVendQte")
'	Gui.frmPO.GsGCVendQte.ContextMenuAttach("ctxVendQte")
	Gui.frmPO..ContextMenuAddItem("ctxVendQte","View",0,"View")
	Gui.frmPO..ContextMenuAddItem("ctxVendQte","New",0,"New")
	Gui.frmPO..ContextMenuAddItem("ctxVendQte","Exp",3)
	Gui.frmPO..ContextMenuAddItem("ctxVendQte","Export",0,"Export")
	Gui.frmPO..ContextMenuSetItemEventHandler("ctxVendQte","View","MenuClick")
	Gui.frmPO..ContextMenuSetItemEventHandler("ctxVendQte","New","MenuClick")
	Gui.frmPO..ContextMenuSetItemEventHandler("ctxVendQte","Export","MenuClickExport")
	
	Gui.frmPO..ContextMenuCreate("ctxVendor")
'	Gui.frmPO.GsGCVendQte.ContextMenuAttach("ctxVendor")
	Gui.frmPO..ContextMenuAddItem("ctxVendor","Export",0,"Export")
	Gui.frmPO..ContextMenuSetItemEventHandler("ctxVendor","Export","MenuClickExport")
	
	Gui.frmPO..ContextMenuCreate("ctxSupply")
	Gui.frmPO.GsGCSupply.ContextMenuAttach("ctxSupply")
	Gui.frmPO..ContextMenuAddItem("ctxSupply","Export",0,"Export")
	Gui.frmPO..ContextMenuSetItemEventHandler("ctxSupply","Export","MenuClickExport")
	
	Gui.frmMRP..ContextMenuCreate("ctxMRP")
	Gui.frmMRP.GsGCMRP.ContextMenuAttach("ctxMRP")
	Gui.frmMRP..ContextMenuAddItem("ctxMRP","Export",0,"Export")
	Gui.frmMRP..ContextMenuSetItemEventHandler("ctxMRP","Export","MenuClickExport")
	
	Gui.frmHistory..ContextMenuCreate("ctxHIST")
	Gui.frmHistory.GsGCHistory.ContextMenuAttach("ctxHIST")
	Gui.frmHistory..ContextMenuAddItem("ctxHIST","Export",0,"Export")
	Gui.frmHistory..ContextMenuSetItemEventHandler("ctxHIST","Export","MenuClickExport")
	
	Gui.frmNotes..ContextMenuCreate("ctxNotes")
	Gui.frmNotes.GsGCNotes.ContextMenuAttach("ctxNotes")
	Gui.frmNotes..ContextMenuAddItem("ctxNotes","AddNote",0,"Add Note")
	Gui.frmNotes..ContextMenuSetItemEventHandler("ctxNotes","AddNote","MenuClickAdd")
	Gui.frmNotes..ContextMenuAddItem("ctxNotes","DelNote",0,"Delete Note")
	Gui.frmNotes..ContextMenuSetItemEventHandler("ctxNotes","DelNote","MenuClickDelete")
	Gui.frmNotes..ContextMenuAddItem("ctxNotes","Refresh",0,"Refresh")
	Gui.frmNotes..ContextMenuSetItemEventHandler("ctxNotes","Refresh","LoadDtNotes")
	Gui.frmNotes..ContextMenuAddItem("ctxNotes","Export",0,"Export")
	Gui.frmNotes..ContextMenuSetItemEventHandler("ctxNotes","Export","MenuClickExport")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.SetContextMenus.End

Program.Sub.MenuClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iRet.Declare
	V.Local.sControl.Declare
	V.Local.sGV.Declare
	V.Local.iRow.Declare

	F.Intrinsic.Control.SelectCase(V.Args.ItemName)
		F.Intrinsic.Control.Case("VIEW")
			F.Global.General.LaunchMenuTask(271,2,V.Local.iRet)

		F.Intrinsic.Control.Case("NEW")
			F.Intrinsic.Control.If(V.Global.sPart,<>,"")
				F.Global.General.CallWrapperAsync(175000,V.Global.sPart)
			F.Intrinsic.Control.EndIf
			
		F.Intrinsic.Control.Case("NOTES")
			Gui.frmPO.GsGCPO.GetSelectedRows("gvPO",V.Local.iRow)
			V.Global.sPart2.Set(V.DataTable.dtPO(V.Local.iRow).PART!FieldVal)
			V.Global.sLoc2.Set(V.DataTable.dtPO(V.Local.iRow).LOCATION!FieldVal)
			F.Intrinsic.Control.CallSub(LoadDtNotes)
			Gui.frmNotes..Show
			
		F.Intrinsic.Control.Case("HISTORY")
			F.Intrinsic.Control.SelectCase(V.Screen.frmPO!tabPO.Tab)
				F.Intrinsic.Control.Case(0)
					V.Local.sControl.Set("GsGCPO")
					V.Local.sGV.Set("gvPO")
				F.Intrinsic.Control.Case(1)
					V.Local.sControl.Set("GsGCPOSO")
					V.Local.sGV.Set("gvPOSO")
				F.Intrinsic.Control.Case(2)
					V.Local.sControl.Set("GsGCPODrop")
					V.Local.sGV.Set("gvPODrop")
			F.Intrinsic.Control.EndSelect
			
			Gui.frmPO.[V.Local.sControl].GetSelectedRows(V.Local.sGV,V.Local.iRow)
			F.Intrinsic.Control.CallSub(GsGCPO_RowCellClick,"Column","POHistory","ControlName",V.Local.sControl,"RowIndex",V.Local.iRow)
			
	F.Intrinsic.Control.EndSelect

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClick.End

Program.Sub.MenuClickExport.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sFileExport.Declare
	V.Local.bExcel.Declare
	V.Local.bFileLocked.Declare
	V.Local.sMsg.Declare
	V.Local.sForm.Declare
	V.Local.sControl.Declare
	V.Local.sExt.Declare
	
	F.Intrinsic.Control.SelectCase(V.Args.MenuName)
		F.Intrinsic.Control.Case("CTXPO")
			V.Local.sForm.Set("frmPO")
			V.Local.sControl.Set("GsGCPO")
			
		F.Intrinsic.Control.Case("CTXPODROP")
			V.Local.sForm.Set("frmPO")
			V.Local.sControl.Set("GsGCPODrop")
			
		F.Intrinsic.Control.Case("CTXPOReqs")
			V.Local.sForm.Set("frmPO")
			V.Local.sControl.Set("GsGCReqs")
		
		F.Intrinsic.Control.Case("CTXDEMAND")
			V.Local.sForm.Set("frmPO")
			V.Local.sControl.Set("GsGCDemand")
			
		F.Intrinsic.Control.CaseAny("CTXVENDQTE","CTXVENDOR")
			V.Local.sForm.Set("frmPO")
			V.Local.sControl.Set("GsGCVendQte")
			
		F.Intrinsic.Control.Case("CTXSUPPLY")
			V.Local.sForm.Set("frmPO")
			V.Local.sControl.Set("GsGCSupply")
			
		F.Intrinsic.Control.Case("CTXMRP")
			V.Local.sForm.Set("frmMRP")
			V.Local.sControl.Set("GsGCMRP")
			
		F.Intrinsic.Control.Case("CTXHIST")
			V.Local.sForm.Set("frmHistory")
			V.Local.sControl.Set("GsGCHistory")
			
		F.Intrinsic.Control.Case("CTXNOTES")
			V.Local.sForm.Set("frmNotes")
			V.Local.sControl.Set("GsGCNotes")
	F.Intrinsic.Control.EndSelect

	F.Automation.MSExcel.CheckPresence(V.Local.bExcel)
			F.Intrinsic.Control.If(V.Local.bExcel)
				V.Local.sExt.Set("xlsx")
			F.Intrinsic.Control.Else
				V.Local.sExt.Set("csv")
			F.Intrinsic.Control.EndIf
			
			F.Intrinsic.String.Build("{0}\GAB_5193_Employees_Export.{1}",V.Caller.LocalGssTempDir,V.Local.sExt,V.Local.sFileExport)
			F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
			F.Intrinsic.Control.If(V.Local.bFileLocked)
				F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
				F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
			F.Intrinsic.Control.Else
				Gui.[V.Local.sForm].[V.Local.sControl].Export(V.Local.sFileExport,V.Local.sExt)
				F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
			F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.CatchWhen(5700)
		F.Intrinsic.UI.Msgbox("No Data to Export","Export")
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickExport.End

Program.Sub.MenuClickNew.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iRowCnt.Declare
	V.Local.iRowCnt2.Declare
	V.Local.iRow.Declare
	V.Local.sVendorNo.Declare
	V.Local.sParams.Declare
	V.Local.sDT.Declare
	V.Local.sGV.Declare
	
	F.Intrinsic.Control.SelectCase(V.Args.MenuName)
		F.Intrinsic.Control.Case("CTXPO")
			Gui.frmPO.GsGCPO.GetSelectedRows("gvPO",V.Local.iRow)
			Gui.frmPO.GsGCPO.GetCellValueByColumnName("gvPO","Vendor",V.Local.iRow,V.Local.sVendorNo)
			V.Local.sDT.Set("dtPO")
			
		F.Intrinsic.Control.Case("CTXPODROP")
			Gui.frmPO.GsGCPODrop.GetSelectedRows("gvPODrop",V.Local.iRow)
			Gui.frmPO.GsGCPODrop.GetCellValueByColumnName("gvPODrop","Vendor",V.Local.iRow,V.Local.sVendorNo)
			V.Local.sDT.Set("dtPODrop")
			
	F.Intrinsic.Control.EndSelect

	F.ODBC.Connection!con.ExecuteAndReturn("SELECT COUNT(*) FROM V_PO_HEADER;",V.Local.iRowCnt)
	F.Intrinsic.String.ConcatCallWrapperArgs("N","",V.Local.sVendorNo,V.Local.sParams)
	F.Global.General.CallWrapperSync(175200,V.Local.sParams)
	F.ODBC.Connection!con.ExecuteAndReturn("SELECT COUNT(*) FROM V_PO_HEADER;",V.Local.iRowCnt2)
	F.Intrinsic.Control.If(V.Local.iRowCnt,<>,V.Local.iRowCnt2)
		'Remove/Hide line from the PO Screen
		F.Data.DataTable.DeleteRow(V.Local.sDT,V.Local.iRow)
		F.Data.DataTable.AcceptChanges(V.Local.sDT)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickNew.End

Program.Sub.MenuClickNewAuto.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCnt.Declare
	V.Local.dDueDate.Declare
	V.Local.fExtension.Declare
	V.Local.sSelect.Declare
	
	F.Intrinsic.Control.SelectCase(V.Args.MenuName)
		F.Intrinsic.Control.Case("CTXPO")
			Gui.frmPO.lblStatus.Caption("Generating POs....")
			Gui.frmPO.lblStatus.Visible(True)
			
			F.Intrinsic.Control.If(V.Screen.frmPO!ddlPOs.Text,=,"Individual POs")
				'Create Individual POs
				F.Data.DataTable.Select("dtPO","Select = True",V.Local.sSelect)
				F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
					F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
					F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSelect.UBound,1)
						F.Intrinsic.Control.If(V.DataTable.dtPO(V.Local.sSelect(V.Local.iCnt)).Vendor!FieldValTrim,<>,"")
							V.Local.dDueDate.Set(V.DataTable.dtPO(V.Local.sSelect(V.Local.iCnt)).DATE_DUE!FieldValTrim)
							F.Intrinsic.Math.Mult(V.DataTable.dtPO(V.Local.sSelect(V.Local.iCnt)).Purchase!FieldValTrim,V.DataTable.dtPO(V.Local.sSelect(V.Local.iCnt)).Cost!FieldValTrim,V.Local.fExtension)
							F.Data.DataTable.AddRow("175100","ID",V.Local.sSelect(V.Local.iCnt),"AutoNumber","Y","AddComments","Y","OpenPO","Y")
							F.Data.DataTable.AddRow("175100File","ID",V.Local.sSelect(V.Local.iCnt),"Vendor",V.DataTable.dtPO(V.Local.sSelect(V.Local.iCnt)).Vendor!FieldValTrim,"Part",V.DataTable.dtPO(V.Local.sSelect(V.Local.iCnt)).PART!FieldValTrim,"Loc",V.DataTable.dtPO(V.Local.sSelect(V.Local.iCnt)).LOCATION!FieldValTrim,"DueDate",V.Local.dDueDate.FormatYYYYMMDD,"Description",V.DataTable.dtPO(V.Local.sSelect(V.Local.iCnt)).DESCRIPTION!FieldValTrim,"InvUM",V.DataTable.dtPO(V.Local.sSelect(V.Local.iCnt)).UM!FieldValTrim,"InvCost",V.DataTable.dtPO(V.Local.sSelect(V.Local.iCnt)).Cost!FieldValTrim,"InvQty",V.DataTable.dtPO(V.Local.sSelect(V.Local.iCnt)).Purchase!FieldValTrim,"POUM",V.DataTable.dtPO(V.Local.sSelect(V.Local.iCnt)).UMPurch!FieldValTrim,"POCost",V.DataTable.dtPO(V.Local.sSelect(V.Local.iCnt)).Cost!FieldValTrim,"POQty",V.DataTable.dtPO(V.Local.sSelect(V.Local.iCnt)).Purchase!FieldValTrim,"GLAccount",V.DataTable.dtPO(V.Local.sSelect(V.Local.iCnt)).GLAcct!FieldValTrim,"Extension",V.Local.fExtension)
							'Remove Row From Grid
							F.Data.DataTable.DeleteRow("dtPO",V.Local.sSelect(V.Local.iCnt))
							F.Data.DataTable.AcceptChanges("dtPO")
						F.Intrinsic.Control.Else
							F.Data.DataTable.SetValue("dtPO",V.Local.sSelect(V.Local.iCnt),"Select",False)
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.Next(V.Local.iCnt)
				F.Intrinsic.Control.EndIf
				
				F.Intrinsic.Control.If(V.Local.sSelect.UBound,>,-1)
					F.Intrinsic.Control.CallSub(175100Sync)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.CallSub(MenuClickCreateAutoPOs)
				
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndSelect
	
	Gui.frmPO.lblStatus.Visible(False)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickNewAuto.End

Program.Sub.MenuClickCreateAutoPOs.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCnt.Declare
	V.Local.iCnt2.Declare
	V.Local.dDueDate.Declare
	V.Local.fExtension.Declare
	V.Local.sSelect.Declare
	V.Local.iPO.Declare
	V.Local.sPO.Declare
	V.Local.iPOLine.Declare
	V.Local.sPOLine.Declare
	V.Local.sFilter.Declare
	V.Local.sStatus.Declare
	V.Local.sReturnFileName.Declare
	V.Local.sSQL.Declare
	V.Local.sFileName.Declare
	V.Local.sPURORDER.Declare
	V.Local.sEmailList.Declare
	V.Local.sName.Declare
	V.Local.sNameSplit.Declare
	V.Local.sBuyerCode.Declare
	V.Local.sGV.Declare
	V.Local.sDT.Declare
	
	F.Intrinsic.Control.SelectCase(V.Screen.frmPO!tabPO.Tab)
		F.Intrinsic.Control.Case(0)
			V.Local.sGV.Set("gvPO")
			V.Local.sDT.Set("dtPO")
		F.Intrinsic.Control.Case(1)
			V.Local.sGV.Set("gvPOSO")
			V.Local.sDT.Set("dtPOSO")
		F.Intrinsic.Control.Case(2)
			V.Local.sGV.Set("gvPODrop")
			V.Local.sDT.Set("dtPODrop")
		F.Intrinsic.Control.Case(3)
			V.Local.sGV.Set("gvReqs")
			V.Local.sDT.Set("dtReqs")
	F.Intrinsic.Control.EndSelect
	
	V.Local.sEmailList.Set("***EMPTY***")
	
	'Get Buyer Code
	F.Global.Security.GetFullName(V.Caller.User,V.Local.sName)
	F.Intrinsic.String.Split(V.Local.sName," ",V.Local.sNameSplit)
	F.Intrinsic.Control.If(V.Local.sNameSplit.UBound,=,2)
		F.Intrinsic.String.Build("{0} {1}",V.Local.sNameSplit(0),V.Local.sNameSplit(2),V.Local.sName)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.String.Build("Select Buyer_Code From V_Buyers Where Upper(Buyer) = Upper('{0}');",V.Local.sName,V.Local.sSQL)
	F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSQL,V.Local.sBuyerCode)
	'Create Grouped POs
	F.Data.DataView.Create(V.Local.sDT,"dvPOVends",22,"Select = True And VendorName <> ''","")
	F.Data.DataView.ToDataTableDistinct(V.Local.sDT,"dvPOVends","dtPOVends","Vendor*!*VendorName",True)
	F.Data.DataView.Close(V.Local.sDT,"dvPOVends")
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtPOVends.RowCount--,1)
		F.Intrinsic.String.Build("Select = True And Vendor = '{0}'",V.DataTable.dtPOVends(V.Local.iCnt).Vendor!FieldValTrim,V.Local.sFilter)
		F.Data.DataTable.Select(V.Local.sDT,V.Local.sFilter,V.Local.sSelect)
		F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
			F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
			F.Intrinsic.Control.For(V.Local.iCnt2,0,V.Local.sSelect.UBound,1)
				'Set PO Number
				F.ODBC.Connection!con.ExecuteAndReturn("Select Last_PO_Num From Last_PO Where Ass_Sys = 'PUR' And Ass_Sub_Sys = 'CTL';",V.Local.iPO)
				F.Intrinsic.String.LPad(V.Local.iPO.++,"0",7,V.Local.sPO)
				'Set PO Line
				F.Intrinsic.Math.Add(V.Local.iCnt2,1,V.Local.iPOLine)
				F.Intrinsic.String.LPad(V.Local.iPOLine,"0",3,V.Local.sPOLine)
				'Create Upload File: PURORDER.txt
				F.Intrinsic.Control.CallSub("GenerateGroupedPOs","PO",V.Local.sPO,"POLine",V.Local.sPOLine,"Vendor",V.DataTable.dtPOVends(V.Local.iCnt).Vendor!FieldValTrim,"DueDate",V.DataTable.[V.Local.sDT](V.Local.sSelect(V.Local.iCnt2)).DATE_DUE!FieldValTrim,"Part",V.DataTable.[V.Local.sDT](V.Local.sSelect(V.Local.iCnt2)).Part!FieldValTrim,"Loc",V.DataTable.[V.Local.sDT](V.Local.sSelect(V.Local.iCnt2)).Location!FieldValTrim,"Description",V.DataTable.[V.Local.sDT](V.Local.sSelect(V.Local.iCnt2)).Description!FieldValTrim,"UM",V.DataTable.[V.Local.sDT](V.Local.sSelect(V.Local.iCnt2)).UM!FieldValTrim,"PL",V.DataTable.[V.Local.sDT](V.Local.sSelect(V.Local.iCnt2)).PL!FieldValTrim,"Cost",V.DataTable.[V.Local.sDT](V.Local.sSelect(V.Local.iCnt2)).Cost!FieldValTrim,"Qty",V.DataTable.[V.Local.sDT](V.Local.sSelect(V.Local.iCnt2)).Purchase!FieldValTrim,"BuyerCode",V.Local.sBuyerCode,"GLAccount",V.DataTable.[V.Local.sDT](V.Local.sSelect(V.Local.iCnt2)).GLAcct!FieldValTrim,"ReqNo",V.DataTable.[V.Local.sDT](V.Local.sSelect(V.Local.iCnt2)).PO_Req_Number!FieldVal,"ReqLine",V.DataTable.[V.Local.sDT](V.Local.sSelect(V.Local.iCnt2)).PO_Req_Line!FieldVal)
				'Set data to text file variable
				F.Intrinsic.Control.If(V.Local.sPURORDER,=,"")
					V.Local.sPURORDER.Set(v.Args.POTEXT)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("{0}{1}",V.Local.sPURORDER,V.Args.POTEXT,V.Local.sPURORDER)
				F.Intrinsic.Control.EndIf
				'Update On Order PO in Invenoty_Mstr (I1MST)
				F.Intrinsic.String.Build("Update Inventory_Mstr Set Qty_OnOrder_PO = Qty_OnOrder_PO + {0} Where Part = '{1}' And Location = '{2}';",V.DataTable.[V.Local.sDT](V.Local.sSelect(V.Local.iCnt2)).Purchase!FieldValTrim,V.DataTable.[V.Local.sDT](V.Local.sSelect(V.Local.iCnt2)).Part!FieldValTrim,V.DataTable.[V.Local.sDT](V.Local.sSelect(V.Local.iCnt2)).Location!FieldValTrim,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Next(V.Local.iCnt2)
			'Write PO info to PURORDER.txt
			F.Intrinsic.String.Build("{0}\PURORDER.txt",V.Caller.FilesDir,V.Local.sFileName)
			F.Intrinsic.File.String2File(V.Local.sFileName,V.Local.sPURORDER)
			'Upload PO File
			F.Global.Callwrapper.New("POUpload","Purchasing.PurchaseOrderUpload")
			F.Global.Callwrapper.SetProperty("POUpload","Mode",0)
			F.Global.Callwrapper.SetProperty("POUpload","FileName","PURORDER")
			F.Global.CallWrapper.Run("POUpload")
			F.Global.CallWrapper.GetProperty("POUpload","Status",V.Local.sStatus)
			F.Global.CallWrapper.GetProperty("POUpload","ReturnFileName",V.Local.sReturnFileName)
			'Update Last PO Number
			F.Intrinsic.String.Build("Update Last_PO Set Last_PO_Num = '{0}' Where Ass_Sys = 'PUR' And Ass_Sub_Sys = 'CTL';",V.Local.sPO,V.Local.sSQL)
			F.ODBC.Connection!Con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.If(V.Local.sEmailList,=,"***EMPTY***")
				F.Intrinsic.String.Build("'{0}'",V.Local.sPO,V.Local.sEmailList)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("{0},'{1}'",V.Local.sEmailList,V.Local.sPO,V.Local.sEmailList)
			F.Intrinsic.Control.EndIf
			'Delete PURORDER.txt
			F.Intrinsic.File.DeleteFile(V.Local.sFileName)
			V.Local.sPURORDER.Set("")
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)
	F.Data.DataTable.Close("dtPOVends")
	
	'Remove Lines from DataTable
	F.Data.DataTable.Select(V.Local.sDT,"Select = True And VendorName <> ''",V.Local.sSelect)
	F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
		F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
		F.Intrinsic.Control.For(V.Local.iCnt,V.Local.sSelect.UBound,0,-1)
			'Move Purchase Requisition to History
			F.Intrinsic.Control.If(V.Local.sDT,=,"dtReqs")
				F.Intrinsic.Control.CallSub(MovePurchReqToHist,"POReqNum",V.DataTable.[V.Local.sDT](V.Local.sSelect(V.Local.iCnt)).PO_Req_Number!FieldValTrim,"POReqLine",V.DataTable.[V.Local.sDT](V.Local.sSelect(V.Local.iCnt)).PO_Req_Line!FieldValTrim)
			F.Intrinsic.Control.EndIf
			'Delete Rows
			F.Data.DataTable.DeleteRow(V.Local.sDT,V.Local.sSelect(V.Local.iCnt))
			F.Data.DataTable.AcceptChanges(V.Local.sDT)
		F.Intrinsic.Control.Next(V.Local.iCnt)
		F.Data.DataTable.SetValue(V.Local.sDT,-1,"Select",False)
	F.Intrinsic.Control.EndIf

	'Emails
	F.Intrinsic.Control.If(V.Local.sEmailList,<>,"***EMPTY***")
		F.Intrinsic.Control.CallSub(GenerateEmail,"EmailList",V.Local.sEmailList)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickCreateAutoPOs.End

Program.Sub.GenerateGroupedPOs.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare
	V.Local.sVenName.Declare
	V.Local.sVenAdd1.Declare
	V.Local.sVenAdd2.Declare
	V.Local.sVenState.Declare
	V.Local.sVenZip.Declare
	V.Local.sVenCity.Declare
	V.Local.sVenAttn.Declare
	V.Local.sVenGL.Declare
	V.Local.sGL.Declare
	V.Local.sCurrency.Declare
	V.local.sPODate.Declare
	V.local.sPODueDate.Declare
	V.Local.sRet.Declare
	V.Local.sTemp.Declare
	V.Local.sTempFull.Declare

	F.Intrinsic.Control.If(V.Args.POLine,=,001)
	'-------------------------------------------------------------------# Header #-------------------------------------------------------------------
		F.Intrinsic.String.Build("Select A.Vendor,A.Name_Vendor,A.Address1,A.Address2,A.City,A.Rec,A.State,A.Code_Zip,A.Country,A.Attention,A.Normal_GL_Account,B.Default_Currency As CurrencyCode From V_Vendor_Master A Left Join V_Vendor_Intl As B on A.Vendor = B.Vendor Where A.Vendor = '{0}';",V.Args.Vendor,V.Local.sSQL)
		F.ODBC.Connection!Con.OpenLocalRecordsetRO("rstVend",V.Local.sSQL)
		F.Intrinsic.Control.If(V.ODBC.Con!rstVend.EOF,=,False)
			V.Local.sVenName.set(V.ODBC.Con!rstVend.FieldVal!Name_Vendor)
			V.Local.sVenAdd1.set(V.ODBC.Con!rstVend.FieldVal!Address1)
			V.Local.sVenAdd2.set(V.ODBC.Con!rstVend.FieldVal!Address2)
			V.Local.sVenState.set(V.ODBC.Con!rstVend.FieldVal!State)
			V.Local.sVenZip.set(V.ODBC.Con!rstVend.FieldVal!Code_Zip)
			V.Local.sVenCity.set(V.ODBC.Con!rstVend.FieldVal!City)
			V.Local.sVenAttn.set(V.ODBC.Con!rstVend.FieldVal!Attention)
			V.Local.sVenGL.set(V.ODBC.Con!rstVend.FieldVal!Normal_GL_Account)
			V.Local.sCurrency.set(V.ODBC.Con!rstVend.FieldVal!CurrencyCode)
		F.Intrinsic.Control.EndIf
		F.ODBC.Con!rstVend.Close
		'PO Date
		F.Intrinsic.String.Format(V.Ambient.Date,"MMDDYY",V.local.sPODate)
		'RequiredDate,DueDate
		F.Intrinsic.String.Format(V.Args.DueDate,"MMDDYY",V.local.sPODueDate)
	'A Record
		'PO,Rec Type
		F.Intrinsic.String.Concat(V.Args.PO,"  A",V.Local.sTemp)
		F.Intrinsic.String.RPad(V.Local.sTemp," ",12,V.Local.sTemp)
		'Buyer
		V.Local.sRet.Set("")
		F.Intrinsic.String.RPad(V.Args.BuyerCode," ",7,V.Local.sRet)
		F.Intrinsic.String.Concat(V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
		'Ship Via
		V.Local.sRet.Set("")
		F.Intrinsic.String.RPad(V.Local.sRet," ",15,V.Local.sRet)
		F.Intrinsic.String.Concat(V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
		'FOB
		V.Local.sRet.Set("")
		F.Intrinsic.String.RPad(V.Local.sRet," ",15,V.Local.sRet)
		F.Intrinsic.String.Concat(V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
		'Terms
		V.Local.sRet.Set("")
		F.Intrinsic.String.RPad(V.Local.sRet," ",12,V.Local.sRet)
		F.Intrinsic.String.Concat(V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
		'PO Date
		F.Intrinsic.String.Rpad(V.Local.sTemp," ",195,V.Local.sTemp)
		F.Intrinsic.String.Concat(V.Local.sTemp,V.local.sPODate,V.Local.sTemp)
		F.Intrinsic.String.RPad(V.Local.sTemp," ",207,V.Local.sTemp)
		'Date Due
		F.Intrinsic.String.Concat(V.Local.sTemp,V.local.sPODueDate,V.Local.sTemp)
		F.Intrinsic.String.RPad(V.Local.sTemp," ",229,V.Local.sTemp)
		'GL Account
		V.Local.sGL.Set(V.Args.GLAccount)
		F.Intrinsic.Control.If(V.Local.sGL.Trim,=,"")
			V.Local.sGL.Set(V.Local.sVenGL)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.String.Concat(V.Local.sTemp,V.Local.sGL,V.Local.sTemp)
		F.Intrinsic.String.RPad(V.Local.sTemp," ",267,V.Local.sTemp)
		'Vendor #
		F.Intrinsic.String.Concat(V.Local.sTemp,V.Args.Vendor,V.Local.sTemp)
		F.Intrinsic.String.RPad(V.Local.sTemp," ",298,V.Local.sTemp)
		'User 1
		F.Intrinsic.String.Concat(V.Local.sTemp,"",V.Local.sTemp)
		'New Line
		F.Intrinsic.String.Concat(V.Local.sTempFull,V.Local.sTemp,V.Ambient.NewLine,V.Local.sTempFull)
	'B Record
		'PO,Rec Type,Name Vendor
		F.Intrinsic.String.Concat(V.Args.PO,"  B",V.Local.sVenName,V.Local.sTemp)
		F.Intrinsic.String.RPad(V.Local.sTemp," ",40,V.Local.sTemp)
		'Vendor Address
		F.Intrinsic.String.Concat(V.Local.sTemp,V.Local.sVenAdd1,V.Local.sTemp)
		F.Intrinsic.String.RPad(V.Local.sTemp," ",70,V.Local.sTemp)
		F.Intrinsic.String.Concat(V.Local.sTemp,V.Local.sVenAdd2,V.Local.sTemp)
		F.Intrinsic.String.RPad(V.Local.sTemp," ",190,V.Local.sTemp)
		F.Intrinsic.String.Concat(V.Local.sTemp,V.Local.sVenCity,V.Local.sTemp)
		F.Intrinsic.String.RPad(V.Local.sTemp," ",210,V.Local.sTemp)
		F.Intrinsic.String.Concat(V.Local.sTemp,V.Local.sVenState,V.Local.sTemp)
		F.Intrinsic.String.RPad(V.Local.sTemp," ",212,V.Local.sTemp)
		F.Intrinsic.String.Concat(V.Local.sTemp,V.Local.sVenZip,V.Local.sTemp)
		F.Intrinsic.String.RPad(V.Local.sTemp," ",237,V.Local.sTemp)
		'Attention
		F.Intrinsic.String.Concat(V.Local.sTemp,V.Local.sVenAttn,V.Local.sTemp)
		'New Line
		F.Intrinsic.String.Concat(V.Local.sTempFull,V.Local.sTemp,V.Ambient.NewLine,V.Local.sTempFull)
	'C Record
		F.Intrinsic.String.Concat(V.Args.PO,"  C",V.DataTable.dtCompany(0).NAME_COMPANY!FieldValTrim,V.Local.sTemp)
		F.Intrinsic.String.RPad(V.Local.sTemp," ",40,V.Local.sTemp)
		'Vendor Address
		F.Intrinsic.String.Concat(V.Local.sTemp,V.DataTable.dtCompany(0).ADDRESS1!FieldValTrim,V.Local.sTemp)
		F.Intrinsic.String.RPad(V.Local.sTemp," ",70,V.Local.sTemp)
		F.Intrinsic.String.Concat(V.Local.sTemp,V.DataTable.dtCompany(0).ADDRESS2!FieldValTrim,V.Local.sTemp)
		F.Intrinsic.String.RPad(V.Local.sTemp," ",190,V.Local.sTemp)
		F.Intrinsic.String.Concat(V.Local.sTemp,V.DataTable.dtCompany(0).CITY!FieldValTrim,V.Local.sTemp)
		F.Intrinsic.String.RPad(V.Local.sTemp," ",210,V.Local.sTemp)
		F.Intrinsic.String.Concat(V.Local.sTemp,V.DataTable.dtCompany(0).STATE!FieldValTrim,V.Local.sTemp)
		F.Intrinsic.String.RPad(V.Local.sTemp," ",212,V.Local.sTemp)
		F.Intrinsic.String.Concat(V.Local.sTemp,V.DataTable.dtCompany(0).CODE_ZIP!FieldValTrim,V.Local.sTemp)
		F.Intrinsic.String.RPad(V.Local.sTemp," ",237,V.Local.sTemp)
		'Attention
		F.Intrinsic.String.Concat(V.Local.sTemp,V.DataTable.dtCompany(0).ATTENTION!FieldValTrim,V.Local.sTemp)
		'New Line
		F.Intrinsic.String.Concat(V.Local.sTempFull,V.Local.sTemp,V.Ambient.NewLine,V.Local.sTempFull)
	F.Intrinsic.Control.EndIf
	
	'-------------------------------------------------------------------# Line #-------------------------------------------------------------------
	'PO, Line,Part
	F.Intrinsic.String.Concat(V.Args.PO,V.Args.POLine,V.Args.Part,V.Local.sTemp)
	F.Intrinsic.String.RPad(V.Local.sTemp," ",30,V.Local.sTemp)
	'Loc
	F.Intrinsic.String.Concat(V.Local.sTemp,V.Args.Loc,V.Local.sTemp)
	F.Intrinsic.String.RPad(V.Local.sTemp," ",32,V.Local.sTemp)
	'Description
	F.Intrinsic.String.Concat(V.Local.sTemp,V.Args.Description.Trim,V.Local.sTemp)
	F.Intrinsic.String.RPad(V.Local.sTemp," ",62,V.Local.sTemp)
	'UM
	F.Intrinsic.String.Concat(V.Local.sTemp,V.Args.UM.Trim,V.Local.sTemp)
	F.Intrinsic.String.Rpad(V.Local.sTemp," ",65,V.Local.sTemp)
	'Work Order Number
	F.Intrinsic.String.Concat(V.Local.sTemp,"",V.Local.sTemp)
	F.Intrinsic.String.Rpad(V.Local.sTemp," ",71,V.Local.sTemp)
	'Work Order Sequence
	F.Intrinsic.String.Concat(V.Local.sTemp,"",V.Local.sTemp)
	F.Intrinsic.String.Rpad(V.Local.sTemp," ",77,V.Local.sTemp)
	'Requisition Number
	F.Intrinsic.Control.If(V.Args.ReqNo.Trim,=,"")
		F.Intrinsic.String.Concat(V.Local.sTemp,"      ",V.Local.sTemp)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Concat(V.Local.sTemp,V.Args.ReqNo,V.Local.sTemp)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.String.Rpad(V.Local.sTemp," ",87,V.Local.sTemp)
	'Taxable
	F.Intrinsic.String.Concat(V.Local.sTemp,"",V.Local.sTemp)
	F.Intrinsic.String.RPad(V.Local.sTemp," ",100,V.Local.sTemp)
	'GL Account
	F.Intrinsic.String.Concat(V.Local.sTemp,"",V.Local.sTemp)
	F.Intrinsic.String.RPad(V.Local.sTemp," ",121,V.Local.sTemp)
	'PL
	F.Intrinsic.String.Concat(V.Local.sTemp,V.Args.PL.Trim,V.Local.sTemp)
	F.Intrinsic.String.RPad(V.Local.sTemp," ",124,V.Local.sTemp)
	'Required Date Line DueDate
	F.Intrinsic.String.Format(V.Args.DueDate,"MMDDYY",V.local.sPODueDate)
	F.Intrinsic.String.Concat(V.Local.sTemp,V.local.sPODueDate,V.Local.sTemp)
	F.Intrinsic.String.RPad(V.Local.sTemp," ",136,V.Local.sTemp)
	'Cost
	F.Intrinsic.String.Concat(V.Local.sTemp,V.Args.Cost,V.Local.sTemp)
	F.Intrinsic.String.RPad(V.Local.sTemp," ",168,V.Local.sTemp)
	'Qty
	F.Intrinsic.String.Concat(V.Local.sTemp,V.Args.Qty,V.Local.sTemp)
	F.Intrinsic.String.RPad(V.Local.sTemp," ",266,V.Local.sTemp)
	'Work Order Sequence
	F.Intrinsic.String.Concat(V.Local.sTemp,"",V.Local.sTemp)
	F.Intrinsic.String.Rpad(V.Local.sTemp," ",339,V.Local.sTemp)
	'Currency
	F.Intrinsic.String.Concat(V.Local.sTemp,V.Local.sCurrency,V.Local.sTemp)
	F.Intrinsic.String.RPad(V.Local.sTemp," ",548,V.Local.sTemp)
	'Requisition Line
	F.Intrinsic.Control.If(V.Args.ReqLine.Trim,=,"")
		F.Intrinsic.String.Concat(V.Local.sTemp,"   ",V.Local.sTemp)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Concat(V.Local.sTemp,V.Args.ReqLine,V.Local.sTemp)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.String.Rpad(V.Local.sTemp," ",551,V.Local.sTemp)
	'Add line to variable that will be written to PURORDER.txt
	F.Intrinsic.String.Concat(V.Local.sTempFull,V.Local.sTemp,V.Ambient.NewLine,V.Local.sTempFull)
	
	'Return upload text
	F.Intrinsic.Variable.AddRV("POTEXT",V.Local.sTempFull)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GenerateGroupedPOs.End

Program.Sub.MovePurchReqToHist.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.sSQL.Declare
	
	'INSERT Record
	F.Intrinsic.String.Build("INSERT INTO REQ_HIST SELECT * FROM PURCHASE_REQS WHERE PO_REQ_NUMBER = '{0}' AND PO_REQ_LINE = '{1}';",V.Args.POReqNum,V.Args.POReqLine,V.Local.sSQL)
	F.ODBC.Connection!con.Execute(V.Local.sSQL)
	
	'DELETE Record
	F.Intrinsic.String.Build("DELETE FROM PURCHASE_REQS WHERE PO_REQ_NUMBER = '{0}' AND PO_REQ_LINE = '{1}';",V.Args.POReqNum,V.Args.POReqLine,V.Local.sSQL)
	F.ODBC.Connection!con.Execute(V.Local.sSQL)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MovePurchReqToHist.End

Program.Sub.CheckCostOpt.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.sRet.Declare
	
	F.Intrinsic.Control.BlockEvents
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"OCTSRS.NET.EXE",4936,2000,5,"",V.Local.sRet)
	Gui.frmPO.ddlCost.Text(V.Local.sRet)
	F.Intrinsic.Control.UnBlockEvents

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckCostOpt.End

Program.Sub.SaveCostOpt.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"OCTSRS.NET.EXE",4936,2000,False,V.Screen.frmPO!ddlCost.Text,False,0,-999.0,1/1/1980,12:00:00 AM)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.SaveCostOpt.End

Program.Sub.CheckPOOpt.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.sRet.Declare
	
	F.Intrinsic.Control.BlockEvents
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"OCTSRS.NET.EXE",4936,3000,5,"",V.Local.sRet)
	Gui.frmPO.ddlPOs.Text(V.Local.sRet)
	
	F.Intrinsic.Control.If(V.Local.sRet,=,"Individual POs")
		Gui.frmPO.ddlEmail.Enabled(False)
		Gui.frmPO.ddlEmail.Text("Do Not Email")
	F.Intrinsic.Control.Else
		Gui.frmPO.ddlEmail.Enabled(True)
		F.Intrinsic.Control.CallSub(CheckEmailOpt)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.UnBlockEvents

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckPOOpt.End

Program.Sub.SavePOOpt.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"OCTSRS.NET.EXE",4936,3000,False,V.Screen.frmPO!ddlPOs.Text,False,0,-999.0,1/1/1980,12:00:00 AM)
	F.Intrinsic.Control.CallSub(CheckPOOpt)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.SavePOOpt.End

Program.Sub.CheckEmailOpt.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.sRet.Declare
	
	F.Intrinsic.Control.BlockEvents
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"OCTSRS.NET.EXE",4936,4000,5,"",V.Local.sRet)
	Gui.frmPO.ddlEmail.Text(V.Local.sRet)
	F.Intrinsic.Control.UnBlockEvents
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckEmailOpt.End

Program.Sub.SaveEmailOpt.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"OCTSRS.NET.EXE",4936,4000,False,V.Screen.frmPO!ddlEmail.Text,False,0,-999.0,1/1/1980,12:00:00 AM)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.SaveEmailOpt.End

Program.Sub.GetVendors.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtVendStat.Exists,=,False)
		'Name_Vendor
		F.Data.Dictionary.CreateFromSQL("dVendorName","con","Select RTrim(Vendor) As Vendor,RTrim(Name_Vendor) From V_Vendor_Master Where Vendor <> '' Order By Vendor;")
		F.Data.Dictionary.SetDefaultReturn("dVendorName","")
		
		'GL Acct
		F.Data.Dictionary.CreateFromSQL("dGLAcct","con","Select Product_Line,RTrim(Purchasing_Account) As Purchasing_Account From V_Product_Line Where Product_Line <> '' Order by 1;")
		F.Data.Dictionary.SetDefaultReturn("dGLAcct","")
		
		'Vendors
		'F.Data.DataTable.CreateFromSQL("dtVendStat","con","Select Part+Location As PartLoc,RTrim(Vendor) As Vendor,Date_Received,2 As Status From V_PO_History Where Part <> '' Union Select A.Part+A.Location As PartLoc,RTrim(B.Name_Vendor) As Vendor,Cast(DateAdd(Day,1,CurDate()) As Date) As Date_Received,1 As Status From Inventory_Mstr A Join Inventory_Mst2 B On A.Part = B.Part And A.Location = B.Location Where B.Name_Vendor <> '' Order By Status,PartLoc,Date_Received Desc;",True)
		F.Data.DataTable.CreateFromSQL("dtVendStat1","con","Select A.Part+A.Location As PartLoc,RTrim(B.Name_Vendor) As Vendor,Cast(DateAdd(Day,1,CurDate()) As Date) As Date_Received,1 As Status From Inventory_Mstr A Join Inventory_Mst2 B On A.Part = B.Part And A.Location = B.Location Where B.Name_Vendor <> '';",True)
		F.Data.DataTable.CreateFromSQL("dtVendStat2","con","Select Part+Location As PartLoc,RTrim(Vendor) As Vendor,Cast(Date_Received As Date) As Date_Received,2 As Status From V_PO_History Where Part <> '' And Date_Received <> '1900-01-01';",True)
		F.Data.DataTable.Merge("dtVendStat2","dtVendStat1",True,3)
		F.Data.DataView.Create("dtVendStat1","dvVendStat1",22,"","Status,PartLoc,Date_Received Desc")
		F.Data.DataView.ToDataTable("dtVendStat1","dvVendStat1","dtVendStat",True)
		F.Data.DataTable.Close("dtVendStat1")
		F.Data.DataTable.Close("dtVendStat2")
		F.Data.Dictionary.CreateFromDataTable("dVendor","dtVendStat","PartLoc","Vendor")
		F.Data.Dictionary.SetDefaultReturn("dVendor","")
		
		'Status
		F.Data.Dictionary.CreateFromDataTable("dStatus","dtVendStat","PartLoc","Status")
		F.Data.Dictionary.SetDefaultReturn("dStatus",0)
		
		'Buyer Code
		F.Data.Dictionary.CreateFromSQL("dBuyerCode","con","Select Vendor,Buyer From V_Vendor_Master Where Vendor <> '' And Buyer <> '' Order By Vendor;")
		F.Data.Dictionary.SetDefaultReturn("dBuyerCode","")
		
		'Buyer Name
		F.Data.Dictionary.CreateFromSQL("dBuyerName","con","Select Buyer_Code,RTRIM(Buyer) As Buyer From V_Buyers;")
		F.Data.Dictionary.SetDefaultReturn("dBuyerName","")
		
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GetVendors.End

Program.Sub.SetPrefVendor.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iRet.Declare
	V.Local.sGssPart.Declare
	V.Local.sMsg.Declare
	V.Local.sSQL.Declare
	
	F.Intrinsic.String.GSSPartString(V.Passed.000019,V.Passed.000020,V.Local.sGssPart)
	F.Intrinsic.String.Build("Set {0} ({1}) as the Preferred Vendor for {2}?",V.Passed.000012,V.Passed.000011,V.Local.sGssPart.Trim,V.Local.sMsg)
	F.Intrinsic.UI.Msgbox(V.Local.sMsg,"Set Preferred Vendor",4,V.Local.iRet)
	F.Intrinsic.Control.If(V.Local.iRet,=,6)
		'Save Preferred Vendor to Inventory_Mst2
		F.Intrinsic.String.Build("Update Inventory_Mst2 Set Name_Vendor = '{0}' Where Part = '{1}' And Location = '';",V.Passed.000011,V.Local.sGssPart,V.Local.sSQL)
		F.ODBC.Connection!con.Execute(V.Local.sSQL)
		F.Intrinsic.UI.Msgbox("Preferred Vendor Updated","Set Preferred Vendor")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.SetPrefVendor.End

Program.Sub.cmdRefresh_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
'	f.Data.Dictionary.Close("WOProj")
'	f.Data.Dictionary.CreateFromSQL("WOProj","con","Select Distinct WO + '-' + WO_Suff as Record,dpas_text from Project_XRef p left join GCG_4857_DPAS_PROJ d on p.Project = d.Project where DPAS = 1")
'	f.Data.Dictionary.SetDefaultReturn("WOProj","")
	
	F.Intrinsic.Control.CallSub(GetVendors)
	F.Intrinsic.Control.CallSub(InvCheck)
	F.Intrinsic.Control.CallSub(InvCheckDrop)
	F.Intrinsic.Control.CallSub(LoadCost)
	F.Intrinsic.Control.CallSub(LoadRequisitions)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdRefresh_Click.End

Program.Sub.tabPO_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmPO.lblDemand.Caption("Demand")
	Gui.frmPO.lblVendQte.Caption("Vendor Quote")
	Gui.frmPO.lblSupply.Caption("Supply")
	
	F.Intrinsic.Control.If(V.DataTable.dtDemand.Exists)
		Gui.frmPO.GsGCDemand.ClearRows("gvDemand")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.DataTable.dtVendQteLines.Exists)
		Gui.frmPO.GsGCVendQte.ClearRows("gvVendQte")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.DataTable.dtGetVendQtes.Exists)
		F.Data.DataTable.DeleteRow("dtGetVendQtes")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.DataTable.dtSupply.Exists)
		Gui.frmPO.GsGCSupply.ClearRows("gvSupply")
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.tabPO_Click.End

Program.Sub.InvCheck.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare
	V.Local.iCnt.Declare
	V.Local.fSum1.Declare
	V.Local.fSum2.Declare
	V.Local.fCurOnHand.Declare
	V.Local.fBalance.Declare
	V.Local.bDic.Declare
	V.Local.dCutoff.Declare

	F.Intrinsic.Control.If(V.DataTable.dtInvCheck.Exists)
		F.Data.DataTable.Close("dtInvCheck")
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.DataTable.dtDemand.Exists)
		Gui.frmPO.lblDemand.Caption("Demand")
		Gui.frmPO.GsGCDemand.ClearRows("gvDemand")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.DataTable.dtVendQteLines.Exists)
		Gui.frmPO.lblVendQte.Caption("Vendor Quote")
		Gui.frmPO.GsGCVendQte.ClearRows("gvVendQte")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.DataTable.dtSupply.Exists)
		Gui.frmPO.lblSupply.Caption("Supply")
		Gui.frmPO.GsGCSupply.ClearRows("gvSupply")
	F.Intrinsic.Control.EndIf
	
	Gui.frmPO.lblStatus.Caption("Loading Purchase Orders by Work Orders....")
	Gui.frmPO.lblStatus.Visible(True)
	Gui.frmPO.progBarStatus.Visible(True)
	V.Global.sPart.Set("")
	
	V.Local.dCutoff.Set(V.Screen.frmPO!dtpCutoff.Value)

	'F.Data.DataTable.CreateFromSQL("dtInvCheck","con","SELECT A.PART+A.LOCATION AS PMAST,A.PART,A.LOCATION,A.DESCRIPTION,A.PRODUCT_LINE,A.CODE_SORT,A.TIME_MATERIAL_LEAD,QTY_ORDER,QTY_ONHAND,QTY_REQUIRED,QTY_ONORDER_PO,QTY_REORDER,UM_INVENTORY,UM_PURCHASING,FACTOR_CONVERSION,NAME_VENDOR FROM V_INVENTORY_MSTR A JOIN V_INVENTORY_MST2 B ON A.PART = B.PART AND A.LOCATION = B.LOCATION WHERE B.CODE_SOURCE = 'P' UNION SELECT A.PART+A.LOCATION AS PMAST,A.PART,A.LOCATION,A.DESCRIPTION,A.PRODUCT_LINE,A.CODE_SORT,A.TIME_MATERIAL_LEAD,A.QTY_ORDER,A.QTY_ONHAND,A.QTY_REQUIRED,A.QTY_ONORDER_PO,A.QTY_REORDER,A.UM_INVENTORY,A.UM_PURCHASING,A.FACTOR_CONVERSION,B.NAME_VENDOR FROM V_INVENTORY_MSTR A JOIN V_INVENTORY_MST2 B ON A.PART = B.PART AND A.LOCATION = B.LOCATION JOIN V_INVENTORY_MST3 C ON A.PART = C.PART AND A.LOCATION = C.LOCATION WHERE C.TEMP_PURCH = 'Y' ORDER BY PMAST;",True)
	F.Data.DataTable.CreateFromSQL("dtInvCheck","con","SELECT A.PART+A.LOCATION AS PMAST,A.PART,A.LOCATION,A.DESCRIPTION,A.PRODUCT_LINE,A.CODE_SORT,A.TIME_MATERIAL_LEAD,QTY_ORDER,QTY_ONHAND,QTY_ONORDER_PO,QTY_REORDER,UM_INVENTORY,UM_PURCHASING,FACTOR_CONVERSION,NAME_VENDOR FROM V_INVENTORY_MSTR A JOIN V_INVENTORY_MST2 B ON A.PART = B.PART AND A.LOCATION = B.LOCATION WHERE B.CODE_SOURCE IN ('P') UNION SELECT A.PART+A.LOCATION AS PMAST,A.PART,A.LOCATION,A.DESCRIPTION,A.PRODUCT_LINE,A.CODE_SORT,A.TIME_MATERIAL_LEAD,A.QTY_ORDER,A.QTY_ONHAND,A.QTY_ONORDER_PO,A.QTY_REORDER,A.UM_INVENTORY,A.UM_PURCHASING,A.FACTOR_CONVERSION,B.NAME_VENDOR FROM V_INVENTORY_MSTR A JOIN V_INVENTORY_MST2 B ON A.PART = B.PART AND A.LOCATION = B.LOCATION JOIN V_INVENTORY_MST3 C ON A.PART = C.PART AND A.LOCATION = C.LOCATION WHERE C.TEMP_PURCH = 'Y' ORDER BY PMAST;",True)
	F.Data.DataTable.AddColumn("dtInvCheck","QTY_COMMITTED_WO",Float,0.0000)
	F.Data.DataTable.AddColumn("dtInvCheck","QTY_COMMITTED_SO",Float,0.0000)
	F.Data.DataTable.AddColumn("dtInvCheck","CurOnHand",Float,0.0000)
	F.Data.DataTable.AddColumn("dtInvCheck","BALANCE",Float,0.0000)
	F.Data.DataTable.AddExpressionColumn("dtInvCheck","QTY_REQUIRED",Float,"QTY_COMMITTED_WO+QTY_COMMITTED_SO")
	
	F.Intrinsic.Control.If(V.Screen.frmPO!chkCutoff.Value,=,0)
		F.Data.Dictionary.CreateFromSQL("dicJobCom","con","SELECT PART+LOCATION AS PMAST,SUM(QTY_COMMITTED-QTY_ISSUED) AS QTY_COMMITTED FROM V_JOB_COMMITMENTS GROUP BY PMAST;")
		F.Data.Dictionary.SetDefaultReturn("dicJobCom",0.0000)
		F.Data.DataTable.FillFromDictionary("dtInvCheck","dicJobCom","PMAST","QTY_COMMITTED_WO")
		F.Data.Dictionary.Close("dicJobCom")
		
		F.Data.Dictionary.CreateFromSQL("dicSOCom","con","SELECT PART+LOCATION AS PMAST,SUM(QTY_BO) AS QTY_COMMITTED FROM V_ORDER_LINES GROUP BY PMAST;")
		F.Data.Dictionary.SetDefaultReturn("dicSOCom",0.0000)
		F.Data.DataTable.FillFromDictionary("dtInvCheck","dicSOCom","PMAST","QTY_COMMITTED_SO")
		F.Data.Dictionary.Close("dicSOCom")
		
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("SELECT A.PART+A.LOCATION AS PMAST,SUM(QTY_COMMITTED-QTY_ISSUED) AS QTY_COMMITTED FROM V_JOB_COMMITMENTS A JOIN V_INVENTORY_MSTR B ON A.PART = B.PART AND A.LOCATION = B.LOCATION WHERE DATEADD(DAY,-TIME_MATERIAL_LEAD,A.DATE_DUE) <= '{0}' GROUP BY PMAST;",V.Local.dCutoff.PervasiveDate,V.Local.sSQL)
		F.Data.Dictionary.CreateFromSQL("dicJobCom","con",V.Local.sSQL)
		F.Data.Dictionary.SetDefaultReturn("dicJobCom",0.0000)
		F.Data.DataTable.FillFromDictionary("dtInvCheck","dicJobCom","PMAST","QTY_COMMITTED_WO")
		F.Data.Dictionary.Close("dicJobCom")
		
		F.Intrinsic.String.Build("SELECT A.PART+A.LOCATION AS PMAST,SUM(QTY_BO) AS QTY_COMMITTED FROM V_ORDER_LINES A JOIN V_INVENTORY_MSTR B ON A.PART = B.PART AND A.LOCATION = B.LOCATION WHERE DATEADD(DAY,-TIME_MATERIAL_LEAD,A.DATE_ITEM_PROM) <= '{0}' GROUP BY PMAST;",V.Local.dCutoff.PervasiveDate,V.Local.sSQL)
		F.Data.Dictionary.CreateFromSQL("dicSOCom","con",V.Local.sSQL)
		F.Data.Dictionary.SetDefaultReturn("dicSOCom",0.0000)
		F.Data.DataTable.FillFromDictionary("dtInvCheck","dicSOCom","PMAST","QTY_COMMITTED_SO")
		F.Data.Dictionary.Close("dicSOCom")
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtInvCheck.RowCount--,1)
		F.Intrinsic.Math.Add(V.DataTable.dtInvCheck(V.Local.iCnt).QTY_ONHAND!FieldValFloat,V.DataTable.dtInvCheck(V.Local.iCnt).QTY_ONORDER_PO!FieldValFloat,V.Local.fSum1)
		F.Intrinsic.Math.Add(V.DataTable.dtInvCheck(V.Local.iCnt).QTY_COMMITTED_WO!FieldValFloat,V.DataTable.dtInvCheck(V.Local.iCnt).QTY_COMMITTED_SO!FieldValFloat,V.DataTable.dtInvCheck(V.Local.iCnt).QTY_REORDER!FieldValFloat,V.Local.fSum2)
		V.Local.fCurOnHand.Set(V.Local.fSum1)
		F.Intrinsic.Math.Sub(V.Local.fSum1,V.Local.fSum2,V.Local.fBalance)
		F.Data.DataTable.SetValue("dtInvCheck",V.Local.iCnt,"CurOnHand",V.Local.fCurOnHand,"BALANCE",V.Local.fBalance)
	F.Intrinsic.Control.Next(V.Local.iCnt)

	'This is the list of parts to loop through 
	F.Data.DataView.Create("dtInvCheck","dvInvCheck",22,"BALANCE < 0","PMAST ASC")

'	F.Intrinsic.Control.CallSub(LoadMRP)
	F.Intrinsic.Control.CallSub(LoadMRP2)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.InvCheck.End

Program.Sub.LoadMRP.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCnt.Declare
	V.Local.iCnt2.Declare
	V.Local.iNext.Declare
	V.Local.sFilter.Declare
	V.Local.fCurOnHand.Declare
	V.Local.fQty.Declare
	V.Local.fNextQty.Declare
	V.Local.fDiff.Declare
	V.Local.fDiff2.Declare
	V.Local.sPurchase.Declare
	V.Local.fPurchase.Declare
	V.Local.fDecimal.Declare
	V.Local.fPostOnHand.Declare
	V.Local.fOrderQty.Declare
	V.Local.fOnHandQty.Declare
	V.Local.fReqdQty.Declare
	V.Local.fOnOrder.Declare
	V.Local.fReOrderQty.Declare
	V.Local.sPartDesc.Declare
	V.Local.fLeadTime.Declare
	V.Local.sPart.Declare
	V.Local.sLoc.Declare
	V.Local.sPL.Declare
	V.Local.sSortCode.Declare
	V.Local.sUM.Declare
	V.Local.sUMPurch.Declare
	V.Local.fConversion.Declare
	V.Local.dDateDue.Declare
	V.Local.sVendor.Declare
	V.Local.sSign.Declare
	V.Local.sSQL.Declare
	V.Local.dCutoff.Declare

	F.Intrinsic.Control.If(V.DataTable.dtJobs.Exists)
		F.Data.DataTable.Close("dtJobs")
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.DataTable.dtMRP.Exists)
		F.Data.DataTable.Close("dtMRP")
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.Screen.frmPO!chkCutoff.Value,=,0)
		F.Data.DataTable.CreateFromSQL("dtJobs","con","SELECT PART,LOCATION,'Work Order' AS SOURCE,JOB,SUFFIX,SEQUENCE,QTY_COMMITTED AS QUANTITY,DATE_DUE FROM V_JOB_COMMITMENTS ORDER BY PART,DATE_DUE ASC;",True)
	F.Intrinsic.Control.Else
		V.Local.dCutoff.Set(V.Screen.frmPO!dtpCutoff.Value)
		F.Intrinsic.String.Build("SELECT PART,LOCATION,'Work Order' AS SOURCE,JOB,SUFFIX,SEQUENCE,QTY_COMMITTED AS QUANTITY,DATE_DUE FROM V_JOB_COMMITMENTS WHERE DATE_DUE <= '{0}' ORDER BY PART,DATE_DUE ASC;",V.Local.dCutoff.PervasiveDate,V.Local.sSQL)
		F.Data.DataTable.CreateFromSQL("dtJobs","con",V.Local.sSQL,True)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.DataView.dtInvCheck!dvInvCheck.RowCount,=,0)
		Gui.frmPO.lblStatus.Visible(False)
		Gui.frmPO.progBarStatus.Visible(False)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
	
	Gui.frmPO.progBarStatus.Min(0)
	F.Intrinsic.Control.If(V.DataView.dtInvCheck!dvInvCheck.RowCount,<>,0)
		Gui.frmPO.progBarStatus.Max(V.DataView.dtInvCheck!dvInvCheck.RowCount)
	F.Intrinsic.Control.Else
		Gui.frmPO.progBarStatus.Max(100)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataView.dtInvCheck!dvInvCheck.RowCount--,1)
		Gui.frmPO.progBarStatus.Value(V.Local.iCnt)
		F.Intrinsic.String.Replace(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).PART!FieldValTrim,"'","''",V.Local.sPart)
		F.Intrinsic.String.Replace(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).LOCATION!FieldValTrim,"'","''",V.Local.sLoc)

		F.Intrinsic.String.Build("PART = '{0}' AND LOCATION = '{1}'",V.Local.sPart,V.Local.sLoc,V.Local.sFilter)
		F.Data.DataView.Create("dtJobs","dvJobs",22,V.Local.sFilter,"PART ASC,LOCATION ASC,DATE_DUE ASC")
		
		V.Local.iCnt2.Set(0)
		V.Local.iNext.Set(0)
		V.Local.fQty.Set(0)
		V.Local.fNextQty.Set(0)
		V.Local.fDiff.Set(0)
		V.Local.fDiff2.Set(0)
		V.Local.fPurchase.Set(0)
		V.Local.sPurchase.Set("")
		V.Local.sSign.Set("")
		V.Local.fDecimal.Set(0)
		V.Local.fPostOnHand.Set(0)
		V.Local.fCurOnHand.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).CurOnHand!FieldValFloat)
		V.Local.sPartDesc.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).DESCRIPTION!FieldValTrim)
		V.Local.fLeadTime.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).TIME_MATERIAL_LEAD!FieldValFloat)
		V.Local.fOrderQty.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).QTY_ORDER!FieldValFloat)
		V.Local.fOnHandQty.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).QTY_ONHAND!FieldValFloat)
		V.Local.fReqdQty.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).QTY_REQUIRED!FieldValFloat)
		V.Local.fOnOrder.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).QTY_ONORDER_PO!FieldValFloat)
		V.Local.fReOrderQty.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).QTY_REORDER!FieldValFloat)
		F.Intrinsic.Date.DateAdd("D",V.Local.fLeadTime,V.Ambient.Date,V.Local.dDateDue)
		V.Local.sPL.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).PRODUCT_LINE!FieldValTrim)
		V.Local.sSortCode.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).CODE_SORT!FieldValTrim)
		V.Local.sUM.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).UM_INVENTORY!FieldValTrim)
		V.Local.sUMPurch.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).UM_PURCHASING!FieldValTrim)
		V.Local.fConversion.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).FACTOR_CONVERSION!FieldValTrim)
		V.Local.sVendor.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).NAME_VENDOR!FieldValTrim)
		
		F.Intrinsic.Control.If(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).QTY_COMMITTED!FieldValFloat,=,0,OR,V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).QTY_COMMITTED!FieldValFloat,=,V.Local.fCurOnHand)
		F.Intrinsic.Control.AndIf(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).QTY_FORE_COMMIT!FieldValFloat,=,0,OR,V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).QTY_FORE_COMMIT!FieldValFloat,=,V.Local.fCurOnHand)
			F.Intrinsic.Control.If(V.DataTable.dtMRP.Exists)
				F.Data.DataView.ToDataTable("dtJobs","dvJobs","dtMRPMerge",True)
				F.Data.DataTable.AddColumn("dtMRPMerge","CurOnHand",Float,0)
				F.Data.DataTable.AddColumn("dtMRPMerge","CurOnHand2",Float,0)
				F.Data.DataTable.AddColumn("dtMRPMerge","Purchase",Float,0)
				F.Data.DataTable.AddColumn("dtMRPMerge","PostOnHand",Float,0)
				F.Data.DataTable.AddColumn("dtMRPMerge","Description",String,"")
				F.Data.DataTable.AddColumn("dtMRPMerge","Vendor",String,"")
				F.Data.DataTable.AddColumn("dtMRPMerge","PL",String,"")
				F.Data.DataTable.AddColumn("dtMRPMerge","SortCode",String,"")
				F.Data.DataTable.AddColumn("dtMRPMerge","LeadTime",Float,0)
				F.Data.DataTable.AddColumn("dtMRPMerge","OrderQty",Float,0)
				F.Data.DataTable.AddColumn("dtMRPMerge","OnHandQty",Float,0)
				F.Data.DataTable.AddColumn("dtMRPMerge","ReqdQty",Float,0)
				F.Data.DataTable.AddExpressionColumn("dtMRPMerge","NetAvail",Float,"OrderQty-ReqdQty")
				F.Data.DataTable.AddColumn("dtMRPMerge","OnOrder",Float,0)
				F.Data.DataTable.AddColumn("dtMRPMerge","ReOrderPt",Float,0)
				F.Data.DataTable.AddColumn("dtMRPMerge","UM",String,"")
				F.Data.DataTable.AddColumn("dtMRPMerge","UMPurch",String,"")
				F.Data.DataTable.AddColumn("dtMRPMerge","Conversion",Float,0)
				F.Data.DataTable.Merge("dtMRPMerge","dtMRP",True,3)
				F.Data.DataTable.Close("dtMRPMerge")

				F.Data.DataView.Create("dtMRP","dvMRP",22,V.Local.sFilter,"DATE_DUE ASC")

				V.Local.fDiff.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).BALANCE!FieldValFloat)
				F.Intrinsic.Control.If(V.Local.fDiff,<,V.Local.fReOrderQty)
'					F.Intrinsic.Math.Sub(V.Local.fDiff,V.Local.fReOrderQty,V.Local.fDiff2)
					V.Local.fDiff2.Set(V.Local.fDiff)
					F.Intrinsic.Control.If(V.Local.fOrderQty,=,0)
						V.Local.fOrderQty.Set(1)
						V.Local.fPurchase.Set(V.Local.fReOrderQty)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Div(V.Local.fDiff2,V.Local.fOrderQty,V.Local.fPurchase)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Math.Abs(V.Local.fPurchase,V.Local.fPurchase)
					F.Intrinsic.String.Split(V.Local.fPurchase,".",V.Local.sPurchase)
					V.Local.fPurchase.Set(V.Local.sPurchase(0).Float)
					F.Intrinsic.String.Left(V.Local.sPurchase(1),2,V.Local.sPurchase)
					V.Local.fDecimal.Set(V.Local.sPurchase.Float)
					F.Intrinsic.Math.Round(V.Local.fDecimal,1,1,V.Local.fDecimal)
					F.Intrinsic.Control.If(V.Local.fDecimal,<>,0)
						F.Intrinsic.Math.Add(V.Local.fPurchase,1,V.Local.fPurchase)	
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					V.Local.fPurchase.Set(0)
				F.Intrinsic.Control.EndIf

				F.Intrinsic.Math.Mult(V.Local.fPurchase,V.Local.fOrderQty,V.Local.fPurchase)
				F.Intrinsic.Control.If(V.Local.iCnt2,=,0)
					F.Intrinsic.Math.Sub(V.Local.fPurchase,V.Local.fQty,V.Local.fPostOnHand)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fDiff,V.Local.fPurchase,V.Local.fPostOnHand)
				F.Intrinsic.Control.EndIf

				F.Data.DataTable.AddRow("dtMRP","PART",V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).PART!FieldValTrim,"LOCATION",V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).LOCATION!FieldValTrim,"SOURCE","Reorder Point","JOB","N/A","SUFFIX","N/A","SEQUENCE","N/A","QUANTITY",0,"DATE_DUE",V.Local.dDateDue,"CurOnHand",V.Local.fCurOnHand,"Purchase",V.Local.fPurchase,"PostOnHand",V.Local.fPostOnHand,"Description",V.Local.sPartDesc,"PL",V.Local.sPL,"SortCode",V.Local.sSortCode,"LeadTime",V.Local.fLeadTime,"CurOnHand2",V.Local.fCurOnHand,"OrderQty",V.Local.fOrderQty,"OnHandQty",V.Local.fOnHandQty,"ReqdQty",V.Local.fReqdQty,"OnOrder",V.Local.fOnOrder,"ReOrderPt",V.Local.fReOrderQty,"UM",V.Local.sUM,"UMPurch",V.Local.sUMPurch,"Conversion",V.Local.fConversion,"Vendor",V.Local.sVendor)
			F.Intrinsic.Control.Else
				F.Data.DataView.ToDataTable("dtJobs","dvJobs","dtMRP",True)
				F.Data.DataTable.AddColumn("dtMRP","CurOnHand",Float,0)
				F.Data.DataTable.AddColumn("dtMRP","CurOnHand2",Float,0)
				F.Data.DataTable.AddColumn("dtMRP","Purchase",Float,0)
				F.Data.DataTable.AddColumn("dtMRP","PostOnHand",Float,0)
				F.Data.DataTable.AddColumn("dtMRP","Description",String,"")
				F.Data.DataTable.AddColumn("dtMRP","Vendor",String,"")
				F.Data.DataTable.AddColumn("dtMRP","PL",String,"")
				F.Data.DataTable.AddColumn("dtMRP","SortCode",String,"")
				F.Data.DataTable.AddColumn("dtMRP","LeadTime",Float,0)
				F.Data.DataTable.AddColumn("dtMRP","OrderQty",Float,0)
				F.Data.DataTable.AddColumn("dtMRP","OnHandQty",Float,0)
				F.Data.DataTable.AddColumn("dtMRP","ReqdQty",Float,0)
				F.Data.DataTable.AddExpressionColumn("dtMRP","NetAvail",Float,"OrderQty-ReqdQty")
				F.Data.DataTable.AddColumn("dtMRP","OnOrder",Float,0)
				F.Data.DataTable.AddColumn("dtMRP","ReOrderPt",Float,0)
				F.Data.DataTable.AddColumn("dtMRP","UM",String,"")
				F.Data.DataTable.AddColumn("dtMRP","UMPurch",String,"")
				F.Data.DataTable.AddColumn("dtMRP","Conversion",Float,0)

				F.Data.DataView.Create("dtMRP","dvMRP",22,"","DATE_DUE ASC")

				V.Local.fDiff.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).BALANCE!FieldValFloat)
				F.Intrinsic.Control.If(V.Local.fDiff,<,V.Local.fReOrderQty)
'					F.Intrinsic.Math.Sub(V.Local.fDiff,V.Local.fReOrderQty,V.Local.fDiff2)
					V.Local.fDiff2.Set(V.Local.fDiff)
					F.Intrinsic.Control.If(V.Local.fOrderQty,=,0)
						V.Local.fOrderQty.Set(1)
						V.Local.fPurchase.Set(V.Local.fReOrderQty)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Div(V.Local.fDiff2,V.Local.fOrderQty,V.Local.fPurchase)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Math.Abs(V.Local.fPurchase,V.Local.fPurchase)
					F.Intrinsic.String.Split(V.Local.fPurchase,".",V.Local.sPurchase)
					V.Local.fPurchase.Set(V.Local.sPurchase(0).Float)
					F.Intrinsic.String.Left(V.Local.sPurchase(1),2,V.Local.sPurchase)
					V.Local.fDecimal.Set(V.Local.sPurchase.Float)
					F.Intrinsic.Math.Round(V.Local.fDecimal,1,1,V.Local.fDecimal)
					F.Intrinsic.Control.If(V.Local.fDecimal,<>,0)
						F.Intrinsic.Math.Add(V.Local.fPurchase,1,V.Local.fPurchase)	
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					V.Local.fPurchase.Set(0)
				F.Intrinsic.Control.EndIf

				F.Intrinsic.Math.Mult(V.Local.fPurchase,V.Local.fOrderQty,V.Local.fPurchase)
				F.Intrinsic.Control.If(V.Local.iCnt2,=,0)
					F.Intrinsic.Math.Sub(V.Local.fPurchase,V.Local.fQty,V.Local.fPostOnHand)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fDiff,V.Local.fPurchase,V.Local.fPostOnHand)
				F.Intrinsic.Control.EndIf

				F.Data.DataTable.AddRow("dtMRP","PART",V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).PART!FieldValTrim,"LOCATION",V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).LOCATION!FieldValTrim,"SOURCE","Reorder Point","JOB","N/A","SUFFIX","N/A","SEQUENCE","N/A","QUANTITY",0,"DATE_DUE",V.Local.dDateDue,"CurOnHand",V.Local.fCurOnHand,"Purchase",V.Local.fPurchase,"PostOnHand",V.Local.fPostOnHand,"Description",V.Local.sPartDesc,"PL",V.Local.sPL,"SortCode",V.Local.sSortCode,"LeadTime",V.Local.fLeadTime,"CurOnHand2",V.Local.fCurOnHand,"OrderQty",V.Local.fOrderQty,"OnHandQty",V.Local.fOnHandQty,"ReqdQty",V.Local.fReqdQty,"OnOrder",V.Local.fOnOrder,"ReOrderPt",V.Local.fReOrderQty,"UM",V.Local.sUM,"UMPurch",V.Local.sUMPurch,"Conversion",V.Local.fConversion,"Vendor",V.Local.sVendor)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.DataTable.dtMRP.Exists)
				F.Data.DataView.ToDataTable("dtJobs","dvJobs","dtMRPMerge",True)
				F.Data.DataTable.AddColumn("dtMRPMerge","CurOnHand",Float,0)
				F.Data.DataTable.AddColumn("dtMRPMerge","CurOnHand2",Float,0)
				F.Data.DataTable.AddColumn("dtMRPMerge","Purchase",Float,0)
				F.Data.DataTable.AddColumn("dtMRPMerge","PostOnHand",Float,0)
				F.Data.DataTable.AddColumn("dtMRPMerge","Description",String,"")
				F.Data.DataTable.AddColumn("dtMRPMerge","Vendor",String,"")
				F.Data.DataTable.AddColumn("dtMRPMerge","PL",String,"")
				F.Data.DataTable.AddColumn("dtMRPMerge","SortCode",String,"")
				F.Data.DataTable.AddColumn("dtMRPMerge","LeadTime",Float,0)
				F.Data.DataTable.AddColumn("dtMRPMerge","OrderQty",Float,0)
				F.Data.DataTable.AddColumn("dtMRPMerge","OnHandQty",Float,0)
				F.Data.DataTable.AddColumn("dtMRPMerge","ReqdQty",Float,0)
				F.Data.DataTable.AddExpressionColumn("dtMRPMerge","NetAvail",Float,"OrderQty-ReqdQty")
				F.Data.DataTable.AddColumn("dtMRPMerge","OnOrder",Float,0)
				F.Data.DataTable.AddColumn("dtMRPMerge","ReOrderPt",Float,0)
				F.Data.DataTable.AddColumn("dtMRPMerge","UM",String,"")
				F.Data.DataTable.AddColumn("dtMRPMerge","UMPurch",String,"")
				F.Data.DataTable.AddColumn("dtMRPMerge","Conversion",Float,0)
				F.Data.DataTable.Merge("dtMRPMerge","dtMRP",True,3)
				F.Data.DataTable.Close("dtMRPMerge")

				F.Data.DataView.Create("dtMRP","dvMRP",22,V.Local.sFilter,"DATE_DUE ASC")

				V.Local.iCnt2.Set(0)
				F.Intrinsic.Control.For(V.Local.iCnt2,0,V.DataView.dtMRP!dvMRP.RowCount--,1)
					F.Intrinsic.Math.Add(V.Local.iCnt2,1,V.Local.iNext)
					V.Local.fQty.Set(V.DataView.dtMRP!dvMRP(V.Local.iCnt2).QUANTITY!FieldValFloat)
					F.Intrinsic.Control.If(V.Local.iCnt2,=,0)
						F.Intrinsic.Math.Sub(V.Local.fCurOnHand,V.Local.fQty,V.Local.fDiff)
						F.Intrinsic.Math.Sgn(V.Local.fDiff,V.Local.sSign)
						F.Intrinsic.Math.Add(V.Local.iCnt2,1,V.Local.iNext)
						V.Local.fQty.Set(V.DataView.dtMRP!dvMRP(V.Local.iCnt2).QUANTITY!FieldValFloat)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Sub(V.Local.fPostOnHand,V.Local.fQty,V.Local.fDiff)
					F.Intrinsic.Control.EndIf

				V.Local.iCnt2.Set(0)
				F.Intrinsic.Control.For(V.Local.iCnt2,0,V.DataView.dtMRP!dvMRP.RowCount--,1)
					F.Intrinsic.Math.Add(V.Local.iCnt2,1,V.Local.iNext)
					V.Local.fQty.Set(V.DataView.dtMRP!dvMRP(V.Local.iCnt2).QUANTITY!FieldValFloat)
					F.Intrinsic.Control.If(V.Local.iCnt2,=,0)
						F.Intrinsic.Math.Sub(V.Local.fCurOnHand,V.Local.fQty,V.Local.fDiff)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Sub(V.Local.fPostOnHand,V.Local.fQty,V.Local.fDiff)
					F.Intrinsic.Control.EndIf

					F.Intrinsic.Control.If(V.Local.fOrderQty,=,0)
					F.Intrinsic.Control.AndIf(V.Local.fReOrderQty,=,0)
						F.Intrinsic.Math.Sgn(V.Local.fDiff,V.Local.sSign)
						F.Intrinsic.Control.If(V.Local.sSign,=,"1")
							F.Intrinsic.Math.Sub(V.Local.fQty,V.Local.fDiff,V.Local.fPurchase)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Abs(V.Local.fDiff,V.Local.fPurchase)
						F.Intrinsic.Control.EndIf

						V.Local.fPostOnHand.Set(0.00)
						F.Data.DataView.SetValue("dtMRP","dvMRP",V.Local.iCnt2,"CurOnHand",V.Local.fDiff,"Purchase",V.Local.fPurchase,"PostOnHand",V.Local.fPostOnHand,"Description",V.Local.sPartDesc,"PL",V.Local.sPL,"SortCode",V.Local.sSortCode,"LeadTime",V.Local.fLeadTime,"CurOnHand2",V.Local.fCurOnHand,"OrderQty",V.Local.fOrderQty,"OnHandQty",V.Local.fOnHandQty,"ReqdQty",V.Local.fReqdQty,"OnOrder",V.Local.fOnOrder,"ReOrderPt",V.Local.fReOrderQty,"UM",V.Local.sUM,"UMPurch",V.Local.sUMPurch,"Conversion",V.Local.fConversion,"Vendor",V.Local.sVendor)
						F.Intrinsic.Control.Next(V.Local.iCnt2)

					F.Intrinsic.Control.Else
						F.Intrinsic.Control.If(V.Local.iCnt2,<>,V.DataView.dtMRP!dvMRP.RowCount--)
							V.Local.fNextQty.Set(V.DataView.dtMRP!dvMRP(V.Local.iNext).QUANTITY!FieldValFloat)
							F.Intrinsic.Control.If(V.Local.fDiff,<,V.Local.fNextQty)
								F.Intrinsic.Math.Sub(V.Local.fDiff,V.Local.fNextQty,V.Local.fDiff2)
								F.Intrinsic.Control.If(V.Local.fOrderQty,=,0)
									V.Local.fOrderQty.Set(1)
									V.Local.fPurchase.Set(V.Local.fReOrderQty)
								F.Intrinsic.Control.Else
									F.Intrinsic.Math.Div(V.Local.fDiff,V.Local.fOrderQty,V.Local.fPurchase)
								F.Intrinsic.Control.EndIf
								F.Intrinsic.Math.Abs(V.Local.fPurchase,V.Local.fPurchase)
								F.Intrinsic.String.Split(V.Local.fPurchase,".",V.Local.sPurchase)
								V.Local.fPurchase.Set(V.Local.sPurchase(0).Float)
								F.Intrinsic.String.Left(V.Local.sPurchase(1),2,V.Local.sPurchase)
								V.Local.fDecimal.Set(V.Local.sPurchase.Float)
								F.Intrinsic.Math.Round(V.Local.fDecimal,1,1,V.Local.fDecimal)
								F.Intrinsic.Control.If(V.Local.fDecimal,<>,0)
									F.Intrinsic.Math.Add(V.Local.fPurchase,1,V.Local.fPurchase)	
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								V.Local.fPurchase.Set(0)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Else
							F.Intrinsic.Control.If(V.Local.fDiff,<,V.Local.fReOrderQty)
'								F.Intrinsic.Math.Sub(V.Local.fDiff,V.Local.fReOrderQty,V.Local.fDiff2)
								V.Local.fDiff2.Set(V.Local.fDiff)
								F.Intrinsic.Control.If(V.Local.fOrderQty,=,0)
									V.Local.fOrderQty.Set(1)
									V.Local.fPurchase.Set(V.Local.fReOrderQty)
								F.Intrinsic.Control.Else
									F.Intrinsic.Math.Div(V.Local.fDiff2,V.Local.fOrderQty,V.Local.fPurchase)
								F.Intrinsic.Control.EndIf
								F.Intrinsic.Math.Abs(V.Local.fPurchase,V.Local.fPurchase)
								F.Intrinsic.String.Split(V.Local.fPurchase,".",V.Local.sPurchase)
								V.Local.fPurchase.Set(V.Local.sPurchase(0).Float)
								F.Intrinsic.String.Left(V.Local.sPurchase(1),2,V.Local.sPurchase)
								F.Intrinsic.Math.Round(V.Local.fDecimal,1,1,V.Local.fDecimal)
								V.Local.fDecimal.Set(V.Local.sPurchase.Float)
								F.Intrinsic.Control.If(V.Local.fDecimal,<>,0)
									F.Intrinsic.Math.Add(V.Local.fPurchase,1,V.Local.fPurchase)	
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								V.Local.fPurchase.Set(0)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf

						F.Intrinsic.Math.Mult(V.Local.fPurchase,V.Local.fOrderQty,V.Local.fPurchase)
						F.Intrinsic.Control.If(V.Local.iCnt2,=,0)
							F.Intrinsic.Math.Sub(V.Local.fPurchase,V.Local.fQty,V.Local.fPostOnHand)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Add(V.Local.fDiff,V.Local.fPurchase,V.Local.fPostOnHand)
						F.Intrinsic.Control.EndIf

						F.Data.DataView.SetValue("dtMRP","dvMRP",V.Local.iCnt2,"CurOnHand",V.Local.fDiff,"Purchase",V.Local.fPurchase,"PostOnHand",V.Local.fPostOnHand,"Description",V.Local.sPartDesc,"PL",V.Local.sPL,"SortCode",V.Local.sSortCode,"LeadTime",V.Local.fLeadTime,"CurOnHand2",V.Local.fCurOnHand,"OrderQty",V.Local.fOrderQty,"OnHandQty",V.Local.fOnHandQty,"ReqdQty",V.Local.fReqdQty,"OnOrder",V.Local.fOnOrder,"ReOrderPt",V.Local.fReOrderQty,"UM",V.Local.sUM,"UMPurch",V.Local.sUMPurch,"Conversion",V.Local.fConversion,"Vendor",V.Local.sVendor)
						F.Intrinsic.Control.Next(V.Local.iCnt2)
					F.Intrinsic.Control.EndIf

			F.Intrinsic.Control.Else
				F.Data.DataView.ToDataTable("dtJobs","dvJobs","dtMRP",True)
				F.Data.DataTable.AddColumn("dtMRP","CurOnHand",Float,0)
				F.Data.DataTable.AddColumn("dtMRP","CurOnHand2",Float,0)
				F.Data.DataTable.AddColumn("dtMRP","Purchase",Float,0)
				F.Data.DataTable.AddColumn("dtMRP","PostOnHand",Float,0)
				F.Data.DataTable.AddColumn("dtMRP","Description",String,"")
				F.Data.DataTable.AddColumn("dtMRP","Vendor",String,"")
				F.Data.DataTable.AddColumn("dtMRP","PL",String,"")
				F.Data.DataTable.AddColumn("dtMRP","SortCode",String,"")
				F.Data.DataTable.AddColumn("dtMRP","LeadTime",Float,0)
				F.Data.DataTable.AddColumn("dtMRP","OrderQty",Float,0)
				F.Data.DataTable.AddColumn("dtMRP","OnHandQty",Float,0)
				F.Data.DataTable.AddColumn("dtMRP","ReqdQty",Float,0)
				F.Data.DataTable.AddExpressionColumn("dtMRP","NetAvail",Float,"OrderQty-ReqdQty")
				F.Data.DataTable.AddColumn("dtMRP","OnOrder",Float,0)
				F.Data.DataTable.AddColumn("dtMRP","ReOrderPt",Float,0)
				F.Data.DataTable.AddColumn("dtMRP","UM",String,"")
				F.Data.DataTable.AddColumn("dtMRP","UMPurch",String,"")
				F.Data.DataTable.AddColumn("dtMRP","Conversion",Float,0)

				F.Data.DataView.Create("dtMRP","dvMRP",22,"","DATE_DUE ASC")

				V.Local.iCnt2.Set(0)
				F.Intrinsic.Control.For(V.Local.iCnt2,0,V.DataView.dtMRP!dvMRP.RowCount--,1)
					F.Intrinsic.Math.Add(V.Local.iCnt2,1,V.Local.iNext)
					V.Local.fQty.Set(V.DataView.dtMRP!dvMRP(V.Local.iCnt2).QUANTITY!FieldValFloat)
					F.Intrinsic.Control.If(V.Local.iCnt2,=,0)
						F.Intrinsic.Math.Sub(V.Local.fCurOnHand,V.Local.fQty,V.Local.fDiff)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Sub(V.Local.fPostOnHand,V.Local.fQty,V.Local.fDiff)
					F.Intrinsic.Control.EndIf

					F.Intrinsic.Control.If(V.Local.fOrderQty,=,0)
						F.Intrinsic.Control.AndIf(V.Local.fReOrderQty,=,0)
						F.Intrinsic.Math.Sgn(V.Local.fDiff,V.Local.sSign)
						F.Intrinsic.Control.If(V.Local.sSign,=,"1")
							F.Intrinsic.Math.Sub(V.Local.fQty,V.Local.fDiff,V.Local.fPurchase)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Abs(V.Local.fDiff,V.Local.fPurchase)
						F.Intrinsic.Control.EndIf

						V.Local.fPostOnHand.Set(0.00)
						F.Data.DataView.SetValue("dtMRP","dvMRP",V.Local.iCnt2,"CurOnHand",V.Local.fDiff,"Purchase",V.Local.fPurchase,"PostOnHand",V.Local.fPostOnHand,"Description",V.Local.sPartDesc,"PL",V.Local.sPL,"SortCode",V.Local.sSortCode,"LeadTime",V.Local.fLeadTime,"CurOnHand2",V.Local.fCurOnHand,"OrderQty",V.Local.fOrderQty,"OnHandQty",V.Local.fOnHandQty,"ReqdQty",V.Local.fReqdQty,"OnOrder",V.Local.fOnOrder,"ReOrderPt",V.Local.fReOrderQty,"UM",V.Local.sUM,"UMPurch",V.Local.sUMPurch,"Conversion",V.Local.fConversion,"Vendor",V.Local.sVendor)
						F.Intrinsic.Control.Next(V.Local.iCnt2)
					F.Intrinsic.Control.Else
						F.Intrinsic.Control.If(V.Local.iCnt2,<>,V.DataView.dtMRP!dvMRP.RowCount--)
							V.Local.fNextQty.Set(V.DataView.dtMRP!dvMRP(V.Local.iNext).QUANTITY!FieldValFloat)
							F.Intrinsic.Control.If(V.Local.fDiff,<,V.Local.fNextQty)
								F.Intrinsic.Math.Sub(V.Local.fDiff,V.Local.fNextQty,V.Local.fDiff2)
								F.Intrinsic.Control.If(V.Local.fOrderQty,=,0)
									V.Local.fOrderQty.Set(1)
									V.Local.fPurchase.Set(V.Local.fReOrderQty)
								F.Intrinsic.Control.Else
									F.Intrinsic.Math.Div(V.Local.fDiff2,V.Local.fOrderQty,V.Local.fPurchase)
								F.Intrinsic.Control.EndIf
								F.Intrinsic.Math.Abs(V.Local.fPurchase,V.Local.fPurchase)
								F.Intrinsic.String.Split(V.Local.fPurchase,".",V.Local.sPurchase)
								V.Local.fPurchase.Set(V.Local.sPurchase(0).Float)
								F.Intrinsic.String.Left(V.Local.sPurchase(1),2,V.Local.sPurchase)
								V.Local.fDecimal.Set(V.Local.sPurchase.Float)
								F.Intrinsic.Math.Round(V.Local.fDecimal,1,1,V.Local.fDecimal)
								F.Intrinsic.Control.If(V.Local.fDecimal,<>,0)
									F.Intrinsic.Math.Add(V.Local.fPurchase,1,V.Local.fPurchase)	
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								V.Local.fPurchase.Set(0)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Else
							F.Intrinsic.Control.If(V.Local.fDiff,<,V.Local.fReOrderQty)
'								F.Intrinsic.Math.Sub(V.Local.fDiff,V.Local.fReOrderQty,V.Local.fDiff2)
								V.Local.fDiff2.Set(V.Local.fDiff)
								F.Intrinsic.Control.If(V.Local.fOrderQty,=,0)
									V.Local.fOrderQty.Set(1)
									V.Local.fPurchase.Set(V.Local.fReOrderQty)
								F.Intrinsic.Control.Else
									F.Intrinsic.Math.Div(V.Local.fDiff2,V.Local.fOrderQty,V.Local.fPurchase)
								F.Intrinsic.Control.EndIf
								F.Intrinsic.Math.Abs(V.Local.fPurchase,V.Local.fPurchase)
								F.Intrinsic.String.Split(V.Local.fPurchase,".",V.Local.sPurchase)
								V.Local.fPurchase.Set(V.Local.sPurchase(0).Float)
								F.Intrinsic.String.Left(V.Local.sPurchase(1),2,V.Local.sPurchase)
								F.Intrinsic.Math.Round(V.Local.fDecimal,1,1,V.Local.fDecimal)
								V.Local.fDecimal.Set(V.Local.sPurchase.Float)
								F.Intrinsic.Control.If(V.Local.fDecimal,<>,0)
									F.Intrinsic.Math.Add(V.Local.fPurchase,1,V.Local.fPurchase)	
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								V.Local.fPurchase.Set(0)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf

						F.Intrinsic.Math.Mult(V.Local.fPurchase,V.Local.fOrderQty,V.Local.fPurchase)
						F.Intrinsic.Control.If(V.Local.iCnt2,=,0)
							F.Intrinsic.Math.Sub(V.Local.fPurchase,V.Local.fQty,V.Local.fPostOnHand)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Add(V.Local.fDiff,V.Local.fPurchase,V.Local.fPostOnHand)
						F.Intrinsic.Control.EndIf

						F.Data.DataView.SetValue("dtMRP","dvMRP",V.Local.iCnt2,"CurOnHand",V.Local.fDiff,"Purchase",V.Local.fPurchase,"PostOnHand",V.Local.fPostOnHand,"Description",V.Local.sPartDesc,"PL",V.Local.sPL,"SortCode",V.Local.sSortCode,"LeadTime",V.Local.fLeadTime,"CurOnHand2",V.Local.fCurOnHand,"OrderQty",V.Local.fOrderQty,"OnHandQty",V.Local.fOnHandQty,"ReqdQty",V.Local.fReqdQty,"OnOrder",V.Local.fOnOrder,"ReOrderPt",V.Local.fReOrderQty,"UM",V.Local.sUM,"UMPurch",V.Local.sUMPurch,"Conversion",V.Local.fConversion,"Vendor",V.Local.sVendor)
						F.Intrinsic.Control.Next(V.Local.iCnt2)
					F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Data.DataView.Close("dtMRP","dvMRP")
		F.Data.DataView.Close("dtJobs","dvJobs")
	F.Intrinsic.Control.Next(V.Local.iCnt)
	F.Intrinsic.Control.CallSub(LoadPOs)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadMRP.End

Program.Sub.LoadMRP2.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCnt.Declare
	V.Local.iCnt2.Declare
	V.Local.iNext.Declare
	V.Local.sFilter.Declare
	V.Local.fCurOnHand.Declare
	V.Local.fQty.Declare
	V.Local.fNextQty.Declare
	V.Local.fDiff.Declare
	V.Local.fDiff2.Declare
	V.Local.sPurchase.Declare
	V.Local.fPurchase.Declare
	V.Local.fDecimal.Declare
	V.Local.fPostOnHand.Declare
	V.Local.fOrderQty.Declare
	V.Local.fOnHandQty.Declare
	V.Local.fReqdQty.Declare
	V.Local.fOnOrder.Declare
	V.Local.fReOrderQty.Declare
	V.Local.sPartDesc.Declare
	V.Local.fLeadTime.Declare
	V.Local.sPart.Declare
	V.Local.sLoc.Declare
	V.Local.sPL.Declare
	V.Local.sSortCode.Declare
	V.Local.sUM.Declare
	V.Local.sUMPurch.Declare
	V.Local.fConversion.Declare
	V.Local.dDateDue.Declare
	V.Local.sVendor.Declare
	V.Local.sSign.Declare
	V.Local.sSQL.Declare
	V.Local.dCutoff.Declare
	V.Local.fCommit.Declare
	v.Local.fOnHandSum.Declare
	V.Local.dDateDuePO.Declare
	V.Local.sSelect.Declare
	V.Local.sROPParts.Declare

	F.Intrinsic.Control.If(V.DataTable.dtJobs.Exists)
		F.Data.DataTable.Close("dtJobs")
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.DataTable.dtMRP.Exists)
		F.Data.DataTable.Close("dtMRP")
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.Screen.frmPO!chkCutoff.Value,=,0)
		F.Data.DataTable.CreateFromSQL("dtJobs","con","SELECT PART,LOCATION,'Work Order' AS SOURCE,JOB,SUFFIX,SEQUENCE,QTY_COMMITTED-QTY_ISSUED AS QUANTITY,DATE_DUE FROM V_JOB_COMMITMENTS UNION SELECT PART,LOCATION,'Sales Order' AS SOURCE,ORDER_NO AS JOB,LEFT(RECORD_NO,3) AS SUFFIX,'' AS SEQ,QTY_BO AS QUANTITY,DATE_ITEM_PROM AS DATE_DUE FROM V_ORDER_LINES ORDER BY PART,DATE_DUE ASC;",True)
	F.Intrinsic.Control.Else
		V.Local.dCutoff.Set(V.Screen.frmPO!dtpCutoff.Value)
		F.Intrinsic.String.Build("SELECT A.PART,A.LOCATION,'Work Order' AS SOURCE,JOB,SUFFIX,SEQUENCE,QTY_COMMITTED-QTY_ISSUED AS QUANTITY,DATE_DUE FROM V_JOB_COMMITMENTS A JOIN V_INVENTORY_MSTR B ON A.PART = B.PART AND A.LOCATION = B.LOCATION WHERE DATEADD(DAY,-TIME_MATERIAL_LEAD,A.DATE_DUE) <= '{0}' UNION SELECT A.PART,A.LOCATION,'Sales Order' AS SOURCE,ORDER_NO AS JOB,LEFT(RECORD_NO,3) AS SUFFIX,'' AS SEQ,QTY_BO AS QUANTITY,DATE_ITEM_PROM AS DATE_DUE FROM V_ORDER_LINES A JOIN V_INVENTORY_MSTR B ON A.PART = B.PART AND A.LOCATION = B.LOCATION WHERE DATEADD(DAY,-TIME_MATERIAL_LEAD,A.DATE_ITEM_PROM) <= '{0}' ORDER BY PART,DATE_DUE ASC;",V.Local.dCutoff.PervasiveDate,V.Local.sSQL)
		F.Data.DataTable.CreateFromSQL("dtJobs","con",V.Local.sSQL,True)
	F.Intrinsic.Control.EndIf
	
	'Add in Reorder Point Parts
	F.Data.DataTable.Select("dtInvCheck","BALANCE < 0 AND QTY_REQUIRED = 0",V.Local.sSelect)
	F.Intrinsic.Control.If(V.Local.sSelect.IsNotNoReturn)
		F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSelect.UBound,1)
			F.Intrinsic.String.Replace(V.DataTable.dtInvCheck(V.Local.sSelect(V.Local.iCnt)).PMAST!FieldVal,"'","''",V.Local.sPart)
			F.Intrinsic.Control.If(V.Local.iCnt,=,0)
				F.Intrinsic.String.Build("'{0}'",v.Local.sPart,V.Local.sROPParts)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("{0},'{1}'",V.Local.sROPParts,V.Local.sPart,V.Local.sROPParts)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.iCnt)
		F.Intrinsic.String.Build("SELECT PART,LOCATION,'Reorder Point' AS SOURCE,'' AS JOB,'' AS SUFFIX,'' AS SEQUENCE,QTY_REORDER-QTY_ONHAND AS QUANTITY,CURDATE() AS DATE_DUE FROM V_INVENTORY_MSTR WHERE PART+LOCATION IN ({0});",V.Local.sROPParts,V.Local.sSQL)
		F.Data.DataTable.CreateFromSQL("dtROPParts","con",V.Local.sSQL,True)
		F.Data.DataTable.Merge("dtROPParts","dtJobs",True,3)
		F.Data.DataTable.Close("dtROPParts")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.DataView.dtInvCheck!dvInvCheck.RowCount,=,0)
		Gui.frmPO.lblStatus.Visible(False)
		Gui.frmPO.progBarStatus.Visible(False)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
	
	Gui.frmPO.progBarStatus.Min(0)
	F.Intrinsic.Control.If(V.DataView.dtInvCheck!dvInvCheck.RowCount,<>,0)
		Gui.frmPO.progBarStatus.Max(V.DataView.dtInvCheck!dvInvCheck.RowCount)
	F.Intrinsic.Control.Else
		Gui.frmPO.progBarStatus.Max(100)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataView.dtInvCheck!dvInvCheck.RowCount--,1)
		Gui.frmPO.progBarStatus.Value(V.Local.iCnt)
		F.Intrinsic.String.Replace(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).PART!FieldValTrim,"'","''",V.Local.sPart)
		F.Intrinsic.String.Replace(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).LOCATION!FieldValTrim,"'","''",V.Local.sLoc)
		F.Intrinsic.String.Build("PART = '{0}' AND LOCATION = '{1}'",V.Local.sPart,V.Local.sLoc,V.Local.sFilter)
		F.Data.DataView.Create("dtJobs","dvJobs",22,V.Local.sFilter,"PART ASC,LOCATION ASC,DATE_DUE ASC")
		
		V.Local.iCnt2.Set(0)
		V.Local.iNext.Set(0)
		V.Local.fQty.Set(0)
		V.Local.fNextQty.Set(0)
		V.Local.fDiff.Set(0)
		V.Local.fDiff2.Set(0)
		V.Local.fPurchase.Set(0)
		V.Local.sPurchase.Set("")
		V.Local.sSign.Set("")
		V.Local.fDecimal.Set(0)
		V.Local.fPostOnHand.Set(0)
		V.Local.fCurOnHand.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).CurOnHand!FieldValFloat)
		V.Local.sPartDesc.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).DESCRIPTION!FieldValTrim)
		V.Local.fLeadTime.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).TIME_MATERIAL_LEAD!FieldValFloat)
		V.Local.fOrderQty.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).QTY_ORDER!FieldValFloat)
		V.Local.fOnHandQty.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).QTY_ONHAND!FieldValFloat)
		V.Local.fReqdQty.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).QTY_REQUIRED!FieldValFloat)
		V.Local.fOnOrder.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).QTY_ONORDER_PO!FieldValFloat)
		V.Local.fReOrderQty.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).QTY_REORDER!FieldValFloat)
		F.Intrinsic.Date.DateAdd("D",V.Local.fLeadTime,V.Ambient.Date,V.Local.dDateDue)
		V.Local.sPL.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).PRODUCT_LINE!FieldValTrim)
		V.Local.sSortCode.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).CODE_SORT!FieldValTrim)
		V.Local.sUM.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).UM_INVENTORY!FieldValTrim)
		V.Local.sUMPurch.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).UM_PURCHASING!FieldValTrim)
		V.Local.fConversion.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).FACTOR_CONVERSION!FieldValTrim)
		V.Local.sVendor.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).NAME_VENDOR!FieldValTrim)
		F.Intrinsic.Math.Add(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).QTY_COMMITTED_WO!FieldValFloat,V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).QTY_COMMITTED_SO!FieldValFloat,V.Local.fCommit)
		F.Intrinsic.Math.Add(V.Local.fOnHandQty,V.Local.fOnOrder,V.Local.fOnHandSum)
		
		F.Intrinsic.Control.If(V.DataTable.dtMRP.Exists,=,False)
			F.Data.DataView.ToDataTable("dtJobs","dvJobs","dtMRP",True)
			F.Data.DataTable.AddColumn("dtMRP","CurOnHand",Float,0)
			F.Data.DataTable.AddColumn("dtMRP","CurOnHand2",Float,0)
			F.Data.DataTable.AddColumn("dtMRP","Purchase",Float,0)
			F.Data.DataTable.AddColumn("dtMRP","PostOnHand",Float,0)
			F.Data.DataTable.AddColumn("dtMRP","Description",String,"")
			F.Data.DataTable.AddColumn("dtMRP","Vendor",String,"")
			F.Data.DataTable.AddColumn("dtMRP","PL",String,"")
			F.Data.DataTable.AddColumn("dtMRP","SortCode",String,"")
			F.Data.DataTable.AddColumn("dtMRP","LeadTime",Float,0)
			F.Data.DataTable.AddColumn("dtMRP","OrderQty",Float,0)
			F.Data.DataTable.AddColumn("dtMRP","OnHandQty",Float,0)
			F.Data.DataTable.AddColumn("dtMRP","ReqdQty",Float,0)
			F.Data.DataTable.AddColumn("dtMRP","OnOrder",Float,0)
			F.Data.DataTable.AddColumn("dtMRP","ReOrderPt",Float,0)
			F.Data.DataTable.AddColumn("dtMRP","UM",String,"")
			F.Data.DataTable.AddColumn("dtMRP","UMPurch",String,"")
			F.Data.DataTable.AddColumn("dtMRP","Conversion",Float,0)
		F.Intrinsic.Control.Else
			F.Data.DataView.ToDataTable("dtJobs","dvJobs","dtMRPMerge",True)
			F.Data.DataTable.AddColumn("dtMRPMerge","CurOnHand",Float,0)
			F.Data.DataTable.AddColumn("dtMRPMerge","CurOnHand2",Float,0)
			F.Data.DataTable.AddColumn("dtMRPMerge","Purchase",Float,0)
			F.Data.DataTable.AddColumn("dtMRPMerge","PostOnHand",Float,0)
			F.Data.DataTable.AddColumn("dtMRPMerge","Description",String,"")
			F.Data.DataTable.AddColumn("dtMRPMerge","Vendor",String,"")
			F.Data.DataTable.AddColumn("dtMRPMerge","PL",String,"")
			F.Data.DataTable.AddColumn("dtMRPMerge","SortCode",String,"")
			F.Data.DataTable.AddColumn("dtMRPMerge","LeadTime",Float,0)
			F.Data.DataTable.AddColumn("dtMRPMerge","OrderQty",Float,0)
			F.Data.DataTable.AddColumn("dtMRPMerge","OnHandQty",Float,0)
			F.Data.DataTable.AddColumn("dtMRPMerge","ReqdQty",Float,0)
			F.Data.DataTable.AddColumn("dtMRPMerge","OnOrder",Float,0)
			F.Data.DataTable.AddColumn("dtMRPMerge","ReOrderPt",Float,0)
			F.Data.DataTable.AddColumn("dtMRPMerge","UM",String,"")
			F.Data.DataTable.AddColumn("dtMRPMerge","UMPurch",String,"")
			F.Data.DataTable.AddColumn("dtMRPMerge","Conversion",Float,0)
			F.Data.DataTable.Merge("dtMRPMerge","dtMRP",True,3)
			F.Data.DataTable.Close("dtMRPMerge")
		F.Intrinsic.Control.EndIf
		'Create MRP DataView
		F.Data.DataView.Create("dtMRP","dvMRP",22,V.Local.sFilter,"DATE_DUE ASC,JOB ASC,SUFFIX ASC")
		
		'Retrieve amount to purchase
		F.Intrinsic.Math.Add(V.Local.fReqdQty,V.Local.fReOrderQty,V.Local.fDiff)
'		F.Intrinsic.Math.Sub(V.Local.fDiff,V.Local.fOnHandQty,V.Local.fDiff)
		F.Intrinsic.Math.Sub(V.Local.fDiff,V.Local.fCurOnHand,V.Local.fDiff)
		F.Intrinsic.Control.If(V.Local.fOrderQty,=,0)
			V.Local.fOrderQty.Set(1)
'			V.Local.fPurchase.Set(V.Local.fReOrderQty)
			V.Local.fPurchase.Set(V.Local.fDiff)
		F.Intrinsic.Control.Else
			F.Intrinsic.Math.Div(V.Local.fDiff,V.Local.fOrderQty,V.Local.fPurchase)
		F.Intrinsic.Control.EndIf
		
		F.Intrinsic.Math.Abs(V.Local.fPurchase,V.Local.fPurchase)
		F.Intrinsic.String.Split(V.Local.fPurchase,".",V.Local.sPurchase)
		V.Local.fPurchase.Set(V.Local.sPurchase(0).Float)
		F.Intrinsic.Control.If(V.Local.sPurchase(1),<>,"OOB")
			F.Intrinsic.String.Left(V.Local.sPurchase(1),2,V.Local.sPurchase)
			V.Local.fDecimal.Set(V.Local.sPurchase.Float)
			F.Intrinsic.Control.If(V.Local.fDecimal,>,0)
				F.Intrinsic.Math.Add(V.Local.fPurchase,1,V.Local.fPurchase)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
		F.Intrinsic.Control.If(V.Local.fOrderQty,=,1)
		F.Intrinsic.Control.AndIf(V.Local.fPurchase,=,1)
			F.Intrinsic.Math.Mult(V.Local.fDiff,V.Local.fOrderQty,V.Local.fPurchase)
		F.Intrinsic.Control.Else
			F.Intrinsic.Math.Mult(V.Local.fPurchase,V.Local.fOrderQty,V.Local.fPurchase)
		F.Intrinsic.Control.EndIf
		
		V.Local.fOrderQty.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).QTY_ORDER!FieldValFloat)
		
		'MRP Part
		F.Intrinsic.Control.For(V.Local.iCnt2,0,V.DataView.dtMRP!dvMRP.RowCount--,1)
			V.Local.fQty.Set(V.DataView.dtMRP!dvMRP(V.Local.iCnt2).QUANTITY!FieldValFloat)
			V.Local.fOrderQty.Set(V.DataView.dtInvCheck!dvInvCheck(V.Local.iCnt).QTY_ORDER!FieldValFloat)
			
			F.Intrinsic.Control.If(V.Local.iCnt2,=,0)
				V.Local.fDiff.Set(V.Local.fOnHandQty)
				F.Intrinsic.Math.Sub(V.Local.fOnHandQty,V.Local.fQty,V.Local.fPostOnHand)
			F.Intrinsic.Control.Else
				V.Local.fDiff.Set(V.Local.fPostOnHand)
				F.Intrinsic.Math.Sub(V.Local.fPostOnHand,V.Local.fQty,V.Local.fPostOnHand)
			F.Intrinsic.Control.EndIf

			F.Intrinsic.Control.If(V.Local.fPostOnHand,>=,V.Local.fReOrderQty)
				F.Data.DataView.SetValue("dtMRP","dvMRP",V.Local.iCnt2,"CurOnHand",V.Local.fDiff,"Purchase",0,"PostOnHand",V.Local.fPostOnHand,"Description",V.Local.sPartDesc,"PL",V.Local.sPL,"SortCode",V.Local.sSortCode,"LeadTime",V.Local.fLeadTime,"CurOnHand2",V.Local.fCurOnHand,"OrderQty",V.Local.fOrderQty,"OnHandQty",V.Local.fOnHandQty,"ReqdQty",V.Local.fReqdQty,"OnOrder",V.Local.fOnOrder,"ReOrderPt",V.Local.fReOrderQty,"UM",V.Local.sUM,"UMPurch",V.Local.sUMPurch,"Conversion",V.Local.fConversion,"Vendor",V.Local.sVendor)
			F.Intrinsic.Control.Else
				F.Data.DataView.SetValue("dtMRP","dvMRP",V.Local.iCnt2,"CurOnHand",V.Local.fDiff,"Purchase",V.Local.fPurchase,"PostOnHand",V.Local.fPostOnHand,"Description",V.Local.sPartDesc,"PL",V.Local.sPL,"SortCode",V.Local.sSortCode,"LeadTime",V.Local.fLeadTime,"CurOnHand2",V.Local.fCurOnHand,"OrderQty",V.Local.fOrderQty,"OnHandQty",V.Local.fOnHandQty,"ReqdQty",V.Local.fReqdQty,"OnOrder",V.Local.fOnOrder,"ReOrderPt",V.Local.fReOrderQty,"UM",V.Local.sUM,"UMPurch",V.Local.sUMPurch,"Conversion",V.Local.fConversion,"Vendor",V.Local.sVendor)
				F.Intrinsic.Control.ExitFor(V.Local.iCnt2)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.iCnt2)
		
		F.Data.DataView.Close("dtMRP","dvMRP")
		F.Data.DataView.Close("dtJobs","dvJobs")
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	F.Intrinsic.Control.CallSub(LoadPOs)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadMRP2.End

Program.Sub.LoadPOs.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCnt.Declare
	V.Local.fLeadTime.Declare
	V.Local.dDateDue.Declare
	V.Local.dDatePurch.Declare
	V.Local.sDatePurch.Declare
	V.Local.fQtyPurch.Declare
	V.Local.iCnt2.Declare
	V.Local.sSelect.Declare
	V.Local.sFilter.Declare
	V.Local.sPart.Declare

	F.Intrinsic.Control.If(V.DataTable.dtPO0.Exists)
		F.Data.DataTable.Close("dtPO0")
		F.Data.DataTable.Close("dtPO")
	F.Intrinsic.Control.EndIf

	F.Data.DataView.Create("dtMRP","dvMRP",22,"Purchase <> 0","PART ASC,LOCATION ASC,DATE_DUE ASC")
	F.Data.DataView.ToDataTable("dtMRP","dvMRP","dtPO0",True)
	F.Data.DataView.Close("dtMRP","dvMRP")
	'RemoveColumns
	F.Data.DataTable.RemoveColumn("dtPO0","SOURCE")
	F.Data.DataTable.RemoveColumn("dtPO0","JOB")
	F.Data.DataTable.RemoveColumn("dtPO0","SUFFIX")
	F.Data.DataTable.RemoveColumn("dtPO0","SEQUENCE")
	F.Data.DataTable.RemoveColumn("dtPO0","QUANTITY")
	F.Data.DataTable.RemoveColumn("dtPO0","CurOnHand")
	F.Data.DataTable.RemoveColumn("dtPO0","CurOnHand2")
	F.Data.DataTable.RemoveColumn("dtPO0","PostOnHand")
	F.Data.DataTable.RemoveColumn("dtPO0","ReqdQty")
	'Add Columns
	F.Data.DataTable.AddColumn("dtPO0","PurchaseDate",Date)
	F.Data.DataTable.AddColumn("dtPO0","Select",Boolean,False)
	F.Data.DataTable.AddColumn("dtPO0","Cost",Float,0)
	'Set Purchase Date
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtPO0.RowCount--,1)
		V.Local.dDateDue.Set(V.DataTable.dtPO0(V.Local.iCnt).DATE_DUE!FieldVal)
		F.Intrinsic.Math.Mult(V.DataTable.dtPO0(V.Local.iCnt).LeadTime!FieldValFloat,-1,V.Local.fLeadTime)
		F.Intrinsic.Date.DateAdd("D",V.Local.fLeadTime,V.Local.dDateDue,V.Local.dDatePurch)
		F.Data.DataTable.SetValue("dtPO0",V.Local.iCnt,"PurchaseDate",V.Local.dDatePurch)
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	'Create a Key Column
	F.Data.DataTable.AddExpressionColumn("dtPO0","PartLoc",String,"[PART]+[LOCATION]")
	'Load Vendors
	F.Data.DataTable.FillFromDictionary("dtPO0","dVendor","PartLoc","Vendor")
	'Preferred Vendor Names
	F.Data.DataTable.AddColumn("dtPO0","VendorName",String,"")
	F.Data.DataTable.FillFromDictionary("dtPO0","dVendorName","Vendor","VendorName")
	'GL Account
	F.Data.DataTable.AddColumn("dtPO0","GLAcct",String,"")
	F.Data.DataTable.FillFromDictionary("dtPO0","dGLAcct","PL","GLAcct")
	'Status
	F.Data.DataTable.AddColumn("dtPO0","Status",Long,0)
	F.Data.DataTable.FillFromDictionary("dtPO0","dStatus","PartLoc","Status")
	'BuyerCode
	F.Data.DataTable.AddColumn("dtPO0","BuyerCode",String,"")
	F.Data.DataTable.FillFromDictionary("dtPO0","dBuyerCode","Vendor","BuyerCode")
	'BuyerName
	F.Data.DataTable.AddColumn("dtPO0","BuyerName",String,"")
	F.Data.DataTable.FillFromDictionary("dtPO0","dBuyerName","BuyerCode","BuyerName")
	'In Quality
	F.Data.DataTable.AddColumn("dtPO0","InQuality",Float,0)
	F.Data.Dictionary.CreateFromSQL("dInQual","con","Select Part+Location As PartLoc,Sum(Qty_Remaining) As Qty_Remaining From V_Quality Where Qty_Remaining <> 0 Group By Part,Location;")
	F.Data.Dictionary.SetDefaultReturn("dInQual",0.0)
	F.Data.DataTable.FillFromDictionary("dtPO0","dInQual","PartLoc","InQuality")
	F.Data.Dictionary.Close("dInQual")
	'Remove Key Column
	F.Data.DataTable.RemoveColumn("dtPO0","PartLoc")
	
	'Group Parts together
	F.Data.DataView.Create("dtPO0","dvGroup")
	F.Data.DataView.ToDataTableDistinct("dtPO0","dvGroup","dtPO","Select*!*PART*!*LOCATION*!*DESCRIPTION*!*Vendor*!*VendorName*!*PL*!*SortCode*!*BuyerCode*!*BuyerName*!*LEADTIME*!*OrderQty*!*OnHandQty*!*OnOrder*!*ReOrderPt*!*InQuality*!*UM*!*UMPurch*!*Conversion*!*Cost*!*GLAcct*!*Status",True)
	F.Data.DataTable.AddColumn("dtPO","PurchaseDate",Date)
	F.Data.DataTable.AddColumn("dtPO","DATE_DUE",Date)
	F.Data.DataTable.AddColumn("dtPO","Purchase",Float,0)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtPO.RowCount--,1)
		F.Intrinsic.String.Replace(V.DataTable.dtPO(V.Local.iCnt).Part!FieldVal,"'","''",V.Local.sPart)
		F.Intrinsic.String.Build("Part = '{0}' And Location = '{1}'",V.Local.sPart,V.DataTable.dtPO(V.Local.iCnt).Location!FieldVal,V.Local.sFilter)
		F.Data.DataTable.Select("dtPO0",V.Local.sFilter,V.Local.sSelect)
		F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
		F.Data.DataTable.Compute("dtPO0","SUM(Purchase)",V.Local.sFilter,V.Local.fQtyPurch)
		F.Data.DataTable.SetValue("dtPO",V.Local.iCnt,"PurchaseDate",V.DataTable.dtPO0(V.Local.sSelect(0).Long).PurchaseDate!FieldVal,"DATE_DUE",V.DataTable.dtPO0(V.Local.sSelect(0).Long).DATE_DUE!FieldVal,"Purchase",V.Local.fQtyPurch)
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	'Create a Key Column
	F.Data.DataTable.AddExpressionColumn("dtPO","PartLoc",String,"[PART]+[LOCATION]")
	'Last Note Column
	F.Data.DataTable.AddColumn("dtPO","LastNote",String,"")
	F.Data.Dictionary.CreateFromSQL("dLastNote","con","Select Part+Loc As PartLoc,Notes From GAB_4936_NOTES Order By Create_DT Desc;")
	F.Data.Dictionary.SetDefaultReturn("dLastNote","")
	F.Data.DataTable.FillFromDictionary("dtPO","dLastNote","PartLoc","LastNote")
	F.Data.Dictionary.Close("dLastNote")
	'Remove Key Column
	F.Data.DataTable.RemoveColumn("dtPO","PartLoc")
	
	'Req Columns
	F.Data.DataTable.AddColumn("dtPO","PO_Req_Number",String,"")
	F.Data.DataTable.AddColumn("dtPO","PO_Req_Line",String,"")
	
	F.Intrinsic.Control.CallSub(LoadGVPO)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadPOs.End

Program.Sub.LoadGVPO.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCnt.Declare
	V.Local.iNext.Declare
	V.Local.sPart.Declare
	V.Local.sLoc.Declare
	V.Local.sNextPart.Declare
	V.Local.sNextLoc.Declare
	V.Local.sColor.Declare
	V.Local.sValues.Declare

	Gui.frmPO.GsGCPO.SuspendLayout()
	Gui.frmPO.GsGCPO.AddGridViewFromDataTable("gvPO","dtPO")
	Gui.frmPO.GsGCPO.Icon(V.Global.sGsGCIcon)
	Gui.frmPO.GsGCPO.SetGridViewProperty("gvPO","MultiSelect",True)
	Gui.frmPO.GsGCPO.SetGridViewProperty("gvPO","AllowSort",True)
	Gui.frmPO.GsGCPO.SetGridViewProperty("gvPO","AllowFilter",True)
	Gui.frmPO.GsGCPO.SetGridViewProperty("gvPO","ShowGroupPanel",True)
	Gui.frmPO.GsGCPO.SetGridViewProperty("gvPO","Enableappearanceoddrow",True)
	
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Vendor","Visible",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","GLAcct","Visible",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Status","Visible",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","BuyerCode","Visible",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PO_Req_Number","Visible",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PO_Req_Line","Visible",False)
	
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Select","Fixed","Left")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PART","Fixed","Left")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LOCATION","Fixed","Left")
	
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Select","VisibleIndex","0")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PART","VisibleIndex","1")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LOCATION","VisibleIndex","2")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","DESCRIPTION","VisibleIndex","3")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","VendorName","VisibleIndex","4")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PL","VisibleIndex","5")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","SortCode","VisibleIndex","6")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","BuyerName","VisibleIndex","7")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LEADTIME","VisibleIndex","8")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","OrderQty","VisibleIndex","9")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","OnHandQty","VisibleIndex","10")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","OnOrder","VisibleIndex","11")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","ReOrderPt","VisibleIndex","12")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","InQuality","VisibleIndex","13")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","UM","VisibleIndex","14")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","UMPurch","VisibleIndex","15")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Conversion","VisibleIndex","16")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PURCHASEDATE","VisibleIndex","17")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","DATE_DUE","VisibleIndex","18")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Cost","VisibleIndex","19")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Purchase","VisibleIndex","20")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LastNote","VisibleIndex","21")

	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Select","Caption","Select")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PART","Caption","Part")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LOCATION","Caption","Loc")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","DESCRIPTION","Caption","Description")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","VendorName","Caption","Preferred Vendor")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PL","Caption","PL")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","SortCode","Caption","Sort Code")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","BuyerName","Caption","Buyer")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LEADTIME","Caption","Lead Time")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","OrderQty","Caption","Order Qty")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","OnHandQty","Caption","On Hand Qty")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","OnOrder","Caption","On Order")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","ReOrderPt","Caption","ReOrder Pt")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","InQuality","Caption","In Quality")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","UM","Caption","UM")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","UMPurch","Caption","UM Purch")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Conversion","Caption","Conversion")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PURCHASEDATE","Caption","Purch. Date")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","DATE_DUE","Caption","Due Date")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Cost","Caption","Cost")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Purchase","Caption","PO Quantity")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LastNote","Caption","Last Note")

	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Select","MinWidth","50")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PART","MinWidth","140")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LOCATION","MinWidth","40")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","DESCRIPTION","MinWidth","200")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","VendorName","MinWidth","200")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PL","MinWidth","35")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","SortCode","MinWidth","90")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","BuyerName","MinWidth","100")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LEADTIME","MinWidth","75")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","OrderQty","MinWidth","85")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","OnHandQty","MinWidth","85")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","OnOrder","MinWidth","85")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","ReOrderPt","MinWidth","85")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","InQuality","MinWidth","85")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","UM","MinWidth","55")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","UMPurch","MinWidth","70")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Conversion","MinWidth","85")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PURCHASEDATE","MinWidth","85")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","DATE_DUE","MinWidth","85")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Cost","MinWidth","85")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Purchase","MinWidth","85")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LastNote","MinWidth","115")
	
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Select","AllowEdit",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PART","AllowEdit",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LOCATION","AllowEdit",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","DESCRIPTION","AllowEdit",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Vendor","AllowEdit",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","VendorName","AllowEdit",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PL","AllowEdit",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","SortCode","AllowEdit",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","BuyerName","AllowEdit",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LEADTIME","AllowEdit",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","OrderQty","AllowEdit",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","OnHandQty","AllowEdit",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","OnOrder","AllowEdit",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","ReOrderPt","AllowEdit",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","InQuality","AllowEdit",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","UM","AllowEdit",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","UMPurch","AllowEdit",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Conversion","AllowEdit",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PURCHASEDATE","AllowEdit",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","DATE_DUE","AllowEdit",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Cost","AllowEdit",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Purchase","AllowEdit",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LastNote","AllowEdit",False)

	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Select","ReadOnly",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","DATE_DUE","ReadOnly",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Cost","ReadOnly",False)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Purchase","ReadOnly",False)

	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Select","HeaderFontBold",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PART","HeaderFontBold",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LOCATION","HeaderFontBold",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","DESCRIPTION","HeaderFontBold",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","VendorName","HeaderFontBold",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PL","HeaderFontBold",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","SortCode","HeaderFontBold",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","BuyerName","HeaderFontBold",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LEADTIME","HeaderFontBold",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","OrderQty","HeaderFontBold",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","OnHandQty","HeaderFontBold",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","OnOrder","HeaderFontBold",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","ReOrderPt","HeaderFontBold",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","InQuality","HeaderFontBold",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","UM","HeaderFontBold",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","UMPurch","HeaderFontBold",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Conversion","HeaderFontBold",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PURCHASEDATE","HeaderFontBold",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","DATE_DUE","HeaderFontBold",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Cost","HeaderFontBold",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Purchase","HeaderFontBold",True)
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LastNote","HeaderFontBold",True)
	
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Select","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PART","HeaderHAlignment","Left")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LOCATION","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","DESCRIPTION","HeaderHAlignment","Left")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","VendorName","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PL","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","SortCode","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","BuyerName","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LEADTIME","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","OrderQty","HeaderHAlignment","Far")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","OnHandQty","HeaderHAlignment","Far")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","OnOrder","HeaderHAlignment","Far")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","ReOrderPt","HeaderHAlignment","Far")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","InQuality","HeaderHAlignment","Far")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","UM","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","UMPurch","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Conversion","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PURCHASEDATE","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","DATE_DUE","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Cost","HeaderHAlignment","Far")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Purchase","HeaderHAlignment","Far")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LastNote","HeaderHAlignment","Left")
	
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Select","CellHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LOCATION","CellHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","VendorName","CellHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PL","CellHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","SortCode","CellHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","BuyerName","CellHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LEADTIME","CellHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","UM","CellHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","UMPurch","CellHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Conversion","CellHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PURCHASEDATE","CellHAlignment","Center")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","DATE_DUE","CellHAlignment","Center")
	
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PART","CellForeColor","Blue")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","LOCATION","CellForeColor","Blue")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","DESCRIPTION","CellForeColor","Blue")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","VendorName","CellForeColor","Blue")

	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","DATE_DUE","CellBackColor","LightYellow")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Cost","CellBackColor","LightYellow")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Purchase","CellBackColor","LightYellow")

	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","OrderQty","DisplayCustomNumeric","#,###,###,##0.00##")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","OnHandQty","DisplayCustomNumeric","#,###,###,##0.00##")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","OnOrder","DisplayCustomNumeric","#,###,###,##0.00##")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","ReOrderPt","DisplayCustomNumeric","#,###,###,##0.00##")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","InQuality","DisplayCustomNumeric","#,###,###,##0.00##")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Conversion","DisplayCustomNumeric","#,###,###,##0.00##")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Cost","DisplayCustomNumeric","#,###,###,##0.00##")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","Purchase","DisplayCustomNumeric","#,###,###,##0.00##")

	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","PURCHASEDATE","DisplayCustomDatetime","d")
	Gui.frmPO.GsGCPO.SetColumnProperty("gvPO","DATE_DUE","DisplayCustomDatetime","d")
	
	Gui.frmPO.GsGCPO.AddSummaryItem("gvPO","PART","PART","Count","Tot Parts: ","",n0)

	Gui.frmPO.GsGCPO.ResumeLayout()
	Gui.frmPO.GsGCPO.MainView("gvPO")
	
	Gui.frmPO.lblStatus.Visible(False)
	Gui.frmPO.progBarStatus.Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadGVPO.End

Program.Sub.InvCheckDrop.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare
	V.Local.iCnt.Declare
	V.Local.fSum1.Declare
	V.Local.fSum2.Declare
	V.Local.fCurOnHand.Declare
	V.Local.fBalance.Declare
	V.Local.bDic.Declare
	V.Local.dCutoff.Declare

	F.Intrinsic.Control.If(V.DataTable.dtPODrop.Exists)
		F.Data.DataTable.Close("dtPODrop")
	F.Intrinsic.Control.EndIf

	Gui.frmPO.lblStatus.Caption("Loading Drop Ship POs....")
	Gui.frmPO.lblStatus.Visible(True)
	Gui.frmPO.progBarStatus.Visible(True)
	V.Global.sPart.Set("")
	
	V.Local.dCutoff.Set(V.Screen.frmPO!dtpCutoff.Value)
	
	F.Intrinsic.Control.If(V.Screen.frmPO!chkCutoff.Value,=,0)
		F.Data.DataTable.CreateFromSQL("dtPODrop","con","SELECT B.PART,B.LOCATION,B.DESCRIPTION,RTRIM(C.NAME_VENDOR) AS VENDOR,B.PRODUCT_LINE AS PL,B.CODE_SORT AS SORTCODE,B.TIME_MATERIAL_LEAD AS LEADTIME,B.QTY_ORDER AS ORDERQTY,B.QTY_ONHAND AS ONHANDQTY,B.QTY_ONORDER_PO AS ONORDER,B.QTY_REORDER AS REORDERPT,B.UM_INVENTORY AS UM,B.UM_PURCHASING AS UMPURCH,B.FACTOR_CONVERSION AS CONVERSION,A.ORDER_NO,LEFT(A.RECORD_NO,3) AS RECORD_NO,A.DATE_ITEM_PROM AS DATE_DUE,DATEADD(DAY,(B.TIME_MATERIAL_LEAD*-1),A.DATE_ITEM_PROM) AS PURCHASEDATE,A.QTY_BO AS PURCHASE FROM V_ORDER_LINES A JOIN V_INVENTORY_MSTR B ON A.PART = B.PART AND A.LOCATION = B.LOCATION JOIN V_INVENTORY_MST2 C ON A.PART = C.PART AND A.LOCATION = C.LOCATION LEFT JOIN V_PO_DROP_SHIP D ON A.ORDER_NO = D.ORDER_NO AND A.RECORD_NO = D.ORDER_LINE WHERE A.LINE_TYPE = 'D' AND D.PO IS NULL AND C.CODE_SOURCE IN ('P','J');",True)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("SELECT B.PART,B.LOCATION,B.DESCRIPTION,RTRIM(C.NAME_VENDOR) AS VENDOR,B.PRODUCT_LINE AS PL,B.CODE_SORT AS SORTCODE,B.TIME_MATERIAL_LEAD AS LEADTIME,B.QTY_ORDER AS ORDERQTY,B.QTY_ONHAND AS ONHANDQTY,B.QTY_ONORDER_PO AS ONORDER,B.QTY_REORDER AS REORDERPT,B.UM_INVENTORY AS UM,B.UM_PURCHASING AS UMPURCH,B.FACTOR_CONVERSION AS CONVERSION,A.ORDER_NO,LEFT(A.RECORD_NO,3) AS RECORD_NO,A.DATE_ITEM_PROM AS DATE_DUE,DATEADD(DAY,(B.TIME_MATERIAL_LEAD*-1),A.DATE_ITEM_PROM) AS PURCHASEDATE,A.QTY_BO AS PURCHASE FROM V_ORDER_LINES A JOIN V_INVENTORY_MSTR B ON A.PART = B.PART AND A.LOCATION = B.LOCATION JOIN V_INVENTORY_MST2 C ON A.PART = C.PART AND A.LOCATION = C.LOCATION LEFT JOIN V_PO_DROP_SHIP D ON A.ORDER_NO = D.ORDER_NO AND A.RECORD_NO = D.ORDER_LINE WHERE A.LINE_TYPE = 'D' AND D.PO IS NULL AND C.CODE_SOURCE IN ('P','J') AND A.DATE_ITEM_PROM <= '{0}';",V.Local.dCutoff.PervasiveDate,V.Local.sSQL)
		F.Data.DataTable.CreateFromSQL("dtPODrop","con",V.Local.sSQL,True)
	F.Intrinsic.Control.EndIf
	
	F.Data.DataTable.AddColumn("dtPODrop","Select",Boolean,False)
	F.Data.DataTable.AddColumn("dtPODrop","VendorName",String,"")
	F.Data.DataTable.AddColumn("dtPODrop","Cost",Float,0)
	F.Data.DataTable.AddColumn("dtPODrop","POHistory",String,"History")
	F.Data.DataTable.AddColumn("dtPODrop","GLAcct",String,"")
	
	F.Data.DataTable.FillFromDictionary("dtPODrop","dVendorName","Vendor","VendorName")
	F.Data.DataTable.FillFromDictionary("dtPODrop","dGLAcct","PL","GLAcct")

	F.Intrinsic.Control.CallSub(LoadGvPODrop)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.InvCheckDrop.End

Program.Sub.LoadGvPODrop.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCnt.Declare
	V.Local.iNext.Declare
	V.Local.sPart.Declare
	V.Local.sLoc.Declare
	V.Local.sNextPart.Declare
	V.Local.sNextLoc.Declare
	V.Local.sColor.Declare
	V.Local.sValues.Declare

	Gui.frmPO.GsGCPODrop.AddGridViewFromDataTable("gvPODrop","dtPODrop")
	Gui.frmPO.GsGCPODrop.Icon(V.Global.sGsGCIcon)
	Gui.frmPO.GsGCPODrop.SuspendLayout()
	Gui.frmPO.GsGCPODrop.SetGridViewProperty("gvPODrop","MultiSelect",True)
	Gui.frmPO.GsGCPODrop.SetGridViewProperty("gvPODrop","AllowSort",True)
	Gui.frmPO.GsGCPODrop.SetGridViewProperty("gvPODrop","AllowFilter",True)
	Gui.frmPO.GsGCPODrop.SetGridViewProperty("gvPODrop","ShowGroupPanel",True)
	Gui.frmPO.GsGCPODrop.SetGridViewProperty("gvPODrop","Enableappearanceoddrow",True)
	
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Select","Visible",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Vendor","Visible",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","GLAcct","Visible",False)
	
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","POHistory","ShowCaption",False)
	
'	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Select","VisibleIndex","0")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PART","VisibleIndex","1")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","LOCATION","VisibleIndex","2")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","DESCRIPTION","VisibleIndex","3")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","ORDER_NO","VisibleIndex","4")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","RECORD_NO","VisibleIndex","5")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","VendorName","VisibleIndex","6")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PL","VisibleIndex","7")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","SortCode","VisibleIndex","8")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","LEADTIME","VisibleIndex","9")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","OrderQty","VisibleIndex","10")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","OnHandQty","VisibleIndex","11")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","OnOrder","VisibleIndex","13")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","ReOrderPt","VisibleIndex","14")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","UM","VisibleIndex","15")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","UMPurch","VisibleIndex","16")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Conversion","VisibleIndex","17")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PURCHASEDATE","VisibleIndex","18")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","DATE_DUE","VisibleIndex","19")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Cost","VisibleIndex","20")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Purchase","VisibleIndex","21")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","POHistory","VisibleIndex","22")

	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Select","Caption","Select")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PART","Caption","Part")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","LOCATION","Caption","Loc")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","DESCRIPTION","Caption","Description")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","VendorName","Caption","Preferred Vendor")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PL","Caption","PL")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","SortCode","Caption","Sort Code")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","LEADTIME","Caption","Lead Time")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","OrderQty","Caption","Order Qty")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","OnHandQty","Caption","On Hand Qty")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","OnOrder","Caption","On Order")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","ReOrderPt","Caption","ReOrder Pt")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","UM","Caption","UM")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","UMPurch","Caption","UM Purch")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Conversion","Caption","Conversion")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PURCHASEDATE","Caption","Purch. Date")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","DATE_DUE","Caption","Due Date")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Cost","Caption","Cost")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Purchase","Caption","PO Quantity")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","ORDER_NO","Caption","SO")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","RECORD_NO","Caption","SO Line")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","POHistory","Caption","PO History")

	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Select","MinWidth","50")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PART","MinWidth","140")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","LOCATION","MinWidth","40")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","DESCRIPTION","MinWidth","200")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","VendorName","MinWidth","200")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PL","MinWidth","35")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","SortCode","MinWidth","90")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","LEADTIME","MinWidth","65")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","OrderQty","MinWidth","85")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","OnHandQty","MinWidth","85")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","OnOrder","MinWidth","85")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","ReOrderPt","MinWidth","85")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","UM","MinWidth","55")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","UMPurch","MinWidth","70")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Conversion","MinWidth","85")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PURCHASEDATE","MinWidth","85")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","DATE_DUE","MinWidth","85")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Cost","MinWidth","85")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Purchase","MinWidth","85")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","ORDER_NO","MinWidth","60")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","RECORD_NO","MinWidth","60")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","POHistory","MinWidth","60")
	
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Select","AllowEdit",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PART","AllowEdit",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","LOCATION","AllowEdit",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","DESCRIPTION","AllowEdit",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Vendor","AllowEdit",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","VendorName","AllowEdit",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PL","AllowEdit",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","SortCode","AllowEdit",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","LEADTIME","AllowEdit",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","OrderQty","AllowEdit",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","OnHandQty","AllowEdit",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","OnOrder","AllowEdit",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","ReOrderPt","AllowEdit",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","UM","AllowEdit",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","UMPurch","AllowEdit",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Conversion","AllowEdit",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PURCHASEDATE","AllowEdit",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","DATE_DUE","AllowEdit",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Cost","AllowEdit",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Purchase","AllowEdit",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","ORDER_NO","AllowEdit",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","RECORD_NO","AllowEdit",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","POHistory","AllowEdit",False)

	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Select","ReadOnly",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","DATE_DUE","ReadOnly",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Cost","ReadOnly",False)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Purchase","ReadOnly",False)

	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Select","HeaderFontBold",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PART","HeaderFontBold",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","LOCATION","HeaderFontBold",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","DESCRIPTION","HeaderFontBold",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","VendorName","HeaderFontBold",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PL","HeaderFontBold",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","SortCode","HeaderFontBold",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","LEADTIME","HeaderFontBold",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","OrderQty","HeaderFontBold",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","OnHandQty","HeaderFontBold",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","OnOrder","HeaderFontBold",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","ReOrderPt","HeaderFontBold",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","UM","HeaderFontBold",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","UMPurch","HeaderFontBold",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Conversion","HeaderFontBold",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PURCHASEDATE","HeaderFontBold",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","DATE_DUE","HeaderFontBold",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Cost","HeaderFontBold",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Purchase","HeaderFontBold",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","ORDER_NO","HeaderFontBold",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","RECORD_NO","HeaderFontBold",True)
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","POHistory","HeaderFontBold",True)
	
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Select","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PART","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","LOCATION","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","DESCRIPTION","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","VendorName","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PL","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","SortCode","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","LEADTIME","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","OrderQty","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","OnHandQty","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","OnOrder","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","ReOrderPt","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","UM","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","UMPurch","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Conversion","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PURCHASEDATE","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","DATE_DUE","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Cost","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Purchase","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","ORDER_NO","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","RECORD_NO","HeaderHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","POHistory","HeaderHAlignment","Center")
	
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Select","CellHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","LOCATION","CellHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","VendorName","CellHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PL","CellHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","SortCode","CellHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","LEADTIME","CellHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","UM","CellHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","UMPurch","CellHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Conversion","CellHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PURCHASEDATE","CellHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","DATE_DUE","CellHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","ORDER_NO","CellHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","RECORD_NO","CellHAlignment","Center")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","POHistory","CellHAlignment","Center")
	
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PART","CellForeColor","Blue")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","LOCATION","CellForeColor","Blue")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","DESCRIPTION","CellForeColor","Blue")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","VendorName","CellForeColor","Blue")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","ORDER_NO","CellForeColor","Blue")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","RECORD_NO","CellForeColor","Blue")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","POHistory","CellForeColor","White")

	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","DATE_DUE","CellBackColor","LightYellow")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Cost","CellBackColor","LightYellow")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Purchase","CellBackColor","LightYellow")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","POHistory","CellBackColor","Gray")

	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","OrderQty","DisplayCustomNumeric","#,###,###,##0.00##")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","OnHandQty","DisplayCustomNumeric","#,###,###,##0.00##")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","OnOrder","DisplayCustomNumeric","#,###,###,##0.00##")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","ReOrderPt","DisplayCustomNumeric","#,###,###,##0.00##")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Conversion","DisplayCustomNumeric","#,###,###,##0.00##")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Cost","DisplayCustomNumeric","#,###,###,##0.00##")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","Purchase","DisplayCustomNumeric","#,###,###,##0.00##")

	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","PURCHASEDATE","DisplayCustomDatetime","d")
	Gui.frmPO.GsGCPODrop.SetColumnProperty("gvPODrop","DATE_DUE","DisplayCustomDatetime","d")

	Gui.frmPO.GsGCPODrop.ResumeLayout()
	Gui.frmPO.GsGCPODrop.MainView("gvPODrop")
	
	Gui.frmPO.lblStatus.Visible(False)
	Gui.frmPO.progBarStatus.Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadGvPODrop.End

Program.Sub.GsGCPO_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sPart.Declare
	V.Local.sLoc.Declare
	V.Local.fQty.Declare
	V.Local.sFilter.Declare
	V.Local.sParams.Declare
	V.Local.sCaption.Declare
	V.Local.sGV.Declare
	V.Local.sDT.Declare
	V.Local.sSO.Declare
	V.Local.sVendor.Declare
	
	F.Intrinsic.Control.BlockEvents
	
	F.Intrinsic.Control.SelectCase(V.Screen.frmPO!tabPO.Tab)
		F.Intrinsic.Control.Case(0)
			V.Local.sGV.Set("gvPO")
			V.Local.sDT.Set("dtPO")
		F.Intrinsic.Control.Case(1)
			V.Local.sGV.Set("gvPOSO")
			V.Local.sDT.Set("dtPOSO")
		F.Intrinsic.Control.Case(2)
			V.Local.sGV.Set("gvPODrop")
			V.Local.sDT.Set("dtPODrop")
		F.Intrinsic.Control.Case(3)
			V.Local.sGV.Set("gvReqs")
			V.Local.sDT.Set("dtReqs")
	F.Intrinsic.Control.EndSelect

	V.Global.sPart.Set("")
	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.CaseAny("PART","LOCATION")
'			Gui.FrmPO.GsGCPO.GetCellValueByColumnName("gvPO","PART",V.Args.RowIndex,V.Local.sPart)
'			Gui.FrmPO.GsGCPO.GetCellValueByColumnName("gvPO","LOCATION",V.Args.RowIndex,V.Local.sLoc)
'			Gui.frmPO.GsGCPO.Enabled(False)
'			F.Intrinsic.String.Replace(V.Local.sPart,"'","''",V.Local.sPart)
'			F.Intrinsic.String.Replace(V.Local.sLoc,"'","''",V.Local.sLoc)
'			F.Intrinsic.String.Build("PART = '{0}' AND LOCATION = '{1}'",V.Local.sPart,V.Local.sLoc,V.Local.sFilter)
'			F.Data.DataView.Create("dtMRP","dvMRP",22,V.Local.sFilter,"DATE_DUE ASC")
'			Function.Intrinsic.Control.CallSub(loadgvmrp,"Part",V.Local.sPart,"Loc",V.Local.sLoc)
'			Gui.frmPO.GsGCPO.Enabled(True)
			
			'Fill Demand, Supply and RFQ
			V.Global.sPart.Set(V.DataTable.[V.Local.sDT](V.Args.RowIndex).Part!FieldValTrim)
			F.Intrinsic.Control.If(V.DataTable.[V.Local.sDT](V.Args.RowIndex).Location!FieldValTrim,=,"")
				F.Intrinsic.String.Build("Demand || Part: {0}",V.DataTable.[V.Local.sDT](V.Args.RowIndex).Part!FieldValTrim,V.Local.sCaption)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("Demand || Part: {0}	Loc: {1}",V.DataTable.[V.Local.sDT](V.Args.RowIndex).Part!FieldValTrim,V.DataTable.[V.Local.sDT](V.Args.RowIndex).Location!FieldValTrim,V.Local.sCaption)
			F.Intrinsic.Control.EndIf
			Gui.frmPO.lblDemand.Caption(V.Local.sCaption)
			F.Intrinsic.Control.If(V.Screen.frmPO!tabPO.Tab,=,0,OR,V.Screen.frmPO!tabPO.Tab,=,3)
				F.Intrinsic.Control.CallSub(LoadDemand,"Part",V.DataTable.[V.Local.sDT](V.Args.RowIndex).Part!FieldValTrim,"Loc",V.DataTable.[V.Local.sDT](V.Args.RowIndex).Location!FieldValTrim)
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.CallSub(LoadDemandSO,"Part",V.DataTable.[V.Local.sDT](V.Args.RowIndex).Part!FieldValTrim,"Loc",V.DataTable.[V.Local.sDT](V.Args.RowIndex).Location!FieldValTrim)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.CallSub(LoadVendorQuote,"Part",V.DataTable.[V.Local.sDT](V.Args.RowIndex).Part!FieldValTrim,"Vendor",V.DataTable.[V.Local.sDT](V.Args.RowIndex).Vendor!FieldValTrim)
			F.Intrinsic.Control.CallSub(LoadSupply,"Part",V.DataTable.[V.Local.sDT](V.Args.RowIndex).Part!FieldValTrim,"Loc",V.DataTable.[V.Local.sDT](V.Args.RowIndex).Location!FieldValTrim)
		
		F.Intrinsic.Control.CaseAny("Description","DESCRIPTION")
			Gui.FrmPO.[V.Args.ControlName].GetCellValueByColumnName(V.Local.sGV,"PART",V.Args.RowIndex,V.Local.sPart)
			Gui.FrmPO.[V.Args.ControlName].GetCellValueByColumnName(V.Local.sGV,"LOCATION",V.Args.RowIndex,V.Local.sLoc)
			F.Intrinsic.String.Build("{0}!*!{1}!*!MR",V.Local.sPart,V.Local.sLoc,V.Local.sParams)
			F.Global.General.CallWrapperASync(7200,V.Local.sParams)
			
		F.Intrinsic.Control.CaseAny("ORDER_NO","RECORD_NO")
			Gui.frmPO.[V.Args.ControlName].GetCellValueByColumnName(V.Local.sGV,"ORDER_NO",V.Args.RowIndex,V.Local.sSO)
			F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sSO,"O","*!*ZDR*!*",V.Local.sParams)
			F.Global.General.CallWrapperAsync(200000,V.Local.sParams)
		
		F.Intrinsic.Control.CaseAny("POHistory","POHISTORY")
			Gui.frmPO.[V.Args.ControlName].GetCellValueByColumnName(V.Local.sGV,"PART",V.Args.RowIndex,V.Local.sPart)
			Gui.frmPO.[V.Args.ControlName].GetCellValueByColumnName(V.Local.sGV,"LOCATION",V.Args.RowIndex,V.Local.sLoc)
			F.Intrinsic.String.Build("PO History (Part: {0} Loc: {1})",V.Local.sPart.Trim,V.Local.sLoc.Trim,V.Local.sCaption)
			Gui.frmHistory..Caption(V.Local.sCaption)
			F.Intrinsic.Control.CallSub(LoadPOHistory,"Part",V.Local.sPart,"Loc",V.Local.sLoc)
			
		F.Intrinsic.Control.CaseAny("VendorName","VENDORNAME")
			Gui.frmPO.[V.Args.ControlName].GetCellValueByColumnName(V.Local.sGV,"PART",V.Args.RowIndex,V.Local.sPart)
			Gui.frmPO.[V.Args.ControlName].GetCellValueByColumnName(V.Local.sGV,"LOCATION",V.Args.RowIndex,V.Local.sLoc)
			Gui.frmPO.[V.Args.ControlName].GetCellValueByColumnName(V.Local.sGV,"Purchase",V.Args.RowIndex,V.Local.sLoc)
			Gui.frmPO.[V.Args.ControlName].GetCellValueByColumnName(V.Local.sGV,"Vendor",V.Args.RowIndex,V.Local.sVendor)
			V.Global.sPart.Set(V.Local.sPart)
			V.Global.sLoc.Set(V.Local.sLoc)
			V.Global.fQty.Set(V.Local.fQty)
			V.Global.sDt.Set(V.Local.sDT)
			V.Global.iRowIndex.Set(V.Args.RowIndex)
			F.Intrinsic.Control.If(V.Screen.frmPO!chkBrwVends.Value,=,0)
				Gui.frmPO.chkBrwVends.Value(0)
				Gui.frmPO.GsGCVendQte.ContextMenuAttach("ctxVendQte")
				F.Intrinsic.String.Replace(V.Local.sPart,"'","''",V.Local.sPart)
				F.Intrinsic.Control.CallSub(GetVendorQuotes,"Part",V.Local.sPart,"Loc",V.Local.sLoc)
			F.Intrinsic.Control.Else
				Gui.frmPO.chkBrwVends.Value(1)
				F.Intrinsic.Control.CallSub(chkBrwVends_Click)
			F.Intrinsic.Control.EndIf
			
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.UnBlockEvents
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCPO_RowCellClick.End

Program.Sub.chkBrwVends_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.If(V.Screen.frmPO!chkBrwVends.Value,=,0)
		V.Global.bVendQte.Set(True)
		Gui.frmPO.GsGCVendQte.ContextMenuAttach("ctxVendQte")
		Gui.frmPO.lblVendQte.Caption("Vendor Quotes")
		F.Intrinsic.Control.If(V.DataTable.dtGetVendQtes.Exists)
			Gui.frmPO.GsGCVendQte.ClearRows("gvVendors")
			F.Data.DataTable.Close("dtGetVendQtes")
		F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Else
		V.Global.bVendQte.Set(False)
		Gui.frmPO.GsGCVendQte.ContextMenuAttach("ctxVendor")
		Gui.frmPO.lblVendQte.Caption("Vendors")
		
		F.Intrinsic.Control.If(V.DataTable.dtGetVendQtes.Exists)
			F.Data.DataTable.Close("dtGetVendQtes")
		F.Intrinsic.Control.EndIf
	
		F.Data.DataTable.CreateFromSQL("dtGetVendQtes","con","Select Vendor,RTrim(Name_Vendor) As Name_Vendor From V_Vendor_Master Where Vendor <> '' Order By Name_Vendor;",True)
		
		Gui.frmPO.GsGCVendQte.AddGridviewFromDatatable("gvVendors","dtGetVendQtes")
		Gui.frmPO.GsGCVendQte.ResumeLayout()
		Gui.frmPO.GsGCVendQte.SetGridViewProperty("gvVendors","MultiSelect",True)
		Gui.frmPO.GsGCVendQte.SetGridViewProperty("gvVendors","Editable",False)
		Gui.frmPO.GsGCVendQte.SetGridViewProperty("gvVendors","ReadOnly",True)
		Gui.frmPO.GsGCVendQte.SetGridViewProperty("gvVendors","AllowSort",True)
		Gui.frmPO.GsGCVendQte.SetGridViewProperty("gvVendors","AllowFilter",True)
		Gui.frmPO.GsGCVendQte.SetGridViewProperty("gvVendors","ShowGroupPanel",False)
		Gui.frmPO.GsGCVendQte.SetGridViewProperty("gvVendors","OptionsSelectionEnableAppearanceFocusedRow",False)
		
		'VENDOR
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendors","VENDOR","Caption","Vendor No")
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendors","VENDOR","MinWidth","75")
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendors","VENDOR","MaxWidth","75")
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendors","VENDOR","HeaderFontBold",True)
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendors","VENDOR","HeaderHAlignment","Center")
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendors","VENDOR","CellHAlignment","Center")
		
		'NAME_VENDOR
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendors","NAME_VENDOR","Caption","Vendor Name")
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendors","NAME_VENDOR","MinWidth","125")
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendors","NAME_VENDOR","HeaderFontBold",True)
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendors","NAME_VENDOR","HeaderHAlignment","Left")
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendors","NAME_VENDOR","CellHAlignment","Left")
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendors","NAME_VENDOR","CellForeColor","Blue")
	
		Gui.frmPO.GsGCVendQte.ResumeLayout()
		Gui.frmPO.GsGCVendQte.MainView("gvVendors")
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.chkBrwVends_Click.End

Program.Sub.LoadDemand.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	v.Local.sRet.Declare
	V.Local.sSQL.Declare
	V.Local.sPart.Declare
	v.Local.iCnt.Declare
	v.Local.sOrder.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtDemand.Exists)
		F.Data.DataTable.Close("dtDemand")
	F.Intrinsic.Control.EndIf
	
	f.Intrinsic.UI.InvokeWaitDialog("Get demand...")
	F.Intrinsic.String.Replace(V.Args.Part,"'","''",V.Local.sPart)
	F.Intrinsic.String.Build("Select 'Work Order' As Source,Job+'-'+Suffix As Record,'' as DPAS,Date_Due,Qty_Committed-Qty_Issued As Qty_Rem From V_Job_Commitments Where Part = '{0}' And Location = '{1}' UNION Select 'Sales Order' AS Source,Order_No+'-'+Left(Record_No,3) As Record,'' as DPAS,Date_Item_Prom As Date_Due,Qty_BO As Qty_Rem From V_Order_Lines Where Part = '{0}' And Location = '{1}' Order By Date_Due ASC;",V.Local.sPart,V.Args.Loc,V.Local.sSQL)
	'working
	
	F.Data.DataTable.CreateFromSQL("dtDemand","con",V.Local.sSQL,True)	
	f.Intrinsic.Control.For(v.Local.iCnt,0,v.DataTable.dtDemand.RowCount--,1)
		f.Intrinsic.Control.If(v.DataTable.dtDemand(v.Local.iCnt).Source!FieldValString,=,"Work Order")
			'Work Order link to Project with DPAS
			f.Intrinsic.String.Build("Select top 1 Project from Project_XRef where WO + '-' + WO_Suff = '{0}'",v.DataTable.dtDemand(v.Local.iCnt).Record!FieldValString,v.Local.sSQL)
			f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSQL,v.Local.sRet)
			f.Intrinsic.Control.If(v.Local.sRet.Trim,<>,"")
				f.Intrinsic.String.Build("Select dpas_text from GCG_4857_DPAS_PROJ where Project = '{0}'",v.Local.sRet,v.Local.sSQL)
				f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSQL,v.Local.sRet)	
				f.Intrinsic.Control.If(v.Local.sRet.Trim,<>,"")
					f.Data.DataTable.SetValue("dtDemand",v.Local.iCnt,"DPAS",v.Local.sRet)
				f.Intrinsic.Control.EndIf
			f.Intrinsic.Control.EndIf
		f.Intrinsic.Control.ElseIf(v.DataTable.dtDemand(v.Local.iCnt).Source!FieldValString,=,"Sales Order")
			'Sales Order link to Project with DPAS
			v.Local.sOrder.Set(v.DataTable.dtDemand(v.Local.iCnt).Record!FieldValString)
			f.Intrinsic.String.Build("Select Top 1 Project from V_Order_header where Order_No =  '{0}'",v.Local.sOrder.left7,v.Local.sSQL)
			f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSQL,v.Local.sRet)		
			f.Intrinsic.Control.If(v.Local.sRet.Trim,<>,"")
				f.Intrinsic.String.Build("Select dpas_text from GCG_4857_DPAS_PROJ where Project = '{0}'",v.Local.sRet,v.Local.sSQL)
				f.ODBC.Connection!con.ExecuteAndReturn(v.Local.sSQL,v.Local.sRet)	
				f.Intrinsic.Control.If(v.Local.sRet.Trim,<>,"")
					f.Data.DataTable.SetValue("dtDemand",v.Local.iCnt,"DPAS",v.Local.sRet)
				f.Intrinsic.Control.EndIf
			f.Intrinsic.Control.EndIf
		f.Intrinsic.Control.EndIf
	f.Intrinsic.Control.Next(v.Local.iCnt)
	f.Intrinsic.UI.CloseWaitDialog
	Gui.frmPO.GsGCDemand.AddGridViewFromDataTable("gvDemand","dtDemand")
	Gui.frmPO.GsGCDemand.ResumeLayout()
	Gui.frmPO.GsGCDemand.SetGridViewProperty("gvDemand","MultiSelect",True)
	Gui.frmPO.GsGCDemand.SetGridViewProperty("gvDemand","Editable",False)
	Gui.frmPO.GsGCDemand.SetGridViewProperty("gvDemand","ReadOnly",True)
	Gui.frmPO.GsGCDemand.SetGridViewProperty("gvDemand","AllowSort",True)
	Gui.frmPO.GsGCDemand.SetGridViewProperty("gvDemand","AllowFilter",True)
	Gui.frmPO.GsGCDemand.SetGridViewProperty("gvDemand","ShowGroupPanel",True)
	Gui.frmPO.GsGCDemand.SetGridViewProperty("gvDemand","OptionsSelectionEnableAppearanceFocusedRow",False)
	
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Record","ShowCaption",False)
	
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Source","Caption","Source")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Record","Caption","Record")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Date_Due","Caption","Due Date")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Qty_Rem","Caption","Rem Qty")

	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Source","MinWidth","65")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Record","MinWidth","65")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Date_Due","MinWidth","85")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Qty_Rem","MinWidth","85")

	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Source","HeaderFontBold",True)
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Record","HeaderFontBold",True)
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Date_Due","HeaderFontBold",True)
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Qty_Rem","HeaderFontBold",True)
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","DPAS","HeaderFontBold",True)

	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Source","HeaderHAlignment","Center")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Record","HeaderHAlignment","Center")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Date_Due","HeaderHAlignment","Center")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Qty_Rem","HeaderHAlignment","Center")

	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Source","CellHAlignment","Center")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Record","CellHAlignment","Center")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Date_Due","CellHAlignment","Center")
	
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Record","CellForeColor","Blue")

	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Qty_Rem","DisplayCustomNumeric","#,###,###,##0.00##")

	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Date_Due","DisplayCustomDatetime","d")

	Gui.frmPO.GsGCDemand.ResumeLayout()
	Gui.frmPO.GsGCDemand.MainView("gvDemand")

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDemand.End

Program.Sub.LoadDemandSO.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.sSQL.Declare
	V.Local.sSQL2.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtDemand.Exists)
		F.Data.DataTable.Close("dtDemand")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Screen.frmPO!tabPO.Tab,=,1)
		F.Intrinsic.String.Build("Select '' As Plus,A.Order_No,Left(A.Record_No,3) As SOLine,Record_No As Record_No2,A.Qty_BO,A.Date_Item_Prom From V_Order_Lines A Left Join V_Sales_Ord_Com B On A.Order_No = B.Order_No And A.Record_No = B.Order_Line And B.Seq <> '000' Where A.Line_Type <> 'D' And A.Part = '{0}' And A.Location = '{1}';",V.Args.Part,V.Args.Loc,V.Local.sSQL)
		F.Intrinsic.String.Build("Select PO,PO_Line,A.Order_No,A.Order_Line From V_Sales_Ord_Com A Join V_Order_Lines B On A.Order_No = B.Order_No And A.Order_Line = B.Record_No Where A.Part = '{0}' And A.Loc = '{1}';",V.Args.Part,V.Args.Loc,V.Local.sSQL2)
	F.Intrinsic.Control.ElseIf(V.Screen.frmPO!tabPO.Tab,=,2)
		F.Intrinsic.String.Build("Select '' As Plus,A.Order_No,Left(A.Record_No,3) As SOLine,Record_No As Record_No2,A.Qty_BO,A.Date_Item_Prom From V_Order_Lines A Left Join V_PO_Drop_Ship B On A.Order_No = B.Order_No And A.Record_No = B.Order_Line Where A.Line_Type = 'D' And A.Part = '{0}' And A.Location = '{1}';",V.Args.Part,V.Args.Loc,V.Local.sSQL)
		F.Intrinsic.String.Build("Select PO,PO_Line,A.Order_No,A.Order_Line From V_PO_Drop_Ship A Join V_Order_Lines B On A.Order_No = B.Order_No And A.Order_Line = B.Record_No Where A.Part = '{0}' And A.Loc = '{1}';",V.Args.Part,V.Args.Loc,V.Local.sSQL2)
	F.Intrinsic.Control.EndIf
	F.Data.DataTable.CreateFromSQL("dtDemand","con",V.Local.sSQL,True)
	F.Data.DataView.Create("dtDemand","dvDemand")
	F.Data.DataTable.CreateFromSQL("dtDemand$dtPO","con",V.Local.sSQL2,True)
	F.Data.DataTable.AddRelation("dtDemand","Order_No*!*Record_No2","dtDemand$dtPO","Order_No*!*Order_Line")
	
	Gui.frmPO.GsGCDemand.AddGridviewFromDataview("gvDemand","dtDemand","dvDemand")
	Gui.frmPO.GsGCDemand.ResumeLayout()
	Gui.frmPO.GsGCDemand.SetGridViewProperty("gvDemand","MultiSelect",True)
	Gui.frmPO.GsGCDemand.SetGridViewProperty("gvDemand","Editable",False)
	Gui.frmPO.GsGCDemand.SetGridViewProperty("gvDemand","ReadOnly",True)
	Gui.frmPO.GsGCDemand.SetGridViewProperty("gvDemand","AllowSort",True)
	Gui.frmPO.GsGCDemand.SetGridViewProperty("gvDemand","AllowFilter",True)
	Gui.frmPO.GsGCDemand.SetGridViewProperty("gvDemand","ShowGroupPanel",True)
	Gui.frmPO.GsGCDemand.SetGridViewProperty("gvDemand","OptionsSelectionEnableAppearanceFocusedRow",False)
	
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Record_No2","Visible",False)
	
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Plus","ShowCaption",False)
	
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Order_No","Caption","SO")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","SOLine","Caption","Line")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Date_Item_Prom","Caption","Due Date")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Qty_BO","Caption","Rem Qty")

	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Plus","MinWidth","1")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Order_No","MinWidth","65")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","SOLine","MinWidth","35")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Date_Item_Prom","MinWidth","85")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Qty_BO","MinWidth","85")

	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Order_No","HeaderFontBold",True)
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","SOLine","HeaderFontBold",True)
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Date_Item_Prom","HeaderFontBold",True)
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Qty_BO","HeaderFontBold",True)

	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Order_No","HeaderHAlignment","Center")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","SOLine","HeaderHAlignment","Center")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Date_Item_Prom","HeaderHAlignment","Center")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Qty_BO","HeaderHAlignment","Center")

	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Order_No","CellHAlignment","Center")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","SOLine","CellHAlignment","Center")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Date_Item_Prom","CellHAlignment","Center")
	
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Order_No","CellForeColor","Blue")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","SOLine","CellForeColor","Blue")

	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Qty_BO","DisplayCustomNumeric","#,###,###,##0.00##")

	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Date_Item_Prom","DisplayCustomDatetime","d")

	Gui.frmPO.GsGCDemand.ResumeLayout()
	Gui.frmPO.GsGCDemand.MainView("gvDemand")
	
	'SubTable
	F.Data.DataView.Create("dtDemand$dtPO","dvPO")
	Gui.frmPO.GsGCDemand.AddGridviewFromDataview("gvDemand","dtDemand","dvPO")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Order_No","Visible",False)
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","Order_Line","Visible",False)
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","PO","Caption","PO")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","PO_Line","Caption","Line")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","PO","MinWidth","85")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","PO_Line","MinWidth","85")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","PO","HeaderFontBold",True)
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","PO_Line","HeaderFontBold",True)	
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","PO","HeaderHAlignment","Center")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","PO_Line","HeaderHAlignment","Center")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","PO","CellHAlignment","Center")
	Gui.frmPO.GsGCDemand.SetColumnProperty("gvDemand","PO_Line","CellHAlignment","Center")

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDemandSO.End

Program.Sub.LoadVendorQuote.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.sSQL.Declare
	V.Local.sCaption.Declare
	V.Local.sPart.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtVendQte.Exists)
		F.Data.DataTable.Close("dtVendQte")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.DataTable.dtVendQteLines.Exists)
		F.Data.DataTable.Close("dtVendQteLines")
'		Gui.frmPO.GsGCVendQte.ClearRows("gvVendQte")
		Gui.frmPO.lblVendQte.Caption("Vendor Quotes")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.String.Replace(V.Args.Part,"'","''",V.Local.sPart)
	F.Intrinsic.String.Build("Select Top 1 Part,Seq,A.Vendor,B.Name_Vendor,Quote_Date,Expiration_Date,RFQ_Received,Add_Date,Add_By From V_Vend_Qte_Header A Left Join V_Vendor_Master B On A.Vendor = B.Vendor Where Part = '{0}' And Expiration_Date >= CurDate() And A.Vendor = '{1}' Order By Expiration_Date Desc;",V.Local.sPart,V.Args.Vendor,V.Local.sSQL)
	F.Data.DataTable.CreateFromSQL("dtVendQte","con",V.Local.sSQL,True)
	
	F.Intrinsic.Control.If(V.DataTable.dtVendQte.RowCount,<>,0)
		F.Intrinsic.String.Build("Vendor Quotes || {0}({1}) || Exp Date:{2}",V.DataTable.dtVendQte(0).Name_Vendor!FieldValTrim,V.DataTable.dtVendQte(0).Vendor!FieldValTrim,V.DataTable.dtVendQte(0).Expiration_Date!FieldVal,V.Local.sCaption)
		Gui.frmPO.lblVendQte.Caption(V.Local.sCaption)
		
		F.Intrinsic.String.Build("Select Line,Quantity,Unit_Price From Vend_Qte_Lines Where Part = '{0}' And Seq = '{1}' Order By Line;",V.Local.sPart,V.DataTable.dtVendQte(0).Seq!FieldVal,V.Local.sSQL)
		F.Data.DataTable.CreateFromSQL("dtVendQteLines","con",V.Local.sSQL,True)
		
		Gui.frmPO.GsGCVendQte.AddGridViewFromDataTable("gvVendQte","dtVendQteLines")
		Gui.frmPO.GsGCVendQte.ResumeLayout()
		Gui.frmPO.GsGCVendQte.SetGridViewProperty("gvVendQte","MultiSelect",True)
		Gui.frmPO.GsGCVendQte.SetGridViewProperty("gvVendQte","Editable",False)
		Gui.frmPO.GsGCVendQte.SetGridViewProperty("gvVendQte","ReadOnly",True)
		Gui.frmPO.GsGCVendQte.SetGridViewProperty("gvVendQte","AllowSort",True)
		Gui.frmPO.GsGCVendQte.SetGridViewProperty("gvVendQte","AllowFilter",True)
		Gui.frmPO.GsGCVendQte.SetGridViewProperty("gvVendQte","ShowGroupPanel",True)
		Gui.frmPO.GsGCVendQte.SetGridViewProperty("gvVendQte","OptionsSelectionEnableAppearanceFocusedRow",False)
		
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Line","Caption","Line")
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Quantity","Caption","Quantity")
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Unit_Price","Caption","Unit Price")
	
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Line","MinWidth","65")
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Quantity","MinWidth","35")
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Unit_Price","MinWidth","85")
	
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Line","HeaderFontBold",True)
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Quantity","HeaderFontBold",True)
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Unit_Price","HeaderFontBold",True)
	
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Line","HeaderHAlignment","Center")
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Quantity","HeaderHAlignment","Center")
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Unit_Price","HeaderHAlignment","Center")
	
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Line","CellHAlignment","Center")
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Quantity","CellHAlignment","Center")
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Unit_Price","CellHAlignment","Center")
	
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Quantity","DisplayCustomNumeric","#,###,###,##0.00##")
		Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Unit_Price","DisplayCustomNumeric","#,###,###,##0.00##")
	
		Gui.frmPO.GsGCVendQte.ResumeLayout()
		Gui.frmPO.GsGCVendQte.MainView("gvVendQte")
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadVendorQuote.End

Program.Sub.LoadSupply.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.sSQL.Declare
	V.Local.sSQL2.Declare
	V.Local.sPart.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtSupply.Exists)
		F.Data.DataTable.Close("dtSupply")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.String.Replace(V.Args.Part,"'","''",V.Local.sPart)
	F.Intrinsic.String.Build("Select Purchase_Order+'-'+Left(Record_No,3) As PO,Date_Due_Line As Date_Due,Qty_Order-Qty_Received As Qty_Rem From V_PO_Lines Where Part = '{0}' And Location = '{1}' And Flag_Recv_Close <> 'Y' Order By Date_Due_Line Asc;",V.Local.sPart,V.Args.Loc,V.Local.sSQL)
	F.Data.DataTable.CreateFromSQL("dtSupply","con",V.Local.sSQL,True)
	F.Data.DataView.Create("dtSupply","dvSupply")
	
	Gui.frmPO.GsGCSupply.AddGridviewFromDataview("gvSupply","dtSupply","dvSupply")
	Gui.frmPO.GsGCSupply.ResumeLayout()
	Gui.frmPO.GsGCSupply.SetGridViewProperty("gvSupply","MultiSelect",True)
	Gui.frmPO.GsGCSupply.SetGridViewProperty("gvSupply","Editable",False)
	Gui.frmPO.GsGCSupply.SetGridViewProperty("gvSupply","ReadOnly",True)
	Gui.frmPO.GsGCSupply.SetGridViewProperty("gvSupply","AllowSort",True)
	Gui.frmPO.GsGCSupply.SetGridViewProperty("gvSupply","AllowFilter",True)
	Gui.frmPO.GsGCSupply.SetGridViewProperty("gvSupply","ShowGroupPanel",True)
	Gui.frmPO.GsGCSupply.SetGridViewProperty("gvSupply","OptionsSelectionEnableAppearanceFocusedRow",False)
	
	Gui.frmPO.GsGCSupply.SetColumnProperty("gvSupply","PO","Caption","PO")
	Gui.frmPO.GsGCSupply.SetColumnProperty("gvSupply","Date_Due","Caption","Due Date")
	Gui.frmPO.GsGCSupply.SetColumnProperty("gvSupply","Qty_Rem","Caption","Rem Qty")

	Gui.frmPO.GsGCSupply.SetColumnProperty("gvSupply","PO","MinWidth","65")
	Gui.frmPO.GsGCSupply.SetColumnProperty("gvSupply","Date_Due","MinWidth","85")
	Gui.frmPO.GsGCSupply.SetColumnProperty("gvSupply","Qty_Rem","MinWidth","85")

	Gui.frmPO.GsGCSupply.SetColumnProperty("gvSupply","PO","HeaderFontBold",True)
	Gui.frmPO.GsGCSupply.SetColumnProperty("gvSupply","Date_Due","HeaderFontBold",True)
	Gui.frmPO.GsGCSupply.SetColumnProperty("gvSupply","Qty_Rem","HeaderFontBold",True)

	Gui.frmPO.GsGCSupply.SetColumnProperty("gvSupply","PO","HeaderHAlignment","Center")
	Gui.frmPO.GsGCSupply.SetColumnProperty("gvSupply","Date_Due","HeaderHAlignment","Center")
	Gui.frmPO.GsGCSupply.SetColumnProperty("gvSupply","Qty_Rem","HeaderHAlignment","Center")

	Gui.frmPO.GsGCSupply.SetColumnProperty("gvSupply","PO","CellHAlignment","Center")
	Gui.frmPO.GsGCSupply.SetColumnProperty("gvSupply","Date_Due","CellHAlignment","Center")
	
	Gui.frmPO.GsGCSupply.SetColumnProperty("gvSupply","PO","CellForeColor","Blue")

	Gui.frmPO.GsGCSupply.SetColumnProperty("gvSupply","Qty_Rem","DisplayCustomNumeric","#,###,###,##0.00##")

	Gui.frmPO.GsGCSupply.SetColumnProperty("gvSupply","Date_Due","DisplayCustomDatetime","d")

	Gui.frmPO.GsGCSupply.ResumeLayout()
	Gui.frmPO.GsGCSupply.MainView("gvSupply")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadSupply.End

Program.Sub.GetVendorQuotes.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.sSQL.Declare
	V.Local.sSQL2.Declare
	V.Local.sCaption.Declare
	V.Local.iCnt.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtGetVendQtes.Exists)
		F.Data.DataTable.Close("dtGetVendQtes")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.String.Build("Select '' As Plus,A.Part,A.Vendor,RTrim(B.Name_Vendor) As Name_Vendor,A.Seq,A.Quote_Date,A.Expiration_Date From V_Vend_Qte_Header A Left Join V_Vendor_Master B On A.Vendor = B.Vendor Where Part = '{0}' Order By Expiration_Date;",V.Args.Part,V.Local.sSQL)
	F.Data.DataTable.CreateFromSQL("dtGetVendQtes","con",V.Local.sSQL,True)
	F.Data.DataView.Create("dtGetVendQtes","dvGetVendQtes")
	
	F.Intrinsic.String.Build("Select Part,Seq,Line,Quantity,Unit_Price From V_Vend_Qte_Lines Where Part = '{0}' Order By Seq,Line;",V.Args.Part,V.Local.sSQL2)
	F.Data.DataTable.CreateFromSQL("dtGetVendQtes$dtGetVendQtesLines","con",V.Local.sSQL2,True)

	F.Data.DataTable.AddRelation("dtGetVendQtes","Part*!*Seq","dtGetVendQtes$dtGetVendQtesLines","Part*!*Seq")
	
	F.Intrinsic.String.Build("Vendor Quotes || Part: {0}",V.Global.sPart.Trim,V.Local.sCaption)
	Gui.frmPO.lblVendQte.Caption(V.Local.sCaption)
	
	Gui.frmPO.GsGCVendQte.AddGridviewFromDataview("gvVendQte","dtGetVendQtes","dvGetVendQtes")
	Gui.frmPO.GsGCVendQte.ResumeLayout()
	Gui.frmPO.GsGCVendQte.SetGridViewProperty("gvVendQte","MultiSelect",True)
	Gui.frmPO.GsGCVendQte.SetGridViewProperty("gvVendQte","Editable",False)
	Gui.frmPO.GsGCVendQte.SetGridViewProperty("gvVendQte","ReadOnly",True)
	Gui.frmPO.GsGCVendQte.SetGridViewProperty("gvVendQte","AllowSort",True)
	Gui.frmPO.GsGCVendQte.SetGridViewProperty("gvVendQte","AllowFilter",True)
	Gui.frmPO.GsGCVendQte.SetGridViewProperty("gvVendQte","ShowGroupPanel",True)
	Gui.frmPO.GsGCVendQte.SetGridViewProperty("gvVendQte","OptionsSelectionEnableAppearanceFocusedRow",False)
		
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Part","Visible",False)
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Vendor","Visible",False)
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Seq","Visible",False)
	
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Plus","ShowCaption",False)
	
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Part","Caption","Part")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Vendor","Caption","Vendor No")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Name_Vendor","Caption","Vendor")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Seq","Caption","Seq")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Quote_Date","Caption","Quoted")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Expiration_Date","Caption","Expiration")

	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Part","MinWidth","45")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Vendor","MinWidth","45")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Name_Vendor","MinWidth","150")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Seq","MinWidth","45")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Quote_Date","MinWidth","65")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Expiration_Date","MinWidth","65")

	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Part","HeaderFontBold",True)
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Vendor","HeaderFontBold",True)
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Name_Vendor","HeaderFontBold",True)
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Seq","HeaderFontBold",True)
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Quote_Date","HeaderFontBold",True)
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Expiration_Date","HeaderFontBold",True)

	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Part","HeaderHAlignment","Center")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Vendor","HeaderHAlignment","Center")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Name_Vendor","HeaderHAlignment","Center")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Seq","HeaderHAlignment","Center")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Quote_Date","HeaderHAlignment","Center")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Expiration_Date","HeaderHAlignment","Center")

	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Part","CellHAlignment","Center")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Vendor","CellHAlignment","Center")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Name_Vendor","CellHAlignment","Center")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Seq","CellHAlignment","Center")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Quote_Date","CellHAlignment","Center")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Expiration_Date","CellHAlignment","Center")
	
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Vendor","CellForeColor","Blue")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Name_Vendor","CellForeColor","Blue")
	
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Quote_Date","DisplayCustomDatetime","d")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQte","Expiration_Date","DisplayCustomDatetime","d")
	
	Gui.frmPO.GsGCVendQte.ResumeLayout()
	Gui.frmPO.GsGCVendQte.MainView("gvVendQte")
	
	'SubTable
	F.Data.DataView.Create("dtGetVendQtes$dtGetVendQtesLines","dvGetVendQtesLines")
	Gui.frmPO.GsGCVendQte.AddGridviewFromDataview("gvVendQteLines","dtGetVendQtes","dvGetVendQtesLines")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQteLines","Part","Visible",False)
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQteLines","Seq","Visible",False)
	
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQteLines","Line","Caption","Line")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQteLines","Quantity","Caption","Qty")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQteLines","Unit_Price","Caption","Unit Price")
	
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQteLines","Line","MinWidth","45")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQteLines","Quantity","MinWidth","85")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQteLines","Unit_Price","MinWidth","85")
	
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQteLines","Line","HeaderFontBold",True)
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQteLines","Quantity","HeaderFontBold",True)
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQteLines","Unit_Price","HeaderFontBold",True)
	
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQteLines","Line","HeaderHAlignment","Center")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQteLines","Quantity","HeaderHAlignment","Center")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQteLines","Unit_Price","HeaderHAlignment","Center")
	
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQteLines","Line","CellHAlignment","Center")
	
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQteLines","Quantity","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.frmPO.GsGCVendQte.SetColumnProperty("gvVendQteLines","Unit_Price","DisplayCustomNumeric","#,###,###,##0.00")
	
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtGetVendQtes.RowCount--,1)
		Gui.frmPO.GsGCVendQte.ExpandMasterRow("gvVendQte",V.Local.iCnt)
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	F.Intrinsic.Control.CatchWhen(122000)
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GetVendorQuotes.End

Program.Sub.LoadGVMRP.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sCaption.Declare
	V.Local.fOnHand.Declare
	V.Local.sExp.Declare
	V.Local.sValue.Declare
	V.Local.sSQL.Declare
	V.Local.sRet.Declare
	V.Local.sPart.Declare
	V.Local.sLoc.Declare

	F.Intrinsic.String.Replace(V.Args.Part,"''","'",V.Local.sPart)
	F.Intrinsic.String.Build("Part : {0}",V.Local.sPart,V.Local.sCaption)
	Gui.frmMRP.lblPart.Caption(V.Local.sCaption)
	F.Intrinsic.String.Replace(V.Args.Loc,"''","'",V.Local.sLoc)
	F.Intrinsic.String.Build("Loc : {0}",V.Local.sLoc,V.Local.sCaption)
	Gui.frmMRP.lblLoc.Caption(V.Local.sCaption)

	F.Intrinsic.String.Build("SELECT QTY_ORDER,QTY_REORDER FROM V_INVENTORY_MSTR WHERE PART = '{0}' AND LOCATION = '{1}';",V.Args.Part,V.Args.Loc,V.Local.sSQL)
	F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSQL,V.Local.sRet)
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)

	F.Intrinsic.String.Format(V.Local.sRet(0),"#,###,###,##0.00##",V.Local.sValue)
	F.Intrinsic.String.Build("Order Qty : {0}",V.Local.sValue,V.Local.sCaption)
	Gui.frmMRP.lblOrderQty.Caption(V.Local.sCaption)
	F.Intrinsic.String.Format(V.Local.sRet(1),"#,###,###,##0.00##",V.Local.sValue)
	F.Intrinsic.String.Build("Reorder Point : {0}",V.Local.sValue,V.Local.sCaption)
	Gui.frmMRP.lblROP.Caption(V.Local.sCaption)

	F.Intrinsic.Math.Add(V.DataView.dtMRP!dvMRP(0).CurOnHand!FieldValFloat,V.DataView.dtMRP!dvMRP(0).QUANTITY!FieldValFloat,V.Local.fOnHand)
	F.Intrinsic.String.Format(V.Local.fOnHand,"#,###,###,##0.00##",V.Local.sValue)
	F.Intrinsic.String.Build("Initial On Hand Qty : {0}",V.Local.sValue,V.Local.sCaption)
	Gui.frmMRP.lblCurOnHand.Caption(V.Local.sCaption)

	Gui.frmMRP.GsGCMRP.AddGridViewFromDataView("gvMRP","dtMRP","dvMRP")
	Gui.frmMRP.GsGCMRP.SuspendLayout()
	Gui.frmMRP.GsGCMRP.SetGridViewProperty("gvMRP","MultiSelect",True)
	Gui.frmMRP.GsGCMRP.SetGridViewProperty("gvMRP","AllowSort",False)
	Gui.frmMRP.GsGCMRP.SetGridViewProperty("gvMRP","AllowFilter",True)
	Gui.frmMRP.GsGCMRP.SetGridViewProperty("gvMRP","Editable",False)
	Gui.frmMRP.GsGCMRP.SetGridViewProperty("gvMRP","ReadOnly",True)
	Gui.frmMRP.GsGCMRP.SetGridViewProperty("gvMRP","OptionsDetailShowDetailTabs",False)
	Gui.frmMRP.GsGCMRP.SetGridViewProperty("gvMRP","OptionsViewShowGroupPanel",False)

	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","PART","Visible",False)
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","LOCATION","Visible",False)
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","JOB","Visible",False)
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","SUFFIX","Visible",False)
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","SEQUENCE","Visible",False)
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","Description","Visible",False)
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","PL","Visible",False)
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","SortCode","Visible",False)
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","LeadTime","Visible",False)
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","CurOnHand2","Visible",False)
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","Vendor","Visible",False)
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","OrderQty","Visible",False)
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","OnHandQty","Visible",False)
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","ReqdQty","Visible",False)
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","NetAvail","Visible",False)
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","OnOrder","Visible",False)
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","ReOrderPt","Visible",False)
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","UM","Visible",False)
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","UMPurch","Visible",False)
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","Conversion","Visible",False)

	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","SOURCE","VisibleIndex","0")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","DATE_DUE","VisibleIndex","1")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","QUANTITY","VisibleIndex","2")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","CurOnHand","VisibleIndex","3")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","Purchase","VisibleIndex","4")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","PostOnHand","VisibleIndex","5")

	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","SOURCE","Caption","Source ")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","DATE_DUE","Caption","Due Date")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","QUANTITY","Caption","Quantity ")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","CurOnHand","Caption","Current On Hand")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","Purchase","Caption","Proposed PO Amt.")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","PostOnHand","Caption","On Hand After PO")

	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","SOURCE","HeaderHAlignment","Center")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","DATE_DUE","HeaderHAlignment","Center")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","QUANTITY","HeaderHAlignment","Far")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","CurOnHand","HeaderHAlignment","Far")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","Purchase","HeaderHAlignment","Far")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","PostOnHand","HeaderHAlignment","Far")

	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","SOURCE","CellHAlignment","Center")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","DATE_DUE","CellHAlignment","Center")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","QUANTITY","CellHAlignment","Far")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","CurOnHand","CellHAlignment","Far")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","Purchase","CellHAlignment","Far")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","PostOnHand","CellHAlignment","Far")

	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","QUANTITY","DisplayCustomNumeric","#,###,###,##0.00##")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","CurOnHand","DisplayCustomNumeric","#,###,###,##0.00##")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","Purchase","DisplayCustomNumeric","#,###,###,##0.00##")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","PostOnHand","DisplayCustomNumeric","#,###,###,##0.00##")

	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","SOURCE","CellBackColor","WhiteSmoke")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","DATE_DUE","CellBackColor","WhiteSmoke")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","QUANTITY","CellBackColor","WhiteSmoke")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","CurOnHand","CellBackColor","WhiteSmoke")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","Purchase","CellBackColor","WhiteSmoke")
	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","PostOnHand","CellBackColor","WhiteSmoke")

	Gui.frmMRP.GsGCMRP.SetColumnProperty("gvMRP","DATE_DUE","DisplayCustomDatetime","d")

	Gui.frmMRP.GsGCMRP.ResumeLayout()
	Gui.frmMRP.GsGCMRP.MainView("gvMRP")

	F.Data.DataView.Close("dtMRP","dvMRP")
	Gui.frmMRP..Show
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadGVMRP.End

Program.Sub.frmMRP_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmMRP..Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.frmMRP_UnLoad.End

Program.Sub.frmHistory_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmHistory..Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry

Program.Sub.frmHistory_UnLoad.End

Program.Sub.GsGCHistory_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sParams.Declare
	
	F.Intrinsic.Control.If(v.Args.Column,=,"Purchase_Order")
		F.Intrinsic.String.Build("V!*!{0}!*!",V.Args.CellValue,V.Local.sParams)
		F.Global.General.CallWrapperAsync(175200,V.Local.sParams)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCHistory_RowCellClick.End

Program.Sub.LoadPOHistory.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare
	
	F.Intrinsic.Control.If(v.DataTable.dtHist.Exists)
		F.Data.DataTable.Close("dtHist")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.String.Build("Select A.Purchase_Order,Left(A.PO_Line,3) As PO_Line,B.Name_Vendor,A.Buyer,A.Qty_Order,A.Qty_Recd_Not_Insp,A.Qty_Received,A.Qty_Reject,A.Qty_Order - A.Qty_Received as Remaining,A.Cost,A.Date_PO,A.Date_Due,A.Date_Received,A.UM_Inventory,A.Product_Line,A.Job,A.Suffix,RTrim(A.GL_Account) As GL_Account,A.Receiver_No From V_PO_History A Left Join V_Vendor_Master B ON A.Vendor = B.Vendor Where A.Part = '{0}' and A.Location = '{1}' Order By A.Date_Received Desc,A.PO_TIME Desc;",V.Args.Part,V.Args.Loc,v.Local.sSQL)
	
	F.Data.DataTable.CreateFromSQL("dtHist","con",V.Local.sSQL,true)		
	
	F.Intrinsic.Control.CallSub(LoadGvHistory)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadPOHistory.End

Program.Sub.LoadGvHistory.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sTemp.Declare
	
	Gui.frmHistory.GsGCHistory.AddGridviewFromDataTable("gvHist","dtHist")
	Gui.frmHistory.GsGCHistory.SuspendLayout()
	Gui.frmHistory.GsGCHistory.SetGridviewProperty("gvHist","MultiSelect",True)
	Gui.frmHistory.GsGCHistory.SetGridviewProperty("gvHist","Editable",False)
	Gui.frmHistory.GsGCHistory.SetGridviewProperty("gvHist","AllowSort",True)
	Gui.frmHistory.GsGCHistory.SetGridviewProperty("gvHist","AllowFilter",True)
	Gui.frmHistory.GsGCHistory.setGridViewProperty("gvHist","OptionsDetailShowDetailTabs",False)
	Gui.frmHistory.GsGCHistory.SetGridViewProperty("gvHist","OptionsMenuShowAutoFilterRowItem",False)
	Gui.frmHistory.GsGCHistory.SetGridviewProperty("gvHist","OptionsViewShowGroupPanel",True)
	Gui.frmHistory.GsGCHistory.SetGridViewProperty("gvHist","EnableAppearanceOddRow",True)
	
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Purchase_Order","Caption","PO Number")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","PO_Line","Caption","PO Line")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Name_Vendor","Caption","Vendor")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Buyer","Caption","Buyer")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Qty_Order","Caption","Order Qty")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Qty_Recd_Not_Insp","Caption","Not Insp")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Qty_Received","Caption","Received")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Qty_Reject","Caption","Rejected")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Remaining","Caption","Open")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Cost","Caption","Unit Cost")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Date_PO","Caption","Order Date")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Date_Due","Caption","Due Date")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Date_Received","Caption","Received Date")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","UM_Inventory","Caption","UM Inv")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Product_Line","Caption","PL")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Job","Caption","Job")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Suffix","Caption","Suffix")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","GL_Account","Caption","GL Account")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Receiver_No","Caption","Receiver Number")
	
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Purchase_Order","MinWidth","80")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","PO_Line","MinWidth","50")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Name_Vendor","MinWidth","180")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Buyer","MinWidth","55")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Qty_Order","MinWidth","80")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Qty_Recd_Not_Insp","MinWidth","80")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Qty_Received","MinWidth","80")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Qty_Reject","MinWidth","80")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Remaining","MinWidth","80")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Cost","MinWidth","80")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Date_PO","MinWidth","80")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Date_Due","MinWidth","80")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Date_Received","MinWidth","95")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","UM_Inventory","MinWidth","65")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Product_Line","MinWidth","35")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Job","MinWidth","80")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Suffix","MinWidth","80")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","GL_Account","MinWidth","85")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Receiver_No","MinWidth","120")
	
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Purchase_Order","HeaderFontBold",True)
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","PO_Line","HeaderFontBold",True)
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Name_Vendor","HeaderFontBold",True)
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Buyer","HeaderFontBold",True)
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Qty_Order","HeaderFontBold",True)
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Qty_Recd_Not_Insp","HeaderFontBold",True)
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Qty_Received","HeaderFontBold",True)
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Qty_Reject","HeaderFontBold",True)
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Remaining","HeaderFontBold",True)
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Cost","HeaderFontBold",True)
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Date_PO","HeaderFontBold",True)
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Date_Due","HeaderFontBold",True)
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Date_Received","HeaderFontBold",True)
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","UM_Inventory","HeaderFontBold",True)
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Product_Line","HeaderFontBold",True)
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Job","HeaderFontBold",True)
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Suffix","HeaderFontBold",True)
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","GL_Account","HeaderFontBold",True)
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Receiver_No","HeaderFontBold",True)
	
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Purchase_Order","HeaderHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","PO_Line","HeaderHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Name_Vendor","HeaderHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Buyer","HeaderHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Qty_Order","HeaderHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Qty_Recd_Not_Insp","HeaderHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Qty_Received","HeaderHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Qty_Reject","HeaderHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Remaining","HeaderHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Cost","HeaderHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Date_PO","HeaderHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Date_Due","HeaderHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Date_Received","HeaderHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","UM_Inventory","HeaderHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Product_Line","HeaderHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Job","HeaderHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Suffix","HeaderHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","GL_Account","HeaderHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Receiver_No","HeaderHAlignment","Center")
	
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Purchase_Order","CellHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","PO_Line","CellHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Buyer","CellHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","UM_Inventory","CellHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Product_Line","CellHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Receiver_No","CellHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Date_PO","CellHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Date_Due","CellHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Date_Received","CellHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Job","CellHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Suffix","CellHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","GL_Account","CellHAlignment","Center")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Receiver_No","CellHAlignment","Center")
	
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Date_PO","DisplayCustomDateTime","d")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Date_Due","DisplayCustomDateTime","d")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Date_Received","DisplayCustomDateTime","d")
	
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Qty_Order","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Qty_Recd_Not_Insp","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Qty_Received","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Qty_Reject","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Remaining","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.frmHistory.GsGCHistory.SetColumnProperty("gvHist","Cost","DisplayCustomNumeric","#,###,###,##0.00")
	
	Gui.frmHistory.GsGCHistory.ResumeLayout()
	Gui.frmHistory.GsGCHistory.MainView("gvHist")
	
	Gui.frmHistory..Show
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadGvHistory.End

Program.Sub.cmdNewVendQte_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.iRet.Declare
	
	F.Global.General.LaunchMenuTask(271,2,V.Local.iRet)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdNewVendQte_Click.End

Program.Sub.cmdViewVendQte_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	F.Intrinsic.Control.If(V.Global.sPart,<>,"")
		F.Global.General.CallWrapperAsync(175000,V.Global.sPart)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdViewVendQte_Click.End

Program.Sub.chkCutoff_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	F.Intrinsic.Control.If(V.Screen.frmPO!chkCutoff.Value,=,1)
		Gui.frmPO.dtpCutoff.Enabled(True)
	F.Intrinsic.Control.Else
		Gui.frmPO.dtpCutoff.Enabled(False)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.chkCutoff_Click.End

Program.Sub.Hyperlinks.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.sRecord.Declare
	V.Local.sPO.Declare
	V.Local.sSO.Declare
	V.Local.sParams.Declare
	
	F.Intrinsic.Control.BlockEvents
	
	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.CaseAny("Record","RECORD")
			F.Intrinsic.Control.If(V.DataTable.dtDemand(V.Args.RowIndex).Source!FieldVal,=,"Work Order")
				F.Intrinsic.String.Split(V.DataTable.dtDemand(V.Args.RowIndex).Record!FieldVal,"-",V.Local.sRecord)
				F.Intrinsic.String.ConcatCallWrapperArgs("7",V.Local.sRecord(0).Trim,V.Local.sRecord(1).Trim,"A",V.Local.sParams)
				F.Global.General.CallWrapperSync(450000,V.Local.sParams)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Split(V.DataTable.dtDemand(V.Args.RowIndex).Record!FieldVal,"-",V.Local.sRecord)
				F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sRecord(0).Trim,"V","*!*ZDR*!*",V.Local.sParams)
				F.Global.General.CallWrapperAsync(200000,V.Local.sParams)
			F.Intrinsic.Control.EndIf
			
		F.Intrinsic.Control.Case("PO")
			F.Intrinsic.String.Split(V.DataTable.dtSupply(V.Args.RowIndex).PO!FieldVal,"-",V.Local.sRecord)
			F.Intrinsic.String.ConcatCallWrapperArgs("V",V.Local.sRecord(0).Trim,"",V.Local.sParams)
			F.Global.General.CallWrapperASync(175200,V.Local.sParams)
		
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.UnBlockEvents
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.Hyperlinks.End

Program.Sub.GsGCVendQte_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCallType.Declare
	V.Local.iReturnCode.Declare
	V.Local.fReturnCost.Declare
	V.Local.sReturnVendor.Declare
	V.Local.sVendor.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtPO.Exists,=,False)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Global.sPart,=,"")
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.CaseAny("Name_Vendor","Vendor")
			F.Data.DataTable.SetValue(V.Global.sDt,V.Global.iRowIndex,"Vendor",V.DataTable.dtGetVendQtes(V.Args.RowIndex).Vendor!FieldVal,"VendorName",V.DataTable.dtGetVendQtes(V.Args.RowIndex).Name_Vendor!FieldVal)
			F.Intrinsic.Control.If(V.Global.bVendQte)
				F.Intrinsic.Control.CallSub(LoadVendorQuote,"Part",V.Global.sPart,"Vendor",V.DataTable.dtGetVendQtes(V.Args.RowIndex).Vendor!FieldVal)
			F.Intrinsic.Control.EndIf
			'CostType
			F.Intrinsic.Control.If(V.Screen.frmPO!ddlCost.Text,=,"PO History Cost")
				F.Intrinsic.Control.SelectCase(V.DataTable.dtPO(V.Global.iRowIndex).Status!FieldVal)
					F.Intrinsic.Control.Case(0)
						V.Local.iCallType.Set(1)
						V.Local.sVendor.Set("")
					F.Intrinsic.Control.CaseAny(1,2)
						V.Local.iCallType.Set(3)
						V.Local.sVendor.Set("")
				F.Intrinsic.Control.EndSelect
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.SelectCase(V.DataTable.dtPO(V.Global.iRowIndex).Status!FieldVal)
					F.Intrinsic.Control.Case(0)
						V.Local.iCallType.Set(1)
						V.Local.sVendor.Set("")
					F.Intrinsic.Control.Case(1)
						V.Local.iCallType.Set(2)
						V.Local.sVendor.Set(V.DataTable.dtGetVendQtes(V.Args.RowIndex).Vendor!FieldVal)
					F.Intrinsic.Control.Case(2)
						V.Local.iCallType.Set(3)
						V.Local.sVendor.Set("")
				F.Intrinsic.Control.EndSelect
			F.Intrinsic.Control.EndIf				
			'Cost
			F.Global.Callwrapper.New("LoadCost","Purchasing.GetPartPurchaseCost")
			F.Global.Callwrapper.SetProperty("LoadCost","CallType",V.Local.iCallType)
			F.Global.Callwrapper.SetProperty("LoadCost","Part",V.Global.sPart)
			F.Global.Callwrapper.SetProperty("LoadCost","Location",V.Global.sLoc)
			F.Global.Callwrapper.SetProperty("LoadCost","Vendor",V.Local.sVendor)
			F.Global.Callwrapper.SetProperty("LoadCost","Quantity",V.Global.fQty)
			F.Global.CallWrapper.Run("LoadCost")
			'Returns
			F.Global.CallWrapper.GetProperty("LoadCost","ReturnCode",V.Local.iReturnCode)
			F.Global.CallWrapper.GetProperty("LoadCost","ReturnCost",V.Local.fReturnCost)
			F.Global.CallWrapper.GetProperty("LoadCost","ReturnVendor",V.Local.sReturnVendor)
			'Set Value
			F.Data.DataTable.SetValue("dtPO",V.Global.iRowIndex,"Cost",V.Local.fReturnCost)
			'Set Buyers
			F.Data.DataTable.FillFromDictionary("dtPO","dBuyerCode","Vendor","BuyerCode")
			F.Data.DataTable.FillFromDictionary("dtPO","dBuyerName","BuyerCode","BuyerName")
	F.Intrinsic.Control.EndSelect

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCVendQte_RowCellClick.End

Program.Sub.LoadCost.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCallType.Declare
	V.Local.iCnt.Declare
	V.Local.iReturnCode.Declare
	V.Local.fReturnCost.Declare
	V.Local.sReturnVendor.Declare
	V.Local.sVendor.Declare
	
	'1-Default
	'2-Vendor Quote
	'3-Purchase Order History
	
	'PO Tab
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtPO.RowCount--,1)
		F.Intrinsic.Control.If(V.Screen.frmPO!ddlCost.Text,=,"PO History Cost")
			F.Intrinsic.Control.SelectCase(V.DataTable.dtPO(V.Local.iCnt).Status!FieldVal)
				F.Intrinsic.Control.Case(0)
					V.Local.iCallType.Set(1)
					V.Local.sVendor.Set("")
				F.Intrinsic.Control.CaseAny(1,2)
					V.Local.iCallType.Set(3)
					V.Local.sVendor.Set("")
			F.Intrinsic.Control.EndSelect
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.SelectCase(V.DataTable.dtPO(V.Local.iCnt).Status!FieldVal)
				F.Intrinsic.Control.Case(0)
					V.Local.iCallType.Set(1)
					V.Local.sVendor.Set("")
				F.Intrinsic.Control.Case(1)
					V.Local.iCallType.Set(2)
					V.Local.sVendor.Set(V.DataTable.dtPO(V.Local.iCnt).Vendor!FieldVal)
				F.Intrinsic.Control.Case(2)
					V.Local.iCallType.Set(3)
					V.Local.sVendor.Set("")
			F.Intrinsic.Control.EndSelect
		F.Intrinsic.Control.EndIf
		
		F.Global.Callwrapper.New("LoadCost","Purchasing.GetPartPurchaseCost")
		F.Global.Callwrapper.SetProperty("LoadCost","CallType",V.Local.iCallType)
		F.Global.Callwrapper.SetProperty("LoadCost","Part",V.DataTable.dtPO(V.Local.iCnt).Part!FieldVal)
		F.Global.Callwrapper.SetProperty("LoadCost","Location",V.DataTable.dtPO(V.Local.iCnt).Location!FieldVal)
		F.Global.Callwrapper.SetProperty("LoadCost","Vendor",V.Local.sVendor)
		F.Global.Callwrapper.SetProperty("LoadCost","Quantity",V.DataTable.dtPO(V.Local.iCnt).Purchase!FieldVal)
		F.Global.CallWrapper.Run("LoadCost")
		
		'Returns
		F.Global.CallWrapper.GetProperty("LoadCost","ReturnCode",V.Local.iReturnCode)
		F.Global.CallWrapper.GetProperty("LoadCost","ReturnCost",V.Local.fReturnCost)
		F.Global.CallWrapper.GetProperty("LoadCost","ReturnVendor",V.Local.sReturnVendor)
		
		'Set Value
		F.Data.DataTable.SetValue("dtPO",V.Local.iCnt,"Cost",V.Local.fReturnCost)
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadCost.End

Program.Sub.GenerateEmail.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSelect.Declare
	V.Local.iCnt.Declare
	V.Local.iUserID.Declare
	V.Local.sSenderName.Declare
	V.Local.sSenderEmail.Declare
	V.Local.sParams.Declare
	V.Local.iBIRunID.Declare
	V.Local.iLogID.Declare
	V.Local.sAttach.Declare
	V.Local.sParamName.Declare
	V.Local.sParamVal.Declare
	V.Local.iRet.Declare
	V.Local.sRecipient.Declare
	V.Local.sRecipientEmail.Declare
	V.Local.sSubject.Declare
	V.Local.sBody.Declare
	V.Local.sDir.Declare
	V.Local.bFile.Declare
	V.Local.sSQL.Declare
	V.Local.sCallingProgram.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtEmails.Exists)
		F.Data.DataTable.Close("dtEmails")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.String.Build("{0}\Orders",V.Caller.PluginsDir,V.Local.sDir)
	F.Intrinsic.File.CreateDir(V.Local.sDir)

	'Check Subject Txt File
	F.Intrinsic.String.Build("{0}\GAB_4163_Email_Subject_Custom.txt",V.Caller.GasDir,V.Local.sSubject)
	F.Intrinsic.File.Exists(V.Local.sSubject,V.Local.bFile)
	F.Intrinsic.Control.If(V.Local.bFile,=,False)
		F.Intrinsic.String.Build("{0}\GAB_4163_Email_Subject.txt",V.Caller.GasDir,V.Local.sSubject)
	F.Intrinsic.Control.EndIf
	
	'Check Body Txt File
	F.Intrinsic.String.Build("{0}\GAB_4163_Email_Body_Custom.txt",V.Caller.GasDir,V.Local.sBody)
	F.Intrinsic.File.Exists(V.Local.sBody,V.Local.bFile)
	F.Intrinsic.Control.If(V.Local.bFile,=,False)
		F.Intrinsic.String.Build("{0}\GAB_4163_Email_Body.txt",V.Caller.GasDir,V.Local.sBody)
	F.Intrinsic.Control.EndIf
	
	'F.Intrinsic.String.Build("Select A.Purchase_Order,RTrim(B.Name_Vendor) As Name_Vendor,Case When C.Name_Preferred <> '' Then RTrim(C.Name_Preferred)+' '+RTrim(C.Name_Last) Else RTrim(C.Name_Preferred)+' '+RTrim(C.Name_Last) End As Contact_Name,RTrim(C.Email1) As Contact_Email From V_PO_Header A Join V_Vendor_Master B On A.Vendor = B.Vendor Join Contact C On A.Vendor = C.Cust Where C.Pri_Cntct = 1 And A.Purchase_Order In ({0}) And C.Email1 <> '';",V.Args.EmailList,V.Local.sSQL)
	F.Intrinsic.String.Build("Select A.Purchase_Order,RTrim(B.Name_Vendor) As Name_Vendor,'' As Contact_Name,RTrim(C.Email) As Contact_Email From V_PO_Header A Join V_Vendor_Master B On A.Vendor = B.Vendor Join V_Vendor_Addl C On A.Vendor = C.Vendor Where A.Purchase_Order In ({0}) And C.Email <> '';",V.Args.EmailList,V.Local.sSQL)
	F.Data.DataTable.CreateFromSQL("dtEmails","con",V.Local.sSQL,True)
	
	F.Global.Security.GetUserId(V.Caller.User,V.Caller.CompanyCode,V.Local.iUserID)
	F.Global.Security.GetFullName(V.Caller.User,V.Local.sSenderName)
	F.Global.Security.GetUserEmail(V.Caller.User,V.Local.sSenderEmail)
	F.Intrinsic.Control.If(V.Local.sSenderEmail,=,"")
		F.Intrinsic.UI.Msgbox("Error in email procedure. The GS User does not have an email address associated with it in User Security Maintenance.")
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Screen.FrmPO!ddlEmail.Text,=,"Preview Email")
		F.Intrinsic.Control.If(V.DataTable.dtEmails.RowCount,=,0)
			'F.Data.DataTable.Close("dtEmails")
			'F.Intrinsic.String.Build("Select A.Purchase_Order,RTrim(B.Name_Vendor) As Name_Vendor,'' As Contact_Name,'' As Contact_Email From V_PO_Header A Join V_Vendor_Master B On A.Vendor = B.Vendor Where A.Purchase_Order In ({0});",V.Args.EmailList,V.Local.sSQL)
			F.Intrinsic.String.Build("Select A.Purchase_Order,RTrim(B.Name_Vendor) As Name_Vendor,'' As Contact_Name,RTrim(C.Email) As Contact_Email From V_PO_Header A Join V_Vendor_Master B On A.Vendor = B.Vendor Join V_Vendor_Addl C On A.Vendor = C.Vendor Where A.Purchase_Order In ({0}) And C.Email <> '';",V.Args.EmailList,V.Local.sSQL)
		F.Intrinsic.Control.EndIf
		F.Data.Datatable.AddColumn("dtEmails","SenderName",String,V.Local.sSenderName)
		F.Data.Datatable.AddColumn("dtEmails","SenderEmail",String,V.Local.sSenderEmail)
		'Subject
		F.Intrinsic.File.File2String(V.Local.sSubject,V.Local.sSubject)
		'Body
		F.Intrinsic.File.File2String(V.Local.sBody,V.Local.sBody)
		'Modify DataTable
		F.Data.Datatable.AddColumn("dtEmails","Subject",String,V.Local.sSubject)
		F.Data.Datatable.AddColumn("dtEmails","Body",String,V.Local.sBody)
		F.Data.Datatable.AddColumn("dtEmails","AttachmentFiles",String)
		F.Data.Datatable.AddColumn("dtEmails","Attachments",Boolean,False)
		F.Data.Datatable.AddColumn("dtEmails","Preview",String,"Preview")
		F.Intrinsic.Control.CallSub(LoadPreviewEmails)
		Gui.FrmPO.lblStatus.Visible(False)
		Gui.FrmPO.progBarStatus.Visible(False)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.If(V.DataTable.dtEmails.RowCount,<>,0)
		Gui.FrmPO.lblStatus.Caption("Sending Emails....")
		Gui.FrmPO.lblStatus.Visible(True)
		Gui.FrmPO.progBarStatus.Visible(True)
		Gui.FrmPO.tabPO.Enabled(False)
		Gui.FrmPO.progBarStatus.Min(0)
		F.Intrinsic.Control.If(V.Local.sSelect.UBound,<>,0)
			Gui.FrmPO.progBarStatus.Max(V.Local.sSelect.UBound)
		F.Intrinsic.Control.Else
			Gui.FrmPO.progBarStatus.Max(1)
		F.Intrinsic.Control.EndIf
		
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtEmails.RowCount--,1)
			Gui.FrmPO.progBarStatus.Value(V.Local.iCnt)
			F.Intrinsic.Control.If(V.DataTable.dtEmails(V.Local.iCnt).Contact_Email!FieldValTrim,<>,"")
				'Populate BI Table
				F.Intrinsic.String.Build("{0}!*!S!*! !*!N!*!N",V.DataTable.dtEmails(V.Local.iCnt).Purchase_Order!FieldValTrim,V.Local.sParams)	
				F.Global.General.CallWrapperSyncBio(915000,V.Local.sParams)
				'Export File
				F.Global.BI.GetRunID(V.Local.iBIRunID)
				F.Global.BI.StartLogging(V.Local.iBIRunID,002801,-1,"",V.Local.iLogID)
				F.Intrinsic.String.Build("{0}\Orders\{1}.pdf",V.Caller.PluginsDir,V.DataTable.dtEmails(V.Local.iCnt).Purchase_Order!FieldValTrim,V.Local.sAttach)
				V.Local.sParamName.Set("Terminal*!*ReportID*!*UseVendorCurr*!*PRTCNFRM*!*PROGRAM*!*PRTHIST*!*QTYDEC")
				F.Intrinsic.String.Build("{0}*!*002801*!* *!* *!* *!* *!*{1}*!* *!*",V.Caller.Terminal,0,V.Local.sParamVal)
				F.Global.BI.RunReportPreProcessor(V.Local.iBIRUNID,V.Local.iLogID,V.Local.sParamName,V.Local.sParamVal,"",4,True,"",-1,"",0,V.Local.sAttach,"",V.Local.iRet)
				F.Global.BI.StopLogging(V.Local.iLogID)
				'Prepare Email
				F.Intrinsic.String.Replace(V.DataTable.dtEmails(V.Local.iCnt).Contact_Email!FieldValTrim,";",",",V.Local.sRecipientEmail)
				F.Intrinsic.String.Build("{0}*!*{0}",V.Local.sRecipientEmail,V.Local.sRecipient)
				F.Intrinsic.String.Build("{0}*!*{1}",V.Local.sSenderEmail,V.Local.sSenderName,V.Local.sSenderEmail)
				F.Intrinsic.String.Build("{0}.pdf*!*{1}\Orders\",V.DataTable.dtEmails(V.Local.iCnt).Purchase_Order!FieldValTrim,V.Caller.PluginsDir,V.Local.sAttach)
				'Subject
				F.Intrinsic.String.Build("{0}\GAB_4163_Email_Subject.txt",V.Caller.GasDir,V.Local.sSubject)
				F.Intrinsic.File.File2String(V.Local.sSubject,V.Local.sSubject)
				F.Intrinsic.String.Replace(V.Local.sSubject,"%PO%",V.DataTable.dtEmails(V.Local.iCnt).Purchase_Order!FieldValTrim,V.Local.sSubject)
				'Body
				F.Intrinsic.String.Build("{0}\GAB_4163_Email_Body.txt",V.Caller.GasDir,V.Local.sBody)
				F.Intrinsic.File.File2String(V.Local.sBody,V.Local.sBody)
				F.Intrinsic.String.Replace(V.Local.sBody,"%PO%",V.DataTable.dtEmails(V.Local.iCnt).Purchase_Order!FieldValTrim,V.Local.sBody)
				F.Intrinsic.String.Replace(V.Local.sBody,"%USER%",V.Local.sSenderName,V.Local.sBody)
				'Calling Program
				F.Intrinsic.String.Build("Email PO-{0}",V.DataTable.dtEmails(V.Local.iCnt).Purchase_Order!FieldValTrim,V.Local.sCallingProgram)
				'Send Email				
				F.Global.Messaging.QueueMessage(V.Caller.CompanyCode,0,V.Local.sCallingProgram,V.Local.sSubject,V.Local.sSenderEmail,V.Local.sRecipient,V.Local.sBody,5,"",False,"","","","","","","",V.Local.sAttach,False)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.iCnt)
	F.Intrinsic.Control.EndIf
	
	Gui.FrmPO.lblStatus.Visible(False)
	Gui.FrmPO.progBarStatus.Visible(False)
	Gui.FrmPO.tabPO.Enabled(True)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GenerateEmail.End

Program.Sub.frmPrevEmail_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.iRet.Declare
	
	F.Intrinsic.UI.Msgbox("Emails will not be sent out. Continue?","Continue?",4,V.Local.iRet)
	F.Intrinsic.Control.If(V.Local.iRet,=,6)
		Gui.frmPrevEmail..Visible(False)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.frmPrevEmail_UnLoad.End

Program.Sub.LoadPreviewEmails.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	Gui.frmPrevEmail.GsGCPrevEml.AddGridviewFromDatatable("gvEmails","dtEmails")
	Gui.frmPrevEmail.GsGCPrevEml.SuspendLayout()
	Gui.frmPrevEmail.GsGCPrevEml.SetGridViewProperty("gvEmails","MultiSelect",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetGridViewProperty("gvEmails","AllowSort",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetGridViewProperty("gvEmails","AllowFilter",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetGridViewProperty("gvEmails","Editable",False)
	Gui.frmPrevEmail.GsGCPrevEml.SetGridViewProperty("gvEmails","ReadOnly",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetGridViewProperty("gvEmails","ShowGroupPanel",False)
	Gui.frmPrevEmail.GsGCPrevEml.SetGridViewProperty("gvEmails","Enableappearanceoddrow",True)
	
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Subject","Visible",False)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Body","Visible",False)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","SenderName","Visible",False)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","SenderEmail","Visible",False)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","AttachmentFiles","Visible",False)
	
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Preview","ShowCaption",False)
	
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Purchase_Order","Caption","PO")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Name_Vendor","Caption","Vendor")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Contact_Name","Caption","Name")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Contact_Email","Caption","Email")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","SenderName","Caption","Sender Name")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","SenderEmail","Caption","Sender Email")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Subject","Caption","Subject")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Body","Caption","Body")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","AttachmentFiles","Caption","Files")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Attachments","Caption","Attachments")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Preview","Caption","Preview")
	
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Purchase_Order","MinWidth","85")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Name_Vendor","MinWidth","85")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Contact_Name","MinWidth","85")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Contact_Email","MinWidth","85")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","SenderName","MinWidth","85")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","SenderEmail","MinWidth","85")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Subject","MinWidth","85")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","AttachmentFiles","MinWidth","85")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Attachments","MinWidth","85")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Body","MinWidth","85")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Preview","MinWidth","85")
	
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Purchase_Order","HeaderFontBold",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Name_Vendor","HeaderFontBold",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Contact_Name","HeaderFontBold",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Contact_Email","HeaderFontBold",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","SenderName","HeaderFontBold",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","SenderEmail","HeaderFontBold",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Subject","HeaderFontBold",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","AttachmentFiles","HeaderFontBold",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Attachments","HeaderFontBold",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Body","HeaderFontBold",True)
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Preview","HeaderFontBold",True)
	
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Purchase_Order","HeaderHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Name_Vendor","HeaderHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Contact_Name","HeaderHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Contact_Email","HeaderHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","SenderName","HeaderHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","SenderEmail","HeaderHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Subject","HeaderHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","AttachmentFiles","HeaderHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Attachments","HeaderHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Body","HeaderHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Preview","HeaderHAlignment","Center")
	
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Purchase_Order","CellHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","AttachmentFiles","CellHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Attachments","CellHAlignment","Center")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Preview","CellHAlignment","Center")
	
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Preview","CellBackColor","Gray")
	Gui.frmPrevEmail.GsGCPrevEml.SetColumnProperty("gvEmails","Preview","CellForeColor","White")
	
	Gui.frmPrevEmail.GsGCPrevEml.ResumeLayout()
	Gui.frmPrevEmail.GsGCPrevEml.MainView("gvEmails")
	
	Gui.frmPrevEmail..Show

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadPreviewEmails.End

Program.Sub.GsGCPrevEml_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sFilePath.Declare
	V.Local.sSubject.Declare
	V.Local.sBody.Declare
	
	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.Case("Preview")
			Gui.frmEmail..Caption("Edit Email")
			Gui.frmEmail.txtSName.Text(V.DataTable.dtEmails(V.Args.RowIndex).SenderName!FieldValTrim)
			Gui.frmEmail.txtSEmail.Text(V.DataTable.dtEmails(V.Args.RowIndex).SenderEmail!FieldValTrim)
			Gui.frmEmail.txtRName.Text(V.DataTable.dtEmails(V.Args.RowIndex).Contact_Name!FieldValTrim)
			Gui.frmEmail.txtREmail.Text(V.DataTable.dtEmails(V.Args.RowIndex).Contact_Email!FieldValTrim)
			F.Intrinsic.String.Replace(V.DataTable.dtEmails(V.Args.RowIndex).Subject!FieldValTrim,"%PO%",V.DataTable.dtEmails(V.Args.RowIndex).Purchase_Order!FieldValTrim,V.Local.sSubject)
			Gui.frmEmail.txtSubject.Text(V.Local.sSubject)
			F.Intrinsic.String.Replace(V.DataTable.dtEmails(V.Args.RowIndex).Body!FieldValTrim,"%PO%",V.DataTable.dtEmails(V.Args.RowIndex).Purchase_Order!FieldValTrim,V.Local.sBody)
			F.Intrinsic.String.Replace(V.Local.sBody,"%USER%",V.DataTable.dtEmails(V.Args.RowIndex).SenderName!FieldValTrim,V.Local.sBody)
			Gui.frmEmail.txtBody.Text(V.Local.sBody)
			Gui.frmEmail.txtAttach.Text(V.DataTable.dtEmails(V.Args.RowIndex).AttachmentFiles!FieldValTrim)
			Gui.frmEmail.txtRow.Text(V.Args.RowIndex)
			Gui.frmEmail..Show
			Gui.frmEmail.txtSName.SetFocus
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCPrevEml_RowCellClick.End

Program.Sub.cmdSend_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCnt.Declare
	V.Local.iCnt2.Declare
	V.Local.sSender.Declare
	V.Local.sRecipient.Declare
	V.Local.sRecipientEmail.Declare
	V.Local.sSubject.Declare
	V.Local.sBody.Declare
	V.Local.sAttachments.Declare
	V.Local.sFiles.Declare
	V.Local.sFilePath.Declare
	V.Local.sFileName.Declare
	V.Local.sParams.Declare
	V.Local.iBIRunID.Declare
	V.Local.iLogID.Declare
	V.Local.sParamName.Declare
	V.Local.sParamVal.Declare
	V.Local.iRet.Declare
	V.Local.sCallingProgram.Declare
	
	Gui.frmPrevEmail.lblStatus.Visible(True)
	Gui.frmPrevEmail.pbStatus.Visible(True)
	Gui.frmPrevEmail.pbStatus.Min(0)
	F.Intrinsic.Control.If(V.DataTable.dtEmails.RowCount,<>,0)
		Gui.frmPrevEmail.pbStatus.Max(V.DataTable.dtEmails.RowCount)
	F.Intrinsic.Control.Else
		Gui.frmPrevEmail.pbStatus.Max(100)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtEmails.RowCount--,1)
		Gui.frmPrevEmail.pbStatus.Value(V.Local.iCnt)
		F.Intrinsic.Control.If(V.DataTable.dtEmails(V.Local.iCnt).Contact_Email!FieldValTrim,<>,"")
			'Populate BI Table
			F.Intrinsic.String.Build("{0}!*!S!*! !*!N!*!N",V.DataTable.dtEmails(V.Local.iCnt).Purchase_Order!FieldValTrim,V.Local.sParams)	
			F.Global.General.CallWrapperSyncBio(915000,V.Local.sParams)
			'Export File
			F.Global.BI.GetRunID(V.Local.iBIRunID)
			F.Global.BI.StartLogging(V.Local.iBIRunID,002801,-1,"",V.Local.iLogID)
			F.Intrinsic.String.Build("{0}\Orders\{1}.pdf",V.Caller.PluginsDir,V.DataTable.dtEmails(V.Local.iCnt).Purchase_Order!FieldValTrim,V.Local.sAttachments)
			V.Local.sParamName.Set("Terminal*!*ReportID*!*UseVendorCurr*!*PRTCNFRM*!*PROGRAM*!*PRTHIST*!*QTYDEC")
			F.Intrinsic.String.Build("{0}*!*002801*!* *!* *!* *!* *!*{1}*!* *!*",V.Caller.Terminal,0,V.Local.sParamVal)
			F.Global.BI.RunReportPreProcessor(V.Local.iBIRUNID,V.Local.iLogID,V.Local.sParamName,V.Local.sParamVal,"",4,True,"",-1,"",0,V.Local.sAttachments,"",V.Local.iRet)
			F.Global.BI.StopLogging(V.Local.iLogID)
			'Recipient
			F.Intrinsic.String.Replace(V.DataTable.dtEmails(V.Local.iCnt).Contact_Email!FieldValTrim,";",",",V.Local.sRecipientEmail)
			F.Intrinsic.String.Build("{0}*!*{1}",V.DataTable.dtEmails(V.Local.iCnt).Contact_Name!FieldValTrim,V.Local.sRecipientEmail,V.Local.sRecipient)
			'Sender
			F.Intrinsic.String.Build("{0}*!*{1}",V.DataTable.dtEmails(V.Local.iCnt).SenderEmail!FieldValTrim,V.DataTable.dtEmails(V.Local.iCnt).SenderName!FieldValTrim,V.Local.sSender)
			'PO Attachments
			F.Intrinsic.String.Build("{0}.pdf*!*{1}\Orders\",V.DataTable.dtEmails(V.Local.iCnt).Purchase_Order!FieldValTrim,V.Caller.PluginsDir,V.Local.sAttachments)
			'Additional Attachments
			F.Intrinsic.Control.If(V.DataTable.dtEmails(V.Local.iCnt).Attachments!FieldVal)
				F.Intrinsic.String.Split(V.DataTable.dtEmails(V.Local.iCnt).AttachmentFiles!FieldVal,V.Ambient.NewLine,V.Local.sFiles)
				F.Intrinsic.Control.For(V.Local.iCnt2,0,V.Local.sFiles.UBound,1)
					F.Intrinsic.String.Split(V.Local.sFiles(V.Local.iCnt2),"\",V.Local.sFileName)
					V.Local.sFileName.Set(V.Local.sFileName(V.Local.sFileName.UBound))
					F.Intrinsic.String.Replace(V.Local.sFiles(V.Local.iCnt2),V.Local.sFileName,"",V.Local.sFilePath)
					F.Intrinsic.String.Build("{0}@!@{1}*!*{2}",V.Local.sAttachments,V.Local.sFileName,V.Local.sFilePath,V.Local.sAttachments)
				F.Intrinsic.Control.Next(V.Local.iCnt2)
			F.Intrinsic.Control.EndIf
			'Subject
			F.Intrinsic.String.Replace(V.DataTable.dtEmails(V.Local.iCnt).Subject!FieldValTrim,"%PO%",V.DataTable.dtEmails(V.Local.iCnt).Purchase_Order!FieldValTrim,V.Local.sSubject)
			'Body
			F.Intrinsic.String.Replace(V.DataTable.dtEmails(V.Local.iCnt).Body!FieldValTrim,"%PO%",V.DataTable.dtEmails(V.Local.iCnt).Purchase_Order!FieldValTrim,V.Local.sBody)
			F.Intrinsic.String.Replace(V.Local.sBody,"%USER%",V.DataTable.dtEmails(V.Local.iCnt).SenderName!FieldValTrim,V.Local.sBody)
			'Calling Program
			F.Intrinsic.String.Build("Email PO-{0}",V.DataTable.dtEmails(V.Local.iCnt).Purchase_Order!FieldValTrim,V.Local.sCallingProgram)
			'Send Email	
			F.Global.Messaging.QueueMessage(V.Caller.CompanyCode,0,V.Local.sCallingProgram,V.Local.sSubject,V.Local.sSender,V.Local.sRecipient,V.Local.sBody,5,"",False,"","","","","","","",V.Local.sAttachments,False)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	F.Intrinsic.Control.If(V.DataTable.dtEmails.RowCount,<>,0)
		Gui.frmPrevEmail.pbStatus.Value(V.DataTable.dtEmails.RowCount)
	F.Intrinsic.Control.Else
		Gui.frmPrevEmail.pbStatus.Value(100)
	F.Intrinsic.Control.EndIf
	
	Gui.frmPrevEmail.lblStatus.Visible(False)
	Gui.frmPrevEmail.pbStatus.Visible(False)
	Gui.frmPrevEmail..Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdSend_Click.End

Program.Sub.frmEmail_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmEmail..Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.frmEmail_UnLoad.End

Program.Sub.cmdSavePreview_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sAttach.Declare
	V.Local.bAttach.Declare
	
	V.Local.sAttach.Set(V.Screen.frmEmail!txtAttach.Text)
	F.Intrinsic.Control.If(V.Local.sAttach.Trim,<>,"")
		V.Local.bAttach.Set(True)
	F.Intrinsic.Control.EndIf
	
	F.Data.DataTable.SetValue("dtEmails",V.Screen.frmEmail!txtRow.Text,"SenderName",V.Screen.frmEmail!txtSName.Text,"SenderEmail",V.Screen.frmEmail!txtSEmail.Text,"Contact_Name",V.Screen.frmEmail!txtRName.Text,"Contact_Email",V.Screen.frmEmail!txtREmail.Text,"Subject",V.Screen.frmEmail!txtSubject.Text,"Body",V.Screen.frmEmail!txtBody.Text,"AttachmentFiles",V.Screen.frmEmail!txtAttach.Text,"Attachments",V.Local.bAttach)
	Gui.frmEmail..Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdSavePreview_Click.End

Program.Sub.DragDrop.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.iCnt.Declare
	V.Local.sFiles.Declare
	V.Local.sAttach.Declare
	
	F.Intrinsic.String.Split(V.Args.Files,"*!*",V.Local.sFiles)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sFiles.UBound,1)
		F.Intrinsic.Control.If(V.Local.iCnt,=,0)
			V.Local.sAttach.Set(V.Local.sFiles(V.Local.iCnt))
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("{0}{1}{2}",V.Local.sAttach,V.Ambient.NewLine,V.Local.sFiles(V.Local.iCnt),V.Local.sAttach)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	F.Intrinsic.Control.If(V.Screen.frmEmail!txtAttach.Text,<>,"")
		F.Intrinsic.String.Build("{0}{1}{2}",V.Screen.frmEmail!txtAttach.Text,V.Ambient.NewLine,V.Local.sAttach,V.Local.sAttach)
	F.Intrinsic.Control.EndIf
	
	Gui.frmEmail.txtAttach.Text(V.Local.sAttach)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.DragDrop.End

Program.Sub.GetCompanyShipTo.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	F.Data.DataTable.CreateFromSQL("dtCompany","con","Select NAME_COMPANY, ADDRESS1, ADDRESS2, CITY, STATE, CODE_ZIP, COUNTRY, COUNTY, ATTENTION From V_COMPANY;",True)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GetCompanyShipTo.End

Program.Sub.RemoveExpiredNotes.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	F.ODBC.Connection!con.Execute("DELETE FROM GAB_4936_NOTES WHERE EXPIRE_DT <= CURDATE();")

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.RemoveExpiredNotes.End

Program.Sub.MenuClickAdd.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iNID.Declare
	
	F.ODBC.Connection!con.ExecuteAndReturn("Select Max(NID) From GAB_4936_NOTES;",V.Local.iNID)
	F.Intrinsic.Math.Add(V.Local.iNID,1,V.Local.iNID)
	F.Data.DataTable.AddRow("dtNotes","NID",V.Local.iNID,"PART",V.Global.sPart2,"LOC",V.Global.sLoc2,"GSUSER",V.Caller.User,"CREATE_DT",V.Ambient.Now)
	F.Data.DataTable.SaveToDB("dtNotes","con","GAB_4936_NOTES","NID")
	F.Intrinsic.Control.CallSub(LoadDtNotes)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickAdd.End

Program.Sub.MenuClickDelete.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iRow.Declare
	V.Local.sSQL.Declare
	
	Gui.frmNotes.GsGCNotes.GetSelectedRows("gvNotes",V.Local.iRow)
	F.Intrinsic.String.Build("Delete From GAB_4936_NOTES Where NID = {0};",V.DataTable.dtNotes(V.Local.iRow).NID!FieldVal,V.Local.sSQL)
	F.ODBC.Connection!con.Execute(V.Local.sSQL)
	F.Data.DataTable.DeleteRow("dtNotes",V.Local.iRow)
	F.Intrinsic.Control.CallSub(LoadDtNotes)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickDelete.End

Program.Sub.LoadDtNotes.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare

	F.Intrinsic.Control.If(V.DataTable.dtNotes.Exists)
		F.Data.DataTable.Close("dtNotes")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.String.Build("Select * From GAB_4936_NOTES Where Part = '{0}' And Loc = '{1}' Order By Create_DT Desc;",V.Global.sPart2,V.Global.sLoc2,V.Local.sSQL)
	F.Data.DataTable.CreateFromSQL("dtNotes","con",V.Local.sSQL,True)
	
	F.Intrinsic.Control.CallSub(LoadGvNotes)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDtNotes.End

Program.Sub.LoadGvNotes.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCnt.Declare
	V.Local.sColumns.Declare
	
	Gui.frmNotes.GsGCNotes.SuspendLayout()
	Gui.frmNotes.GsGCNotes.AddGridViewFromDataTable("gvNotes","dtNotes")
	Gui.frmNotes.GsGCNotes.Icon(V.Global.sGsGCIcon)
	Gui.frmNotes.GsGCNotes.SetGridViewProperty("gvNotes","MultiSelect",True)
	Gui.frmNotes.GsGCNotes.SetGridViewProperty("gvNotes","AllowSort",True)
	Gui.frmNotes.GsGCNotes.SetGridViewProperty("gvNotes","AllowFilter",True)
	Gui.frmNotes.GsGCNotes.SetGridViewProperty("gvNotes","OptionsDetailShowDetailTabs",False)
	Gui.frmNotes.GsGCNotes.SetGridViewProperty("gvNotes","OptionsViewShowGroupPanel",True)
	Gui.frmNotes.GsGCNotes.SetGridViewProperty("gvNotes","EnableAppearanceOddRow",True)
	
	'Loop through columns names by using the V.DataTable.dtName.FieldNames
	F.Intrinsic.String.Split(V.DataTable.dtNotes.FieldNames,"*!*",V.Local.sColumns)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sColumns.UBound,1)
		Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes",V.Local.sColumns(V.Local.iCnt),"HeaderFontBold",True)
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	'NID
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","NID","Visible",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","NID","Caption","NID")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","NID","AllowEdit",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","NID","ReadOnly",True)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","NID","MinWidth","45")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","NID","HeaderHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","NID","CellHAlignment","Center")
	
	'PART
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","PART","Visible",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","PART","Caption","Part")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","PART","AllowEdit",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","PART","ReadOnly",True)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","PART","MinWidth","50")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","PART","HeaderHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","PART","CellHAlignment","Center")
	
	'LOC
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","LOC","Visible",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","LOC","Caption","Loc")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","LOC","AllowEdit",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","LOC","ReadOnly",True)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","LOC","MinWidth","50")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","LOC","HeaderHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","LOC","CellHAlignment","Center")
	
	'GSUSER
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","GSUSER","Caption","User")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","GSUSER","AllowEdit",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","GSUSER","ReadOnly",True)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","GSUSER","MinWidth","50")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","GSUSER","HeaderHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","GSUSER","CellHAlignment","Center")
	
	'CREATE_DT
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","CREATE_DT","Caption","Create Date")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","CREATE_DT","AllowEdit",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","CREATE_DT","ReadOnly",True)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","CREATE_DT","MinWidth","50")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","CREATE_DT","HeaderHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","CREATE_DT","CellHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","CREATE_DT","DisplayCustomDatetime","d")

	'NOTES
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","NOTES","Caption","Notes")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","NOTES","AllowEdit",True)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","NOTES","ReadOnly",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","NOTES","MinWidth","350")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","NOTES","HeaderHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","EXPIRE_DT","CellHAlignment","Left")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","NOTES","CellBackColor","LightYellow")
	
	'EXPIRE_DT
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","EXPIRE_DT","Caption","Expire Date")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","EXPIRE_DT","AllowEdit",True)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","EXPIRE_DT","ReadOnly",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","EXPIRE_DT","MinWidth","50")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","EXPIRE_DT","HeaderHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","EXPIRE_DT","CellHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","EXPIRE_DT","DisplayCustomDatetime","d")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","NOTES","CellBackColor","LightYellow")

	Gui.frmNotes.GsGCNotes.ResumeLayout()
	Gui.frmNotes.GsGCNotes.MainView("gvNotes")

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadGvNotes.End

Program.Sub.frmNotes_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmNotes..Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.frmNotes_UnLoad.End

Program.Sub.GsGCNotes_CellValueChanged.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sText.Declare
	V.Local.sSQL.Declare
	V.Local.iNID.Declare
	V.Local.dExpDate.Declare
	
	V.Local.iNID.Set(V.DataTable.dtNotes(V.Args.RowIndex).NID!FieldVal)
	
	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.Case("NOTES")
			F.Intrinsic.String.Replace(V.Args.Value,"'","''",V.Local.sText)
			F.Intrinsic.String.Build("Update GAB_4936_NOTES Set Notes = '{0}' Where NID = {1};",V.Local.sText,V.Local.iNID,V.Local.sSQL)
			
		F.Intrinsic.Control.Case("EXPIRE_DT")
			V.Local.dExpDate.Set(V.DataTable.dtNotes(V.Args.RowIndex).EXPIRE_DT!FieldVal)
			F.Intrinsic.String.Build("Update GAB_4936_NOTES Set Expire_DT = '{0}' Where NID = {1};",V.Local.dExpDate.PervasiveDate,V.Local.iNID,V.Local.sSQL)
			
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.If(V.Local.sSQL,<>,"")
		F.ODBC.Connection!con.Execute(V.Local.sSQL)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCNotes_CellValueChanged.End

Program.Sub.LoadRequisitions.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare

	F.Intrinsic.Control.IF(V.DataTable.dtReqs.Exists)
		F.Data.DataTable.Close("dtReqs")
	F.Intrinsic.Control.EndIF

	F.Intrinsic.String.Build("Select Cast(0 As Bit) As {0}Select{0},PO_Req_Number,PO_Req_Line,Part,Location,Description,A.Vendor,RTRIM(B.Name_Vendor) As VendorName,Product_Line As PL,Sort_Code,Case When A.Buyer = '' Then B.Buyer Else A.Buyer End As Buyer,RTRIM(C.Buyer) As Buyer_Name,Inventory_UM,UM,GL_Account As GLAcct,Job,Suffix,Case When Sequence = '000000' Then '' Else Sequence End As Sequence,Date_Original,UserID_Originator,Date_Due,Unit_Price As COST,Quantity As Purchase From V_Purchase_Reqs A Left Join V_Vendor_Master B On A.Vendor = B.Vendor And B.Vendor <> '' Left Join V_Buyers C On Case When A.Buyer = '' Then B.Buyer Else A.Buyer End = C.Buyer_Code;",V.Ambient.DblQuote,V.Local.sSQL)
	F.Data.DataTable.CreateFromSQL("dtReqs","con",V.Local.sSQL,True)

	F.Intrinsic.Control.CallSub(LoadRequisitionsGV)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadRequisitions.End

Program.Sub.LoadRequisitionsGV.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
		
	V.Local.iCnt.Declare
	V.Local.sColumns.Declare
	
	Gui.frmPO.GsGCReqs.SuspendLayout()
	Gui.frmPO.GsGCReqs.AddGridViewFromDataTable("gvReqs","dtReqs")
	Gui.frmPO.GsGCReqs.Icon(V.Global.sGsGCIcon)
	Gui.frmPO.GsGCReqs.SetGridViewProperty("gvReqs","MultiSelect",True)
	Gui.frmPO.GsGCReqs.SetGridViewProperty("gvReqs","AllowSort",True)
	Gui.frmPO.GsGCReqs.SetGridViewProperty("gvReqs","AllowFilter",True)
	Gui.frmPO.GsGCReqs.SetGridViewProperty("gvReqs","OptionsDetailShowDetailTabs",False)
	Gui.frmPO.GsGCReqs.SetGridViewProperty("gvReqs","OptionsViewShowGroupPanel",True)
	Gui.frmPO.GsGCReqs.SetGridViewProperty("gvReqs","EnableAppearanceOddRow",True)
	
	'Loop through columns names by using the V.DataTable.dtName.FieldNames
	F.Intrinsic.String.Split(V.DataTable.dtReqs.FieldNames,"*!*",V.Local.sColumns)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sColumns.UBound,1)
		Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs",V.Local.sColumns(V.Local.iCnt),"HeaderFontBold",True)
	F.Intrinsic.Control.Next(V.Local.iCnt)

	'Select
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Select","Caption","Select")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Select","MinWidth","55")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Select","AllowEdit",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Select","ReadOnly",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Select","HeaderHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Select","CellHAlignment","Center")
	
	'PO_Req_Number
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","PO_Req_Number","Caption","Requisition No.")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","PO_Req_Number","MinWidth","90")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","PO_Req_Number","AllowEdit",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","PO_Req_Number","ReadOnly",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","PO_Req_Number","HeaderHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","PO_Req_Number","CellHAlignment","Center")
	Gui.frmPO.GsGCReqs.AddSummaryItem("gvReqs","PO_Req_Number","PO_Req_Number","Count","Tot Reqs: ","",n0)
	
	'PO_Req_Line
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","PO_Req_Line","Caption","Line")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","PO_Req_Line","MinWidth","55")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","PO_Req_Line","AllowEdit",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","PO_Req_Line","ReadOnly",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","PO_Req_Line","HeaderHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","PO_Req_Line","CellHAlignment","Center")
	
	'Part
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Part","Caption","Part")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Part","MinWidth","125")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Part","AllowEdit",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Part","ReadOnly",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Part","HeaderHAlignment","Left")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Part","CellHAlignment","Left")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Part","CellForeColor","Blue")
	
	'LOC
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Location","Caption","Loc")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Location","MinWidth","45")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Location","AllowEdit",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Location","ReadOnly",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Location","HeaderHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Location","CellHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Location","CellForeColor","Blue")
	
	'Description
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Description","Caption","Description")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Description","AllowEdit",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Description","ReadOnly",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Description","MinWidth","200")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Description","HeaderHAlignment","Left")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Description","CellHAlignment","Left")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Description","CellForeColor","Blue")
	
	'Vendor
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Vendor","Visible",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Vendor","Caption","Vendor")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Vendor","MinWidth","85")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Vendor","AllowEdit",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Vendor","ReadOnly",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Vendor","HeaderHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Vendor","CellHAlignment","Center")
	
	'VendorName
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","VendorName","Caption","Vendor Name")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","VendorName","MinWidth","200")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","VendorName","AllowEdit",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","VendorName","ReadOnly",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","VendorName","HeaderHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","VendorName","CellHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","VendorName","CellForeColor","Blue")
	
	'PL
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","PL","Caption","PL")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","PL","MinWidth","45")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","PL","AllowEdit",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","PL","ReadOnly",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","PL","HeaderHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","PL","CellHAlignment","Center")
	
	'Sort_Code
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Sort_Code","Caption","Sort Code")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Sort_Code","MinWidth","85")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Sort_Code","AllowEdit",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Sort_Code","ReadOnly",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Sort_Code","HeaderHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Sort_Code","CellHAlignment","Center")
	
	'Buyer
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Buyer","Visible",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Buyer","Caption","Buyer")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Buyer","MinWidth","50")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Buyer","AllowEdit",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Buyer","ReadOnly",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Buyer","HeaderHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Buyer","CellHAlignment","Center")
	
	'Buyer_Name
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Buyer_Name","Caption","Buyer Name")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Buyer_Name","MinWidth","125")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Buyer_Name","AllowEdit",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Buyer_Name","ReadOnly",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Buyer_Name","HeaderHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Buyer_Name","CellHAlignment","Center")
	
	'Inventory_UM
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Inventory_UM","Caption","Inv UM")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Inventory_UM","MinWidth","50")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Inventory_UM","AllowEdit",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Inventory_UM","ReadOnly",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Inventory_UM","HeaderHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Inventory_UM","CellHAlignment","Center")
	
	'UM
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","UM","Caption","Purch UM")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","UM","MinWidth","65")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","UM","AllowEdit",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","UM","ReadOnly",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","UM","HeaderHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","UM","CellHAlignment","Center")
	
	'GLAcct
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","GLAcct","Visible",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","GLAcct","Caption","GL Acct")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","GLAcct","MinWidth","50")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","GLAcct","AllowEdit",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","GLAcct","ReadOnly",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","GLAcct","HeaderHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","GLAcct","CellHAlignment","Center")
	
	'Job
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Job","Visible",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Job","Caption","Job")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Job","MinWidth","50")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Job","AllowEdit",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Job","ReadOnly",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Job","HeaderHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Job","CellHAlignment","Center")
	
	'Suffix
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Suffix","Visible",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Suffix","Caption","Suffix")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Suffix","MinWidth","50")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Suffix","AllowEdit",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Suffix","ReadOnly",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Suffix","HeaderHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Suffix","CellHAlignment","Center")
	
	'Sequence
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Sequence","Visible",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Sequence","Caption","Seq")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Sequence","MinWidth","50")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Sequence","AllowEdit",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Sequence","ReadOnly",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Sequence","HeaderHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Sequence","CellHAlignment","Center")
	
	'Date_Original
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Date_Original","Caption","Original Date")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Date_Original","MinWidth","85")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Date_Original","AllowEdit",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Date_Original","ReadOnly",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Date_Original","HeaderHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Date_Original","CellHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Date_Original","DisplayCustomDatetime","d")
	
	'UserID_Originator
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","UserID_Originator","Caption","Originator")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","UserID_Originator","MinWidth","85")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","UserID_Originator","AllowEdit",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","UserID_Originator","ReadOnly",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","UserID_Originator","HeaderHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","UserID_Originator","CellHAlignment","Center")
	
	'Date_Due
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Date_Due","Caption","Due Date")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Date_Due","MinWidth","85")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Date_Due","AllowEdit",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Date_Due","ReadOnly",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Date_Due","HeaderHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Date_Due","CellHAlignment","Center")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Date_Due","DisplayCustomDatetime","d")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Date_Due","CellBackColor","LightYellow")
	
	'COST
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","COST","Caption","Cost")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","COST","MinWidth","85")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","COST","AllowEdit",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","COST","ReadOnly",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","COST","HeaderHAlignment","Far")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","COST","CellHAlignment","Far")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","COST","DisplayCustomNumeric","#,###,###,##0.00##")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","COST","CellBackColor","LightYellow")
	
	'Purchase
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Purchase","Caption","PO Quantity")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Purchase","MinWidth","85")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Purchase","AllowEdit",True)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Purchase","ReadOnly",False)
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Purchase","HeaderHAlignment","Far")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Purchase","CellHAlignment","Far")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Purchase","DisplayCustomNumeric","#,###,###,##0.00##")
	Gui.frmPO.GsGCReqs.SetColumnProperty("gvReqs","Purchase","CellBackColor","LightYellow")
	
	Gui.frmPO.GsGCReqs.ResumeLayout()
	Gui.frmPO.GsGCReqs.MainView("gvReqs")

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadRequisitionsGV.End

Program.Sub.Comments.Start
Program.Sub.Comments.End